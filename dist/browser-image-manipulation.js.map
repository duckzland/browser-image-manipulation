{"version":3,"file":"browser-image-manipulation.js","sources":["../src/loaders/loadBlob.js","../src/loaders/loadCanvas.js","../src/manipulations/imageResize.js","../src/helpers/degreesToRadian.js","../src/manipulations/rotate.js","../src/manipulations/centerInRectangle.js","../src/manipulations/circle.js","../src/filters/grayscale.js","../src/filters/pixelize.js","../node_modules/stackblur-canvas/dist/stackblur-es.js","../src/filters/gaussianBlur.js","../src/helpers/fileExtByMimeType.js","../src/savers/asBlob.js","../src/savers/asCanvas.js","../src/savers/asImage.js","../node_modules/regenerator-runtime/runtime.js","../node_modules/pica/dist/pica.js","../src/constants.js","../src/ImageManipulation.js","../node_modules/blueimp-canvas-to-blob/js/canvas-to-blob.js","../index.js"],"sourcesContent":["/**\n * @param imageFile{File}\n * @returns {function(): Promise<{canvas: HTMLCanvasElement, fileName: String}>}\n */\nexport function loadBlob (imageFile) {\n    return () => new Promise((resolve, reject) => {\n        let image = document.createElement('img')\n        let reader = new FileReader()\n        reader.onload = (data) => {\n            image.src = data.target.result\n        }\n        reader.onerror = () => {\n            reject(new Error('Image read error'))\n        }\n        image.onload = () => {\n            let canvas = document.createElement('canvas')\n            canvas.width = image.width\n            canvas.height = image.height\n            let ctx = canvas.getContext('2d')\n            ctx.drawImage(image, 0, 0, canvas.width, canvas.height)\n            resolve({canvas, fileName: imageFile.name})\n        }\n        image.onerror = () => {\n            reject(new Error('Invalid image'))\n        }\n        reader.readAsDataURL(imageFile)\n    })\n}\n","/**\n * @param canvas{HTMLCanvasElement}\n * @param fileName{String}\n * @returns {function(): Promise<{canvas: HTMLCanvasElement, fileName: String}>}\n */\nexport function loadCanvas (canvas, fileName) {\n    return () => Promise.resolve({canvas, fileName})\n}\n","import Pica from 'pica/dist/pica'\n\nimport {RESIZE_TYPE_SQUARE, RESIZE_TYPE_TO} from '../constants'\n\n/**\n * @param newWidth{number} - new width after crop.\n * @param newHeight{number} - new height after crop.\n * @param offsetX{number} - If specified, cropping will start from that offset on X axis,\n * otherwise it will crop so result is centered in the source\n * @param offsetY{number} - If specified, cropping will start from that offset on Y axis,\n * otherwise it will crop so result is centered in the source\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\n export function imageCrop(newWidth, newHeight, offsetX = 0, offsetY = 0) {\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let dx = 0\n        let dy = 0\n        let sx = 0\n        let sy = 0\n        let width = canvasImage.width\n        let height = canvasImage.height\n\n        sy = offsetY || (height - newHeight) / 2\n        sx = offsetX || (width - newWidth) / 2\n\n        let cropedCanvas = document.createElement('canvas')\n        let cropedCanvasCtx = cropedCanvas.getContext('2d')\n        cropedCanvas.width = newWidth\n        cropedCanvas.height = newHeight\n\n        cropedCanvasCtx.drawImage(canvasImage, sx, sy, newWidth, newHeight, dx, dy, newWidth, newHeight)\n\n        resolve(cropedCanvas)\n    })\n }\n\n/**\n * @param maxWidth\n * @param maxHeight\n * @param type\n * @param options{Object}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function imageResize (maxWidth, maxHeight, type = null, options = {}) {\n    let resizeOptions = Object.assign({\n        pica: {}\n    }, options)\n\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let outputCanvas = null\n        let canvas = document.createElement('canvas')\n        let ratio = 0\n        let width = canvasImage.width\n        let height = canvasImage.height\n        let newHeight = 0\n        let newWidth = 0\n\n        if (type === RESIZE_TYPE_SQUARE) {\n            if (width < height) {\n                ratio = maxWidth / width\n            } else {\n                ratio = maxHeight / height\n            }\n            newHeight = height * ratio\n            newWidth = width * ratio\n        } else if (type === RESIZE_TYPE_TO) {\n            let ratioWidth = width / maxWidth\n            let ratioHeight = height / maxHeight\n            if (ratioWidth > ratioHeight) {\n                newHeight = Math.round(height / ratioWidth)\n                newWidth = maxWidth\n            } else {\n                newWidth = Math.round(width / ratioHeight)\n                newHeight = maxHeight\n            }\n        } else {\n            reject(new Error('Unknown resize type'))\n        }\n\n        canvas.width = newWidth\n        canvas.height = newHeight\n\n        let picaInstanse = new Pica()\n        picaInstanse.resize(canvasImage, canvas, resizeOptions.pica).then(resizedCanvas => {\n            if (type === RESIZE_TYPE_SQUARE) {\n                let dx = 0\n                let dy = 0\n                let sx = 0\n                let sy = 0\n\n                if (newWidth < newHeight) {\n                    sy = (newHeight - newWidth) / 2\n                    newHeight = newWidth\n                } else {\n                    sx = (newWidth - newHeight) / 2\n                    newWidth = newHeight\n                }\n                let cropedCanvas = document.createElement('canvas')\n                let cropedCanvasCtx = cropedCanvas.getContext('2d')\n                cropedCanvas.width = newWidth\n                cropedCanvas.height = newHeight\n\n                cropedCanvasCtx.drawImage(resizedCanvas, sx, sy, newWidth, newHeight, dx, dy, newWidth, newHeight)\n\n                outputCanvas = cropedCanvas\n            } else {\n                outputCanvas = resizedCanvas\n            }\n            resolve(outputCanvas)\n        })\n    })\n}\n","/**\n * @param degrees{number}\n * @returns {number}\n */\nexport function degreesToRadian (degrees) {\n    return degrees * (Math.PI / 180)\n}\n","import {degreesToRadian} from '../helpers/degreesToRadian.js'\n\n/**\n * @param degrees\n * @param opts{Object}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function rotate (degrees, opts = {}) {\n    let {padding = 0, bgColor = 'white'} = opts\n\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        let calcAngle = 0\n\n        if (degrees < 0) {\n            degrees = 360 + degrees\n        }\n\n        // get angle\n        if (degrees >= 0 && degrees <= 90) {\n            calcAngle = 90 - degrees\n        } else {\n            calcAngle = 270 - degrees\n        }\n        // to rad\n        let degreesRad = degreesToRadian(degrees)\n        let calcAngleRad = degreesToRadian(calcAngle)\n        let angleRad = degreesToRadian(degrees)\n        // calc sin cos\n        let sinCos = {\n            cosAngle: Math.cos(angleRad),\n            cosCalcAngle: Math.cos(calcAngleRad),\n            sinAngle: Math.sin(angleRad),\n            sinCalcAngle: Math.sin(calcAngleRad)\n\n        }\n        // get module of sin/cos\n        for (let key in sinCos) {\n            if (sinCos[key] < 0) {\n                sinCos[key] = sinCos[key] * -1\n            }\n        }\n        // calc w/h on rotate changes\n        canvas.width = canvasImage.width * sinCos.cosAngle + canvasImage.height * sinCos.cosCalcAngle + padding\n        canvas.height = canvasImage.width * sinCos.sinAngle + canvasImage.height * sinCos.sinCalcAngle + padding\n\n        let ctx = canvas.getContext('2d')\n        // set bg\n        if (bgColor) {\n            ctx.beginPath()\n            ctx.rect(0, 0, canvas.width, canvas.height)\n            ctx.fillStyle = bgColor\n            ctx.fill()\n            ctx.save()\n        }\n        ctx.save()\n\n        // rotate\n        ctx.translate(canvas.width / 2, canvas.height / 2)\n        ctx.rotate(degreesRad)\n        ctx.drawImage(canvasImage, -(canvasImage.width / 2), -(canvasImage.height / 2))\n        ctx.restore()\n\n        resolve(canvas)\n    })\n}\n","/**\n * @param width\n * @param height\n * @param opts{Object}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function centerInRectangle (width, height, opts = {}) {\n    let {bgColor = 'white'} = opts\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        canvas.width = width\n        canvas.height = height\n        let ctx = canvas.getContext('2d')\n        let newWidth = canvasImage.width\n        let newHeight = canvasImage.height\n        // set bg\n        if (bgColor) {\n            ctx.beginPath()\n            ctx.rect(0, 0, width, height)\n            ctx.fillStyle = bgColor\n            ctx.fill()\n            ctx.save()\n        }\n        // put image\n        let dx = 0\n        let dy = 0\n        let sx = 0\n        let sy = 0\n        if (newWidth < width) {\n            dx = (width - newWidth) / 2\n        }\n        if (newHeight < height) {\n            dy = (height - newHeight) / 2\n        }\n        ctx.drawImage(canvasImage, sx, sy, newWidth, newHeight, dx, dy, newWidth, newHeight)\n        resolve(canvas)\n    })\n}\n","/**\n * @param diametr\n * @param opts{Object}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function circle (diametr, opts = {}) {\n    let {padding = 4, bgColor = 'white'} = opts\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        canvas.width = diametr\n        canvas.height = diametr\n\n        let ctx = canvas.getContext('2d')\n        // set area and area bg color\n        ctx.beginPath()\n        ctx.rect(0, 0, diametr, diametr)\n        ctx.fillStyle = bgColor\n        ctx.fill()\n        ctx.save()\n        // set padding in cropped circle\n        let paddingSize = diametr - padding\n        let halfSize = Math.round(paddingSize / 2)\n        ctx.beginPath()\n        ctx.arc(halfSize + (padding / 2), halfSize + (padding / 2), halfSize - (padding / 2), 0, Math.PI * 2, true)\n        ctx.closePath()\n        ctx.clip()\n\n        ctx.drawImage(canvasImage, 0, 0, paddingSize, paddingSize)\n        ctx.restore()\n        resolve(canvas)\n    })\n}\n","/**\n * @param opts{Object}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function grayscale (opts = {}) {\n    let {rQ = 0.34, gQ = 0.5, bQ = 0.16} = opts\n\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        canvas.width = canvasImage.width\n        canvas.height = canvasImage.height\n\n        let ctx = canvas.getContext('2d')\n        ctx.drawImage(canvasImage, 0, 0)\n\n        let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height)\n        let data = imageData.data\n\n        for (let i = 0; i < data.length; i += 4) {\n            let brightness = rQ * data[i] + gQ * data[i + 1] + bQ * data[i + 2]\n\n            data[i] = brightness\n            data[i + 1] = brightness\n            data[i + 2] = brightness\n        }\n\n        ctx.putImageData(imageData, 0, 0)\n\n        resolve(canvas)\n    })\n}\n","/**\n * @param threshold{Number}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function pixelize (threshold) {\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        let ctx = canvas.getContext('2d')\n        canvas.width = canvasImage.width\n        canvas.height = canvasImage.height\n\n        // resize img to small\n        let smallW = canvasImage.width * threshold\n        let smallH = canvasImage.height * threshold\n        disableSmooth(ctx)\n        ctx.drawImage(canvasImage, 0, 0, smallW, smallH)\n\n        // and resize to full\n        disableSmooth(ctx)\n        ctx.drawImage(canvas, 0, 0, smallW, smallH, 0, 0, canvasImage.width, canvasImage.height)\n\n        resolve(canvas)\n    })\n}\n\nfunction disableSmooth (ctx) {\n    ctx.webkitImageSmoothingEnabled = false\n    ctx.mozImageSmoothingEnabled = false\n    ctx.msImageSmoothingEnabled = false\n    ctx.imageSmoothingEnabled = false\n}\n","function _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\n/**\n* StackBlur - a fast almost Gaussian Blur For Canvas\n*\n* In case you find this class useful - especially in commercial projects -\n* I am not totally unhappy for a small donation to my PayPal account\n* mario@quasimondo.de\n*\n* Or support me on flattr:\n* {@link https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript}\n* @module StackBlur\n* @version 0.5\n* @author Mario Klingemann\n* Contact: mario@quasimondo.com\n* Website: {@link http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html}\n* Twitter: @quasimondo\n*\n* @copyright (c) 2010 Mario Klingemann\n*\n* Permission is hereby granted, free of charge, to any person\n* obtaining a copy of this software and associated documentation\n* files (the \"Software\"), to deal in the Software without\n* restriction, including without limitation the rights to use,\n* copy, modify, merge, publish, distribute, sublicense, and/or sell\n* copies of the Software, and to permit persons to whom the\n* Software is furnished to do so, subject to the following\n* conditions:\n*\n* The above copyright notice and this permission notice shall be\n* included in all copies or substantial portions of the Software.\n*\n* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n* OTHER DEALINGS IN THE SOFTWARE.\n*/\nvar mulTable = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\nvar shgTable = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n/**\n * @param {string|HTMLImageElement} img\n * @param {string|HTMLCanvasElement} canvas\n * @param {Float} radius\n * @param {boolean} blurAlphaChannel\n * @returns {undefined}\n */\n\nfunction processImage(img, canvas, radius, blurAlphaChannel) {\n  if (typeof img === 'string') {\n    img = document.getElementById(img);\n  }\n\n  if (!img || !('naturalWidth' in img)) {\n    return;\n  }\n\n  var w = img.naturalWidth;\n  var h = img.naturalHeight;\n\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || !('getContext' in canvas)) {\n    return;\n  }\n\n  canvas.style.width = w + 'px';\n  canvas.style.height = h + 'px';\n  canvas.width = w;\n  canvas.height = h;\n  var context = canvas.getContext('2d');\n  context.clearRect(0, 0, w, h);\n  context.drawImage(img, 0, 0);\n\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  if (blurAlphaChannel) {\n    processCanvasRGBA(canvas, 0, 0, w, h, radius);\n  } else {\n    processCanvasRGB(canvas, 0, 0, w, h, radius);\n  }\n}\n/**\n * @param {string|HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @throws {Error|TypeError}\n * @returns {ImageData} See {@link https://html.spec.whatwg.org/multipage/canvas.html#imagedata}\n */\n\n\nfunction getImageDataFromCanvas(canvas, topX, topY, width, height) {\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas || _typeof(canvas) !== 'object' || !('getContext' in canvas)) {\n    throw new TypeError('Expecting canvas with `getContext` method in processCanvasRGB(A) calls!');\n  }\n\n  var context = canvas.getContext('2d');\n\n  try {\n    return context.getImageData(topX, topY, width, height);\n  } catch (e) {\n    throw new Error('unable to access image data: ' + e);\n  }\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGBA(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGBA(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGBA(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var x, y, i, p, yp, yi, yw, rSum, gSum, bSum, aSum, rOutSum, gOutSum, bOutSum, aOutSum, rInSum, gInSum, bInSum, aInSum, pr, pg, pb, pa, rbs;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null;\n  var stackOut = null;\n  yw = yi = 0;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n\n  for (y = 0; y < height; y++) {\n    rInSum = gInSum = bInSum = aInSum = rSum = gSum = bSum = aSum = 0;\n    rOutSum = radiusPlus1 * (pr = pixels[yi]);\n    gOutSum = radiusPlus1 * (pg = pixels[yi + 1]);\n    bOutSum = radiusPlus1 * (pb = pixels[yi + 2]);\n    aOutSum = radiusPlus1 * (pa = pixels[yi + 3]);\n    rSum += sumFactor * pr;\n    gSum += sumFactor * pg;\n    bSum += sumFactor * pb;\n    aSum += sumFactor * pa;\n    stack = stackStart;\n\n    for (i = 0; i < radiusPlus1; i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack.a = pa;\n      stack = stack.next;\n    }\n\n    for (i = 1; i < radiusPlus1; i++) {\n      p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n      rSum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);\n      gSum += (stack.g = pg = pixels[p + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[p + 2]) * rbs;\n      aSum += (stack.a = pa = pixels[p + 3]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      aInSum += pa;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (x = 0; x < width; x++) {\n      pixels[yi + 3] = pa = aSum * mulSum >> shgSum;\n\n      if (pa !== 0) {\n        pa = 255 / pa;\n        pixels[yi] = (rSum * mulSum >> shgSum) * pa;\n        pixels[yi + 1] = (gSum * mulSum >> shgSum) * pa;\n        pixels[yi + 2] = (bSum * mulSum >> shgSum) * pa;\n      } else {\n        pixels[yi] = pixels[yi + 1] = pixels[yi + 2] = 0;\n      }\n\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      aSum -= aOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      aOutSum -= stackIn.a;\n      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[p];\n      gInSum += stackIn.g = pixels[p + 1];\n      bInSum += stackIn.b = pixels[p + 2];\n      aInSum += stackIn.a = pixels[p + 3];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      aSum += aInSum;\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      aOutSum += pa = stackOut.a;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      aInSum -= pa;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (x = 0; x < width; x++) {\n    gInSum = bInSum = aInSum = rInSum = gSum = bSum = aSum = rSum = 0;\n    yi = x << 2;\n    rOutSum = radiusPlus1 * (pr = pixels[yi]);\n    gOutSum = radiusPlus1 * (pg = pixels[yi + 1]);\n    bOutSum = radiusPlus1 * (pb = pixels[yi + 2]);\n    aOutSum = radiusPlus1 * (pa = pixels[yi + 3]);\n    rSum += sumFactor * pr;\n    gSum += sumFactor * pg;\n    bSum += sumFactor * pb;\n    aSum += sumFactor * pa;\n    stack = stackStart;\n\n    for (i = 0; i < radiusPlus1; i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack.a = pa;\n      stack = stack.next;\n    }\n\n    yp = width;\n\n    for (i = 1; i <= radius; i++) {\n      yi = yp + x << 2;\n      rSum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);\n      gSum += (stack.g = pg = pixels[yi + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[yi + 2]) * rbs;\n      aSum += (stack.a = pa = pixels[yi + 3]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      aInSum += pa;\n      stack = stack.next;\n\n      if (i < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = x;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (y = 0; y < height; y++) {\n      p = yi << 2;\n      pixels[p + 3] = pa = aSum * mulSum >> shgSum;\n\n      if (pa > 0) {\n        pa = 255 / pa;\n        pixels[p] = (rSum * mulSum >> shgSum) * pa;\n        pixels[p + 1] = (gSum * mulSum >> shgSum) * pa;\n        pixels[p + 2] = (bSum * mulSum >> shgSum) * pa;\n      } else {\n        pixels[p] = pixels[p + 1] = pixels[p + 2] = 0;\n      }\n\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      aSum -= aOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      aOutSum -= stackIn.a;\n      p = x + ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;\n      rSum += rInSum += stackIn.r = pixels[p];\n      gSum += gInSum += stackIn.g = pixels[p + 1];\n      bSum += bInSum += stackIn.b = pixels[p + 2];\n      aSum += aInSum += stackIn.a = pixels[p + 3];\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      aOutSum += pa = stackOut.a;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      aInSum -= pa;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {undefined}\n */\n\n\nfunction processCanvasRGB(canvas, topX, topY, width, height, radius) {\n  if (isNaN(radius) || radius < 1) {\n    return;\n  }\n\n  radius |= 0;\n  var imageData = getImageDataFromCanvas(canvas, topX, topY, width, height);\n  imageData = processImageDataRGB(imageData, topX, topY, width, height, radius);\n  canvas.getContext('2d').putImageData(imageData, topX, topY);\n}\n/**\n * @param {ImageData} imageData\n * @param {Integer} topX\n * @param {Integer} topY\n * @param {Integer} width\n * @param {Integer} height\n * @param {Float} radius\n * @returns {ImageData}\n */\n\n\nfunction processImageDataRGB(imageData, topX, topY, width, height, radius) {\n  var pixels = imageData.data;\n  var x, y, i, p, yp, yi, yw, rSum, gSum, bSum, rOutSum, gOutSum, bOutSum, rInSum, gInSum, bInSum, pr, pg, pb, rbs;\n  var div = 2 * radius + 1; // const w4 = width << 2;\n\n  var widthMinus1 = width - 1;\n  var heightMinus1 = height - 1;\n  var radiusPlus1 = radius + 1;\n  var sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n  var stackStart = new BlurStack();\n  var stack = stackStart;\n  var stackEnd;\n\n  for (i = 1; i < div; i++) {\n    stack = stack.next = new BlurStack();\n\n    if (i === radiusPlus1) {\n      stackEnd = stack;\n    }\n  }\n\n  stack.next = stackStart;\n  var stackIn = null;\n  var stackOut = null;\n  yw = yi = 0;\n  var mulSum = mulTable[radius];\n  var shgSum = shgTable[radius];\n\n  for (y = 0; y < height; y++) {\n    rInSum = gInSum = bInSum = rSum = gSum = bSum = 0;\n    rOutSum = radiusPlus1 * (pr = pixels[yi]);\n    gOutSum = radiusPlus1 * (pg = pixels[yi + 1]);\n    bOutSum = radiusPlus1 * (pb = pixels[yi + 2]);\n    rSum += sumFactor * pr;\n    gSum += sumFactor * pg;\n    bSum += sumFactor * pb;\n    stack = stackStart;\n\n    for (i = 0; i < radiusPlus1; i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack = stack.next;\n    }\n\n    for (i = 1; i < radiusPlus1; i++) {\n      p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n      rSum += (stack.r = pr = pixels[p]) * (rbs = radiusPlus1 - i);\n      gSum += (stack.g = pg = pixels[p + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[p + 2]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      stack = stack.next;\n    }\n\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (x = 0; x < width; x++) {\n      pixels[yi] = rSum * mulSum >> shgSum;\n      pixels[yi + 1] = gSum * mulSum >> shgSum;\n      pixels[yi + 2] = bSum * mulSum >> shgSum;\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      p = yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1) << 2;\n      rInSum += stackIn.r = pixels[p];\n      gInSum += stackIn.g = pixels[p + 1];\n      bInSum += stackIn.b = pixels[p + 2];\n      rSum += rInSum;\n      gSum += gInSum;\n      bSum += bInSum;\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      stackOut = stackOut.next;\n      yi += 4;\n    }\n\n    yw += width;\n  }\n\n  for (x = 0; x < width; x++) {\n    gInSum = bInSum = rInSum = gSum = bSum = rSum = 0;\n    yi = x << 2;\n    rOutSum = radiusPlus1 * (pr = pixels[yi]);\n    gOutSum = radiusPlus1 * (pg = pixels[yi + 1]);\n    bOutSum = radiusPlus1 * (pb = pixels[yi + 2]);\n    rSum += sumFactor * pr;\n    gSum += sumFactor * pg;\n    bSum += sumFactor * pb;\n    stack = stackStart;\n\n    for (i = 0; i < radiusPlus1; i++) {\n      stack.r = pr;\n      stack.g = pg;\n      stack.b = pb;\n      stack = stack.next;\n    }\n\n    yp = width;\n\n    for (i = 1; i <= radius; i++) {\n      yi = yp + x << 2;\n      rSum += (stack.r = pr = pixels[yi]) * (rbs = radiusPlus1 - i);\n      gSum += (stack.g = pg = pixels[yi + 1]) * rbs;\n      bSum += (stack.b = pb = pixels[yi + 2]) * rbs;\n      rInSum += pr;\n      gInSum += pg;\n      bInSum += pb;\n      stack = stack.next;\n\n      if (i < heightMinus1) {\n        yp += width;\n      }\n    }\n\n    yi = x;\n    stackIn = stackStart;\n    stackOut = stackEnd;\n\n    for (y = 0; y < height; y++) {\n      p = yi << 2;\n      pixels[p] = rSum * mulSum >> shgSum;\n      pixels[p + 1] = gSum * mulSum >> shgSum;\n      pixels[p + 2] = bSum * mulSum >> shgSum;\n      rSum -= rOutSum;\n      gSum -= gOutSum;\n      bSum -= bOutSum;\n      rOutSum -= stackIn.r;\n      gOutSum -= stackIn.g;\n      bOutSum -= stackIn.b;\n      p = x + ((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width << 2;\n      rSum += rInSum += stackIn.r = pixels[p];\n      gSum += gInSum += stackIn.g = pixels[p + 1];\n      bSum += bInSum += stackIn.b = pixels[p + 2];\n      stackIn = stackIn.next;\n      rOutSum += pr = stackOut.r;\n      gOutSum += pg = stackOut.g;\n      bOutSum += pb = stackOut.b;\n      rInSum -= pr;\n      gInSum -= pg;\n      bInSum -= pb;\n      stackOut = stackOut.next;\n      yi += width;\n    }\n  }\n\n  return imageData;\n}\n/**\n *\n */\n\n\nvar BlurStack = function BlurStack() {\n  _classCallCheck(this, BlurStack);\n\n  this.r = 0;\n  this.g = 0;\n  this.b = 0;\n  this.a = 0;\n  this.next = null;\n};\n\nexport { BlurStack, processImage as image, processCanvasRGBA as canvasRGBA, processCanvasRGB as canvasRGB, processImageDataRGBA as imageDataRGBA, processImageDataRGB as imageDataRGB };\n","import * as StackBlur from 'stackblur-canvas'\n/**\n * @param radius{Number}\n * @returns {function(*=): Promise<HTMLCanvasElement>}\n */\nexport function gaussianBlur (radius) {\n    return (canvasImage) => new Promise((resolve, reject) => {\n        let canvas = document.createElement('canvas')\n        canvas.width = canvasImage.width\n        canvas.height = canvasImage.height\n\n        let ctx = canvas.getContext('2d')\n        ctx.drawImage(canvasImage, 0, 0)\n\n        StackBlur.canvasRGBA(canvas, 0, 0, canvasImage.width, canvasImage.height, radius)\n\n        resolve(canvas)\n    })\n}\n","/**\n * @param fileName{string}\n * @param mimeType{string}\n * @returns {string}\n */\nexport function fileExtByMimeType (fileName, mimeType) {\n    let tmp = fileName.split('.')\n    let ext = 'jpg'\n    if (mimeType.indexOf('png') > -1) {\n        ext = 'png'\n    } else if (mimeType.indexOf('webp') > -1) {\n        ext = 'webp'\n    }\n    tmp.pop()\n    tmp.push(ext)\n    return tmp.join('.')\n}\n","import {fileExtByMimeType} from '../helpers/fileExtByMimeType'\n\n/**\n * @param canvas{HTMLCanvasElement}\n * @param fileName\n * @param mimeType\n * @param q\n * @returns {Promise<File>}\n */\nexport function asBlob (canvas, fileName, mimeType, q) {\n    return new Promise((resolve, reject) => {\n        canvas.toBlob((blob) => {\n            // edge doesnt suppot new File, create Blob and set file.name\n            let fileOfBlob = new Blob([blob], {type: mimeType})\n            fileOfBlob.name = fileExtByMimeType(fileName, mimeType)\n            resolve(fileOfBlob)\n        }, mimeType, q)\n    })\n}\n","/**\n * @param canvas{HTMLCanvasElement}\n * @returns {Promise<HTMLCanvasElement>}\n */\nexport function asCanvas (canvas) {\n    return Promise.resolve(canvas)\n}\n","/**\n * @param canvas{HTMLCanvasElement}\n * @param mimeType\n * @param q\n * @returns {Promise<HTMLImageElement.src>}\n */\nexport function asImage (canvas, mimeType, q) {\n    return new Promise((resolve, reject) => {\n        let image = canvas.toDataURL(mimeType, q)\n        resolve(image)\n    })\n}\n","/**\n * Copyright (c) 2014, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * https://raw.github.com/facebook/regenerator/master/LICENSE file. An\n * additional grant of patent rights can be found in the PATENTS file in\n * the same directory.\n */\n\n!(function(global) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  var inModule = typeof module === \"object\";\n  var runtime = global.regeneratorRuntime;\n  if (runtime) {\n    if (inModule) {\n      // If regeneratorRuntime is defined globally and we're in a module,\n      // make the exports object identical to regeneratorRuntime.\n      module.exports = runtime;\n    }\n    // Don't bother evaluating the rest of this file if the runtime was\n    // already defined globally.\n    return;\n  }\n\n  // Define the runtime globally (as expected by generated code) as either\n  // module.exports (if we're in a module) or a new, empty object.\n  runtime = global.regeneratorRuntime = inModule ? module.exports : {};\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  runtime.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  runtime.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  runtime.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  runtime.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration. If the Promise is rejected, however, the\n          // result for this iteration will be rejected with the same\n          // reason. Note that rejections of yielded Promises are not\n          // thrown back into the generator function, as is the case\n          // when an awaited Promise is rejected. This difference in\n          // behavior between yield and await is important, because it\n          // allows the consumer to decide what to do with the yielded\n          // rejection (swallow it and continue, manually .throw it back\n          // into the generator, abandon iteration, whatever). With\n          // await, by contrast, there is no opportunity to examine the\n          // rejection reason outside the generator function, so the\n          // only option is to throw it from the await expression, and\n          // let the generator function handle the exception.\n          result.value = unwrapped;\n          resolve(result);\n        }, reject);\n      }\n    }\n\n    if (typeof global.process === \"object\" && global.process.domain) {\n      invoke = global.process.domain.bind(invoke);\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  runtime.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  runtime.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return runtime.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        if (delegate.iterator.return) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  runtime.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  runtime.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n})(\n  // Among the various tricks for obtaining a reference to the global\n  // object, this seems to be the most reliable technique that does not\n  // use indirect eval (which violates Content Security Policy).\n  typeof global === \"object\" ? global :\n  typeof window === \"object\" ? window :\n  typeof self === \"object\" ? self : this\n);\n","/* pica 4.1.1 nodeca/pica */(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.pica = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n// Collection of math functions\n//\n// 1. Combine components together\n// 2. Has async init to load wasm modules\n//\n'use strict';\n\nvar inherits = require('inherits');\nvar Multimath = require('multimath');\n\nvar mm_unsharp_mask = require('multimath/lib/unsharp_mask');\nvar mm_resize = require('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n\n  Multimath.call(this, features);\n\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm\n  };\n\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\ninherits(MathLib, Multimath);\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"inherits\":15,\"multimath\":16,\"multimath/lib/unsharp_mask\":19}],2:[function(require,module,exports){\n// Resize convolvers, pure JS implementation\n//\n'use strict';\n\n// Precision of fixed FP values\n//var FIXED_FRAC_BITS = 14;\n\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\n// Convolve image in horizontal directions and transpose output. In theory,\n// transpose allow:\n//\n// - use the same convolver for both passes (this fails due different\n//   types of input array and temporary buffer)\n// - making vertical pass by horisonltal lines inprove CPU cache use.\n//\n// But in real life this doesn't work :)\n//\nfunction convolveHorizontally(src, dest, srcW, srcH, destW, filters) {\n\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0;\n\n  // For each row\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0;\n\n    // Apply precomputed filters to each destination row point\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n\n      srcPtr = srcOffset + filterShift * 4 | 0;\n\n      r = g = b = a = 0;\n\n      // Apply the filter to the row to get the destination pixel r, g, b, a\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++];\n\n        // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      }\n\n      // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\n// Technically, convolvers are the same. But input array and temporary\n// buffer can be of different type (especially, in old browsers). So,\n// keep code in separate functions to avoid deoptimizations & speed loss.\n\nfunction convolveVertically(src, dest, srcW, srcH, destW, filters) {\n\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0;\n\n  // For each row\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0;\n\n    // Apply precomputed filters to each destination row point\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n\n      srcPtr = srcOffset + filterShift * 4 | 0;\n\n      r = g = b = a = 0;\n\n      // Apply the filter to the row to get the destination pixel r, g, b, a\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++];\n\n        // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      }\n\n      // Bring this value back in range. All of the filter scaling factors\n      // are in fixed point with FIXED_FRAC_BITS bits of fractional part.\n      //\n      // (!) Add 1/2 of value before clamping to get proper rounding. In other\n      // case brightness loss will be noticeable if you resize image with white\n      // border and place it on white background.\n      //\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14 /*FIXED_FRAC_BITS*/);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHorizontally: convolveHorizontally,\n  convolveVertically: convolveVertically\n};\n\n},{}],3:[function(require,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n\n/* eslint-disable max-len */\n\nmodule.exports = 'AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw==';\n\n},{}],4:[function(require,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'resize',\n  fn: require('./resize'),\n  wasm_fn: require('./resize_wasm'),\n  wasm_src: require('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(require,module,exports){\n'use strict';\n\nvar createFilters = require('./resize_filter_gen');\nvar convolveHorizontally = require('./convolve').convolveHorizontally;\nvar convolveVertically = require('./convolve').convolveVertically;\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n  while (ptr < len) {\n    dst[ptr] = 0xFF;ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY);\n\n  var tmp = new Uint8Array(destW * srcH * 4);\n\n  // To use single function we need src & tmp of the same type.\n  // But src can be CanvasPixelArray, and tmp - Uint8Array. So, keep\n  // vertical and horizontal passes separately to avoid deoptimization.\n\n  convolveHorizontally(src, tmp, srcW, srcH, destW, filtersX);\n  convolveVertically(tmp, dest, srcH, destW, destH, filtersY);\n\n  // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(require,module,exports){\n// Calculate convolution filters for each destination point,\n// and pack data to Int16Array:\n//\n// [ shift, length, data..., shift2, length2, data..., ... ]\n//\n// - shift - offset in src image\n// - length - filter length (in src points)\n// - data - filter values sequence\n//\n'use strict';\n\nvar FILTER_INFO = require('./resize_filter_info');\n\n// Precision of fixed FP values\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(quality, srcSize, destSize, scale, offset) {\n\n  var filterFunction = FILTER_INFO[quality].filter;\n\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n\n  // Filter window (averaging interval), scaled to src image\n  var srcWindow = FILTER_INFO[quality].win / scaleClamped;\n\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n\n  var slowCopy = !packedFilter.subarray || !packedFilter.set;\n\n  // For each destination pixel calculate source range and built filter values\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n\n    total = 0.0;\n\n    // Fill filter values for calculated range\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    }\n\n    // Normalize filter, convert to fixed point and accumulate conversion error\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    }\n\n    // Compensate normalization error, to minimize brightness drift\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal);\n\n    //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(require,module,exports){\n// Filter definitions to build tables for\n// resizing convolvers.\n//\n// Presets for quality 0..3. Filter functions + window size\n//\n'use strict';\n\nmodule.exports = [{ // Nearest neibor (Box)\n  win: 0.5,\n  filter: function filter(x) {\n    return x >= -0.5 && x < 0.5 ? 1.0 : 0.0;\n  }\n}, { // Hamming\n  win: 1.0,\n  filter: function filter(x) {\n    if (x <= -1.0 || x >= 1.0) {\n      return 0.0;\n    }\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n  }\n}, { // Lanczos, win = 2\n  win: 2.0,\n  filter: function filter(x) {\n    if (x <= -2.0 || x >= 2.0) {\n      return 0.0;\n    }\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n  }\n}, { // Lanczos, win = 3\n  win: 3.0,\n  filter: function filter(x) {\n    if (x <= -3.0 || x >= 3.0) {\n      return 0.0;\n    }\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) {\n      return 1.0;\n    }\n    var xpi = x * Math.PI;\n    return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n  }\n}];\n\n},{}],8:[function(require,module,exports){\n'use strict';\n\nvar createFilters = require('./resize_filter_gen');\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n  while (ptr < len) {\n    dst[ptr] = 0xFF;ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true;\n// should not crash everything on module load in old browsers\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var quality = typeof options.quality === 'undefined' ? 3 : options.quality;\n  var alpha = options.alpha || false;\n\n  var filtersX = createFilters(quality, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(quality, srcH, destH, scaleY, offsetY);\n\n  // destination is 0 too.\n  var src_offset = 0;\n  // buffer between convolve passes\n  var tmp_offset = this.__align(src_offset + Math.max(src.byteLength, dest.byteLength));\n  var filtersX_offset = this.__align(tmp_offset + srcH * destW * 4);\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes);\n\n  //\n  // Fill memory block with data to process\n  //\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n\n  // 32-bit copy is much faster in chrome\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32);\n\n  // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset);\n\n  //\n  // Now call webassembly method\n  // emsdk does method names with '_'\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH);\n\n  //\n  // Copy data back to typed array\n  //\n\n  // 32-bit copy is much faster in chrome\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n\n  // That's faster than doing checks in convolver.\n  // !!! Note, canvas data is not premultipled. We don't need other\n  // alpha corrections.\n\n  if (!alpha) resetAlpha(dest, destW, destH);\n\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(require,module,exports){\n'use strict';\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource = void 0;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],10:[function(require,module,exports){\n// Add intermediate resizing steps when scaling down by a very large factor.\n//\n// For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n// 300x300 first.\n//\n// It's needed because tiler has issues when the entire tile is scaled down\n// to a few pixels (1024px source tile with border size 3 should result in\n// at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n//\n// Also, adding intermediate steps can speed up processing if we use lower\n// quality algorithms for first stages.\n//\n\n'use strict';\n\n// min size = 0 results in infinite loop,\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight;\n\n  // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize;\n\n  // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale));\n\n  // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],11:[function(require,module,exports){\n// Split original image into multiple 1024x1024 chunks to reduce memory usage\n// (images have to be unpacked into typed arrays for resizing) and allow\n// parallel processing of multiple tiles at a time.\n//\n\n'use strict';\n\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder;\n\n  // prevent infinite loop, this should never happen\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile;\n\n  // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n      if (x < 0) {\n        x = 0;\n      }\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n      if (y < 0) {\n        y = 0;\n      }\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],12:[function(require,module,exports){\n'use strict';\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  //return (element.nodeName && element.nodeName.toLowerCase() === 'canvas') ||\n  var cname = objClass(element);\n\n  return cname === '[object HTMLCanvasElement]' /* browser */ || cname === '[object Canvas]' /* node-canvas */;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  //return element.nodeName && element.nodeName.toLowerCase() === 'img';\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n    case 1:\n      return 'low';\n    case 2:\n      return 'medium';\n  }\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support() {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined' || typeof document === 'undefined') {\n      return false;\n    }\n\n    var c = document.createElement('canvas');\n    c.width = 100;\n    c.height = 100;\n\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10;\n\n      // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  }).catch(function () {\n    return false;\n  });\n};\n\n},{}],13:[function(require,module,exports){\n// Web Worker wrapper for image resize function\n\n'use strict';\n\nmodule.exports = function () {\n  var MathLib = require('./mathlib');\n\n  var mathLib = void 0;\n\n  /* eslint-disable no-undef */\n  onmessage = function onmessage(ev) {\n    var opts = ev.data.opts;\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features);\n\n    // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n    var result = mathLib.resizeAndUnsharp(opts);\n\n    postMessage({ result: result }, [result.buffer]);\n  };\n};\n\n},{\"./mathlib\":1}],14:[function(require,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n  convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n}\n\nmodule.exports = blurMono16;\n\n},{}],15:[function(require,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n},{}],16:[function(require,module,exports){\n'use strict';\n\n\nvar assign         = require('object-assign');\nvar base64decode   = require('./lib/base64decode');\nvar hasWebAssembly = require('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n  this.has_wasm        = hasWebAssembly();\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (!this.has_wasm || !this.options.wasm || !module.wasm_fn) {\n    this[module.name] = module.fn;\n  } else {\n    this[module.name] = module.wasm_fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.has_wasm || !self.options.wasm || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":17,\"./lib/wa_detect\":23,\"object-assign\":24}],17:[function(require,module,exports){\n// base64 decode str -> Uint8Array, to load WA modules\n//\n'use strict';\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],18:[function(require,module,exports){\n// Calculates 16-bit precision HSL lightness from 8-bit rgba buffer\n//\n'use strict';\n\n\nmodule.exports = function hsl_l16_js(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, min, max;\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = (r >= g && r >= b) ? r : (g >= b && g >= r) ? g : b;\n    min = (r <= g && r <= b) ? r : (g <= b && g <= r) ? g : b;\n    out[i] = (max + min) * 257 >> 1;\n  }\n  return out;\n};\n\n},{}],19:[function(require,module,exports){\n'use strict';\n\nmodule.exports = {\n  name:     'unsharp_mask',\n  fn:       require('./unsharp_mask'),\n  wasm_fn:  require('./unsharp_mask_wasm'),\n  wasm_src: require('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":20,\"./unsharp_mask_wasm\":21,\"./unsharp_mask_wasm_base64\":22}],20:[function(require,module,exports){\n// Unsharp mask filter\n//\n// http://stackoverflow.com/a/23322820/1031804\n// USM(O) = O + (2 * (Amount / 100) * (O - GB))\n// GB - gaussian blur.\n//\n// Image is converted from RGB to HSL, unsharp mask is applied to the\n// lightness channel and then image is converted back to RGB.\n//\n'use strict';\n\n\nvar glur_mono16 = require('glur/mono16');\nvar hsl_l16     = require('./hsl_l16');\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var r, g, b;\n  var h, s, l;\n  var min, max;\n  var m1, m2, hShifted;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var lightness = hsl_l16(img, width, height);\n\n  var blured = new Uint16Array(lightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n\n  var amountFp = (amount / 100 * 0x1000 + 0.5)|0;\n  var thresholdFp = (threshold * 257)|0;\n\n  var size = width * height;\n\n  /* eslint-disable indent */\n  for (var i = 0; i < size; i++) {\n    diff = 2 * (lightness[i] - blured[i]);\n\n    if (Math.abs(diff) >= thresholdFp) {\n      iTimes4 = i * 4;\n      r = img[iTimes4];\n      g = img[iTimes4 + 1];\n      b = img[iTimes4 + 2];\n\n      // convert RGB to HSL\n      // take RGB, 8-bit unsigned integer per each channel\n      // save HSL, H and L are 16-bit unsigned integers, S is 12-bit unsigned integer\n      // math is taken from here: http://www.easyrgb.com/index.php?X=MATH&H=18\n      // and adopted to be integer (fixed point in fact) for sake of performance\n      max = (r >= g && r >= b) ? r : (g >= r && g >= b) ? g : b; // min and max are in [0..0xff]\n      min = (r <= g && r <= b) ? r : (g <= r && g <= b) ? g : b;\n      l = (max + min) * 257 >> 1; // l is in [0..0xffff] that is caused by multiplication by 257\n\n      if (min === max) {\n        h = s = 0;\n      } else {\n        s = (l <= 0x7fff) ?\n          (((max - min) * 0xfff) / (max + min))|0 :\n          (((max - min) * 0xfff) / (2 * 0xff - max - min))|0; // s is in [0..0xfff]\n        // h could be less 0, it will be fixed in backward conversion to RGB, |h| <= 0xffff / 6\n        h = (r === max) ? (((g - b) * 0xffff) / (6 * (max - min)))|0\n          : (g === max) ? 0x5555 + ((((b - r) * 0xffff) / (6 * (max - min)))|0) // 0x5555 == 0xffff / 3\n          : 0xaaaa + ((((r - g) * 0xffff) / (6 * (max - min)))|0); // 0xaaaa == 0xffff * 2 / 3\n      }\n\n      // add unsharp mask mask to the lightness channel\n      l += (amountFp * diff + 0x800) >> 12;\n      if (l > 0xffff) {\n        l = 0xffff;\n      } else if (l < 0) {\n        l = 0;\n      }\n\n      // convert HSL back to RGB\n      // for information about math look above\n      if (s === 0) {\n        r = g = b = l >> 8;\n      } else {\n        m2 = (l <= 0x7fff) ? (l * (0x1000 + s) + 0x800) >> 12 :\n          l  + (((0xffff - l) * s + 0x800) >>  12);\n        m1 = 2 * l - m2 >> 8;\n        m2 >>= 8;\n        // save result to RGB channels\n        // R channel\n        hShifted = (h + 0x5555) & 0xffff; // 0x5555 == 0xffff / 3\n        r = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // G channel\n        hShifted = h & 0xffff;\n        g = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n        // B channel\n        hShifted = (h - 0x5555) & 0xffff;\n        b = (hShifted >= 0xaaaa) ? m1 // 0xaaaa == 0xffff * 2 / 3\n          : (hShifted >= 0x7fff) ?  m1 + ((m2 - m1) * 6 * (0xaaaa - hShifted) + 0x8000 >> 16)\n          : (hShifted >= 0x2aaa) ? m2 // 0x2aaa == 0xffff / 6\n          : m1 + ((m2 - m1) * 6 * hShifted + 0x8000 >> 16);\n      }\n\n      img[iTimes4] = r;\n      img[iTimes4 + 1] = g;\n      img[iTimes4 + 2] = b;\n    }\n  }\n};\n\n},{\"./hsl_l16\":18,\"glur/mono16\":14}],21:[function(require,module,exports){\n'use strict';\n\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n\n  var img_bytes_cnt        = pixels * 4;\n  var hsl_bytes_cnt        = pixels * 2;\n  var blur_bytes_cnt       = pixels * 2;\n  var blur_line_byte_cnt   = Math.max(width, height) * 4; // float32 array\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset         = 0;\n  var hsl_offset         = img_bytes_cnt;\n  var blur_offset        = hsl_offset + hsl_bytes_cnt;\n  var blur_tmp_offset    = blur_offset + blur_bytes_cnt;\n  var blur_line_offset   = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance(\n    'unsharp_mask',\n    img_bytes_cnt + hsl_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt,\n    { exp: Math.exp }\n  );\n\n  // 32-bit copy is much faster in chrome\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32);\n\n  // HSL\n  var fn = instance.exports.hsl_l16 || instance.exports._hsl_l16;\n  fn(img_offset, hsl_offset, width, height);\n\n  // BLUR\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsl_offset, blur_offset, blur_tmp_offset,\n    blur_line_offset, blur_coeffs_offset, width, height, radius);\n\n  // UNSHARP\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsl_offset,\n    blur_offset, width, height, amount, threshold);\n\n  // 32-bit copy is much faster in chrome\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],22:[function(require,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n\n/* eslint-disable max-len */\nmodule.exports = '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';\n\n},{}],23:[function(require,module,exports){\n// Detect WebAssembly support.\n// - Check global WebAssembly object\n// - Try to load simple module (can be disabled via CSP)\n//\n'use strict';\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],24:[function(require,module,exports){\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],25:[function(require,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/\":[function(require,module,exports){\n'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar assign = require('object-assign');\nvar webworkify = require('webworkify');\n\nvar MathLib = require('./lib/mathlib');\nvar Pool = require('./lib/pool');\nvar utils = require('./lib/utils');\nvar worker = require('./lib/worker');\nvar createStages = require('./lib/stepper');\nvar createRegions = require('./lib/tiler');\n\n// Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\nvar singletones = {};\n\nvar NEED_SAFARI_FIX = false;\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000\n};\n\nvar DEFAULT_RESIZE_OPTS = {\n  quality: 3,\n  alpha: false,\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\n\nvar CAN_NEW_IMAGE_DATA = void 0;\nvar CAN_CREATE_IMAGE_BITMAP = void 0;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// API methods\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n\n  var limiter_key = 'lk_' + this.options.concurrency;\n\n  // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit;\n\n  // List of supported features, according to options & browser/node.js\n  this.features = {\n    js: false, // pure JS implementation, can be disabled for testing\n    wasm: false, // webassembly implementation for heavy functions\n    cib: false, // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n  };\n\n  this.__workersPool = null;\n\n  // Store requested features for webworkers\n  this.__requested_features = [];\n\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise;\n\n  // Test if we can create ImageData without canvas and memory copy\n  if (CAN_NEW_IMAGE_DATA !== false && CAN_NEW_IMAGE_DATA !== true) {\n    CAN_NEW_IMAGE_DATA = false;\n    if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n      try {\n        /* eslint-disable no-new */\n        new ImageData(new Uint8ClampedArray(400), 10, 10);\n        CAN_NEW_IMAGE_DATA = true;\n      } catch (__) {}\n    }\n  }\n\n  // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n  if (CAN_CREATE_IMAGE_BITMAP !== false && CAN_CREATE_IMAGE_BITMAP !== true) {\n    CAN_CREATE_IMAGE_BITMAP = false;\n    if (typeof ImageBitmap !== 'undefined') {\n      if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n        CAN_CREATE_IMAGE_BITMAP = true;\n      } else {\n        this.debug('ImageBitmap does not support .close(), disabled');\n      }\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n\n  this.__mathlib = new MathLib(features);\n\n  // Check WebWorker support if requested\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = require('webworkify')(function () {});\n        wkr.terminate();\n        this.features.ww = true;\n\n        // pool uniqueness depends on pool config + webworker config\n        var wpool_key = 'wp_' + JSON.stringify(this.options);\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize = void 0;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support().then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  // Init math lib. That's async because can load some\n  this.__initPromise = Promise.all([initMath, checkCibResize]).then(function () {\n    return _this;\n  });\n\n  return this.__initPromise;\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this2 = this;\n\n  this.debug('Start resize...');\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, { quality: options });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height;\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n\n  var canceled = false;\n  var cancelToken = null;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    cancelToken = opts.cancelToken.then(function (data) {\n      canceled = true;throw data;\n    }, function (err) {\n      canceled = true;throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n  var destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n\n  return this.init().then(function () {\n    if (canceled) return cancelToken;\n\n    // if createImageBitmap supports resize, just do it and return\n    if (_this2.features.cib) {\n      var toCtx = to.getContext('2d', { alpha: Boolean(opts.alpha) });\n\n      _this2.debug('Resize via createImageBitmap()');\n\n      return createImageBitmap(from, {\n        resizeWidth: opts.toWidth,\n        resizeHeight: opts.toHeight,\n        resizeQuality: utils.cib_quality_name(opts.quality)\n      }).then(function (imageBitmap) {\n        if (canceled) return cancelToken;\n\n        // if no unsharp - draw directly to output canvas\n        if (!opts.unsharpAmount) {\n          toCtx.drawImage(imageBitmap, 0, 0);\n          imageBitmap.close();\n          toCtx = null;\n\n          _this2.debug('Finished!');\n\n          return to;\n        }\n\n        _this2.debug('Unsharp result');\n\n        var tmpCanvas = document.createElement('canvas');\n\n        tmpCanvas.width = opts.toWidth;\n        tmpCanvas.height = opts.toHeight;\n\n        var tmpCtx = tmpCanvas.getContext('2d', { alpha: Boolean(opts.alpha) });\n\n        tmpCtx.drawImage(imageBitmap, 0, 0);\n        imageBitmap.close();\n\n        var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n        _this2.__mathlib.unsharp(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n        toCtx.putImageData(iData, 0, 0);\n        iData = tmpCtx = tmpCanvas = toCtx = null;\n\n        _this2.debug('Finished!');\n\n        return to;\n      });\n    }\n\n    //\n    // No easy way, let's resize manually via arrays\n    //\n\n    // Share cache between calls:\n    //\n    // - wasm instance\n    // - wasm memory object\n    //\n    var cache = {};\n\n    // Call resizer in webworker or locally, depending on config\n    var invokeResize = function invokeResize(opts) {\n      return Promise.resolve().then(function () {\n        if (!_this2.features.ww) return _this2.__mathlib.resizeAndUnsharp(opts, cache);\n\n        return new Promise(function (resolve, reject) {\n          var w = _this2.__workersPool.acquire();\n\n          if (cancelToken) cancelToken.catch(function (err) {\n            return reject(err);\n          });\n\n          w.value.onmessage = function (ev) {\n            w.release();\n\n            if (ev.data.err) reject(ev.data.err);else resolve(ev.data.result);\n          };\n\n          w.value.postMessage({\n            opts: opts,\n            features: _this2.__requested_features,\n            preload: {\n              wasm_nodule: _this2.__mathlib.__\n            }\n          }, [opts.src.buffer]);\n        });\n      });\n    };\n\n    var tileAndResize = function tileAndResize(from, to, opts) {\n      var srcCtx = void 0;\n      var srcImageBitmap = void 0;\n      var toCtx = void 0;\n\n      var processTile = function processTile(tile) {\n        return _this2.__limit(function () {\n          if (canceled) return cancelToken;\n\n          var srcImageData = void 0;\n\n          // Extract tile RGBA buffer, depending on input type\n          if (utils.isCanvas(from)) {\n            _this2.debug('Get tile pixel data');\n\n            // If input is Canvas - extract region data directly\n            srcImageData = srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height);\n          } else {\n            // If input is Image or decoded to ImageBitmap,\n            // draw region to temporary canvas and extract data from it\n            //\n            // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n            //\n            _this2.debug('Draw tile imageBitmap/image to temporary canvas');\n\n            var tmpCanvas = document.createElement('canvas');\n            tmpCanvas.width = tile.width;\n            tmpCanvas.height = tile.height;\n\n            var tmpCtx = tmpCanvas.getContext('2d', { alpha: Boolean(opts.alpha) });\n            tmpCtx.globalCompositeOperation = 'copy';\n            tmpCtx.drawImage(srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n\n            _this2.debug('Get tile pixel data');\n\n            srcImageData = tmpCtx.getImageData(0, 0, tile.width, tile.height);\n            tmpCtx = tmpCanvas = null;\n          }\n\n          var o = {\n            src: srcImageData.data,\n            width: tile.width,\n            height: tile.height,\n            toWidth: tile.toWidth,\n            toHeight: tile.toHeight,\n            scaleX: tile.scaleX,\n            scaleY: tile.scaleY,\n            offsetX: tile.offsetX,\n            offsetY: tile.offsetY,\n            quality: opts.quality,\n            alpha: opts.alpha,\n            unsharpAmount: opts.unsharpAmount,\n            unsharpRadius: opts.unsharpRadius,\n            unsharpThreshold: opts.unsharpThreshold\n          };\n\n          _this2.debug('Invoke resize math');\n\n          return Promise.resolve().then(function () {\n            return invokeResize(o);\n          }).then(function (result) {\n            if (canceled) return cancelToken;\n\n            srcImageData = null;\n\n            var toImageData = void 0;\n\n            _this2.debug('Convert raw rgba tile result to ImageData');\n\n            if (CAN_NEW_IMAGE_DATA) {\n              // this branch is for modern browsers\n              // If `new ImageData()` & Uint8ClampedArray suported\n              toImageData = new ImageData(new Uint8ClampedArray(result), tile.toWidth, tile.toHeight);\n            } else {\n              // fallback for `node-canvas` and old browsers\n              // (IE11 has ImageData but does not support `new ImageData()`)\n              toImageData = toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n              if (toImageData.data.set) {\n                toImageData.data.set(result);\n              } else {\n                // IE9 don't have `.set()`\n                for (var i = toImageData.data.length - 1; i >= 0; i--) {\n                  toImageData.data[i] = result[i];\n                }\n              }\n            }\n\n            _this2.debug('Draw tile');\n\n            if (NEED_SAFARI_FIX) {\n              // Safari draws thin white stripes between tiles without this fix\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n            } else {\n              toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n            }\n\n            return null;\n          });\n        });\n      };\n\n      // Need to normalize data source first. It can be canvas or image.\n      // If image - try to decode in background if possible\n      return Promise.resolve().then(function () {\n        toCtx = to.getContext('2d', { alpha: Boolean(opts.alpha) });\n\n        if (utils.isCanvas(from)) {\n          srcCtx = from.getContext('2d', { alpha: Boolean(opts.alpha) });\n          return null;\n        }\n\n        if (utils.isImage(from)) {\n          // try do decode image in background for faster next operations\n          if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n          _this2.debug('Decode image via createImageBitmap');\n\n          return createImageBitmap(from).then(function (imageBitmap) {\n            srcImageBitmap = imageBitmap;\n          });\n        }\n\n        throw new Error('\".from\" should be image or canvas');\n      }).then(function () {\n        if (canceled) return cancelToken;\n\n        _this2.debug('Calculate tiles');\n\n        //\n        // Here we are with \"normalized\" source,\n        // follow to tiling\n        //\n\n        var regions = createRegions({\n          width: opts.width,\n          height: opts.height,\n          srcTileSize: _this2.options.tile,\n          toWidth: opts.toWidth,\n          toHeight: opts.toHeight,\n          destTileBorder: destTileBorder\n        });\n\n        var jobs = regions.map(function (tile) {\n          return processTile(tile);\n        });\n\n        function cleanup() {\n          if (srcImageBitmap) {\n            srcImageBitmap.close();\n            srcImageBitmap = null;\n          }\n        }\n\n        _this2.debug('Process tiles');\n\n        return Promise.all(jobs).then(function () {\n          _this2.debug('Finished!');\n          cleanup();return to;\n        }, function (err) {\n          cleanup();throw err;\n        });\n      });\n    };\n\n    var processStages = function processStages(stages, from, to, opts) {\n      if (canceled) return cancelToken;\n\n      var _stages$shift = stages.shift(),\n          _stages$shift2 = _slicedToArray(_stages$shift, 2),\n          toWidth = _stages$shift2[0],\n          toHeight = _stages$shift2[1];\n\n      var isLastStage = stages.length === 0;\n\n      opts = assign({}, opts, {\n        toWidth: toWidth,\n        toHeight: toHeight,\n        // only use user-defined quality for the last stage,\n        // use simpler (Hamming) filter for the first stages where\n        // scale factor is large enough (more than 2-3)\n        quality: isLastStage ? opts.quality : Math.min(1, opts.quality)\n      });\n\n      var tmpCanvas = void 0;\n\n      if (!isLastStage) {\n        // create temporary canvas\n        tmpCanvas = document.createElement('canvas');\n        tmpCanvas.width = toWidth;\n        tmpCanvas.height = toHeight;\n      }\n\n      return tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n        if (isLastStage) return to;\n\n        opts.width = toWidth;\n        opts.height = toHeight;\n        return processStages(stages, tmpCanvas, to, opts);\n      });\n    };\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this2.options.tile, destTileBorder);\n\n    return processStages(stages, from, to, opts);\n  });\n};\n\n// RGBA buffer resize\n//\nPica.prototype.resizeBuffer = function (options) {\n  var _this3 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options);\n\n  return this.init().then(function () {\n    return _this3.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    // Fallback for old browsers\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], { type: mimeType }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/pool\":9,\"./lib/stepper\":10,\"./lib/tiler\":11,\"./lib/utils\":12,\"./lib/worker\":13,\"object-assign\":24,\"webworkify\":25}]},{},[])(\"/\")\n});\n","export const RESIZE_TYPE_SQUARE = 'square'\nexport const RESIZE_TYPE_TO = 'to'\n\nexport const MANIPULATION = 'MANIPULATION'\nexport const LOADER = 'LOADER'\nexport const FILTER = 'FILTER'\n","import {loadBlob} from './loaders/loadBlob.js'\nimport {loadCanvas} from './loaders/loadCanvas.js'\nimport {imageCrop, imageResize} from './manipulations/imageResize.js'\nimport {rotate} from './manipulations/rotate.js'\nimport {centerInRectangle} from './manipulations/centerInRectangle.js'\nimport {circle} from './manipulations/circle.js'\nimport {grayscale} from './filters/grayscale.js'\nimport {pixelize} from './filters/pixelize.js'\nimport {gaussianBlur} from './filters/gaussianBlur.js'\nimport {asBlob} from './savers/asBlob'\nimport {asCanvas} from './savers/asCanvas'\nimport {asImage} from './savers/asImage'\n\nimport {RESIZE_TYPE_SQUARE, RESIZE_TYPE_TO, MANIPULATION, LOADER, FILTER} from './constants'\n\nexport class ImageManipulation {\n    constructor () {\n        this._tasks = []\n\n        this._canvas = null\n        this._loadedCanvas = null\n        this._lastCanvas = null\n\n        this._fileName = null\n    }\n\n    /**\n     * @param imageFile{File}\n     * @returns {ImageManipulation}\n     */\n    loadBlob (imageFile) {\n        this._addToTask(LOADER, loadBlob(imageFile))\n        return this\n    }\n\n    /**\n     * @param canvas{HTMLCanvasElement}\n     * @param fileName{String}\n     * @returns {ImageManipulation}\n     */\n    loadCanvas (canvas, fileName = 'canvas.png') {\n        this._addToTask(LOADER, loadCanvas(canvas, fileName))\n        return this\n    }\n\n    /**\n     * @param maxWidth\n     * @param maxHeight\n     * @param type\n     * @param options\n     * @returns {ImageManipulation}\n     * @private\n     */\n    _imageResize (maxWidth = 200, maxHeight = 100, type = null, options = {}) {\n        this._addToTask(MANIPULATION, imageResize(maxWidth, maxHeight, type, options))\n        return this\n    }\n\n    /**\n     * @param length\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    toSquare (length = 150, opts = {}) {\n        return this._imageResize(length, length, RESIZE_TYPE_SQUARE, opts)\n    }\n\n    /**\n     * @param width {number} - width to crop to.\n     * @param height {number} - height to crop to.\n     * @param offsetX{number} - If specified, cropping will start from that offset on X axis,\n     * otherwise it will crop so result is centered in the source\n     * @param offsetY{number} - If specified, cropping will start from that offset on Y axis,\n     * otherwise it will crop so result is centered in the source\n     * @returns {ImageManipulation}\n     */\n    crop (maxWidth, maxHeight, offsetX, offsetY) {\n        this._addToTask(MANIPULATION, imageCrop(maxWidth, maxHeight, offsetX, offsetY))\n        return this\n    }\n\n    /**\n     *\n     * @param maxWidth\n     * @param maxHeight\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    resize (maxWidth = 200, maxHeight = 100, opts = {}) {\n        return this._imageResize(maxWidth, maxHeight, RESIZE_TYPE_TO, opts)\n    }\n\n    /**\n     *\n     * @param degrees\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    rotate (degrees, opts = {}) {\n        this._addToTask(MANIPULATION, rotate(degrees, opts))\n        return this\n    }\n\n    /**\n     *\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    toGrayscale (opts = {}) {\n        this._addToTask(FILTER, grayscale(opts))\n        return this\n    }\n\n    /**\n     *\n     * @param threshold{Number}\n     * @returns {ImageManipulation}\n     */\n    pixelize (threshold = 0.2) {\n        this._addToTask(FILTER, pixelize(threshold))\n        return this\n    }\n\n    /**\n     *\n     * @param radius{Number}\n     * @returns {ImageManipulation}\n     */\n    gaussianBlur (radius = 10) {\n        this._addToTask(FILTER, gaussianBlur(radius))\n        return this\n    }\n\n    /**\n     *\n     * @param width\n     * @param height\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    centerInRectangle (width = 200, height = 100, opts = {}) {\n        // resize\n        this._imageResize(width, height, RESIZE_TYPE_TO, opts)\n        // fit\n        this._addToTask(MANIPULATION, centerInRectangle(width, height, opts))\n        return this\n    }\n\n    /**\n     * @param diametr\n     * @param opts{Object}\n     * @returns {ImageManipulation}\n     */\n    toCircle (diametr = 150, opts = {}) {\n        // resize to square first\n        this._imageResize(diametr, diametr, RESIZE_TYPE_SQUARE, opts)\n        this._addToTask(MANIPULATION, circle(diametr, opts))\n        return this\n    }\n\n    /**\n     * @returns {Promise}\n     */\n    async _runTasks () {\n        this._canvas = null\n        for (let i = 0; i < this._tasks.length; i++) {\n            // if type loader, covert image to canvas and save in _loadedCanvas\n            if (this._tasks[i].type === LOADER) {\n                let data = await this._tasks[i].func()\n                this._loadedCanvas = data.canvas\n                if (data.fileName) {\n                    this._fileName = data.fileName;\n                }\n            } else {\n                if (this._canvas === null && this._loadedCanvas === null) {\n                    throw new Error('use loadBlob first')\n                }\n                this._canvas = await this._tasks[i].func(this._canvas || this._loadedCanvas)\n            }\n        }\n        this._cleanTasks()\n    }\n\n    /**\n     * @param type{String}\n     * @param func{Function}\n     * @private\n     */\n    _addToTask (type = 'manipulation', func) {\n        this._tasks.push({type, func})\n    }\n\n    _cleanTasks () {\n        this._tasks = []\n        // save last canvas\n        // for save image after all convert in same formats\n        if (this._canvas !== null) {\n            this._lastCanvas = this._canvas\n        }\n    }\n\n    /**\n     * @returns {HTMLCanvasElement}\n     */\n    getCanvas () {\n        return this._canvas || this._lastCanvas\n    }\n\n    /**\n     *\n     * @returns {String}\n     */\n    getFileName () {\n        return this._fileName\n    }\n\n    /**\n     *\n     * @param newFileName - New filename to be used in mime type definition\n     */\n    setFileName (newFileName) {\n        this._fileName = newFileName;\n    }\n\n    /**\n     * @param mimeType\n     * @param q\n     * @returns {Promise<File>}\n     */\n    saveAsBlob (mimeType = 'image/jpeg', q = '1.0') {\n        return this._runTasks().then(() => asBlob(this.getCanvas(), this.getFileName(), mimeType, q))\n    }\n\n    /**\n     * @returns {Promise<HTMLCanvasElement>}\n     */\n    saveAsCanvas () {\n        return this._runTasks().then(() => asCanvas(this.getCanvas()))\n    }\n\n    /**\n     * @param mimeType\n     * @param q\n     * @returns {Promise<HTMLImageElement.src>}\n     */\n    saveAsImage (mimeType = 'image/jpeg', q = '1.0') {\n        return this._runTasks().then(() => asImage(this.getCanvas(), mimeType, q))\n    }\n}\n","/*\n * JavaScript Canvas to Blob\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/* global atob, Blob, define */\n\n;(function (window) {\n  'use strict'\n\n  var CanvasPrototype =\n    window.HTMLCanvasElement && window.HTMLCanvasElement.prototype\n  var hasBlobConstructor =\n    window.Blob &&\n    (function () {\n      try {\n        return Boolean(new Blob())\n      } catch (e) {\n        return false\n      }\n    })()\n  var hasArrayBufferViewSupport =\n    hasBlobConstructor &&\n    window.Uint8Array &&\n    (function () {\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100\n      } catch (e) {\n        return false\n      }\n    })()\n  var BlobBuilder =\n    window.BlobBuilder ||\n    window.WebKitBlobBuilder ||\n    window.MozBlobBuilder ||\n    window.MSBlobBuilder\n  var dataURIPattern = /^data:((.*?)(;charset=.*?)?)(;base64)?,/\n  var dataURLtoBlob =\n    (hasBlobConstructor || BlobBuilder) &&\n    window.atob &&\n    window.ArrayBuffer &&\n    window.Uint8Array &&\n    function (dataURI) {\n      var matches,\n        mediaType,\n        isBase64,\n        dataString,\n        byteString,\n        arrayBuffer,\n        intArray,\n        i,\n        bb\n      // Parse the dataURI components as per RFC 2397\n      matches = dataURI.match(dataURIPattern)\n      if (!matches) {\n        throw new Error('invalid data URI')\n      }\n      // Default to text/plain;charset=US-ASCII\n      mediaType = matches[2]\n        ? matches[1]\n        : 'text/plain' + (matches[3] || ';charset=US-ASCII')\n      isBase64 = !!matches[4]\n      dataString = dataURI.slice(matches[0].length)\n      if (isBase64) {\n        // Convert base64 to raw binary data held in a string:\n        byteString = atob(dataString)\n      } else {\n        // Convert base64/URLEncoded data component to raw binary:\n        byteString = decodeURIComponent(dataString)\n      }\n      // Write the bytes of the string to an ArrayBuffer:\n      arrayBuffer = new ArrayBuffer(byteString.length)\n      intArray = new Uint8Array(arrayBuffer)\n      for (i = 0; i < byteString.length; i += 1) {\n        intArray[i] = byteString.charCodeAt(i)\n      }\n      // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n      if (hasBlobConstructor) {\n        return new Blob([hasArrayBufferViewSupport ? intArray : arrayBuffer], {\n          type: mediaType\n        })\n      }\n      bb = new BlobBuilder()\n      bb.append(arrayBuffer)\n      return bb.getBlob(mediaType)\n    }\n  if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n    if (CanvasPrototype.mozGetAsFile) {\n      CanvasPrototype.toBlob = function (callback, type, quality) {\n        var self = this\n        setTimeout(function () {\n          if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n            callback(dataURLtoBlob(self.toDataURL(type, quality)))\n          } else {\n            callback(self.mozGetAsFile('blob', type))\n          }\n        })\n      }\n    } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n      CanvasPrototype.toBlob = function (callback, type, quality) {\n        var self = this\n        setTimeout(function () {\n          callback(dataURLtoBlob(self.toDataURL(type, quality)))\n        })\n      }\n    }\n  }\n  if (typeof define === 'function' && define.amd) {\n    define(function () {\n      return dataURLtoBlob\n    })\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = dataURLtoBlob\n  } else {\n    window.dataURLtoBlob = dataURLtoBlob\n  }\n})(window)\n","import 'regenerator-runtime/runtime'\nimport {ImageManipulation} from './src/ImageManipulation.js'\nimport 'blueimp-canvas-to-blob'\n\nif (typeof window !== 'undefined') {\n    window.BrowserImageManipulation = ImageManipulation\n}\n\nexport default ImageManipulation\n"],"names":["loadBlob","imageFile","Promise","resolve","reject","image","document","createElement","reader","FileReader","onload","data","src","target","result","onerror","Error","canvas","width","height","getContext","drawImage","fileName","name","readAsDataURL","loadCanvas","imageCrop","newWidth","newHeight","offsetX","offsetY","canvasImage","sx","sy","cropedCanvas","cropedCanvasCtx","imageResize","maxWidth","maxHeight","type","options","resizeOptions","Object","assign","outputCanvas","ratio","RESIZE_TYPE_SQUARE","RESIZE_TYPE_TO","ratioWidth","ratioHeight","Math","round","Pica","resize","pica","then","resizedCanvas","degreesToRadian","degrees","PI","rotate","opts","padding","bgColor","calcAngle","degreesRad","calcAngleRad","angleRad","sinCos","cos","sin","key","cosAngle","cosCalcAngle","sinAngle","sinCalcAngle","ctx","beginPath","rect","fillStyle","fill","save","translate","restore","centerInRectangle","dx","dy","circle","diametr","paddingSize","halfSize","arc","closePath","clip","grayscale","rQ","gQ","bQ","imageData","getImageData","i","length","brightness","putImageData","pixelize","threshold","smallW","smallH","disableSmooth","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","imageSmoothingEnabled","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","getImageDataFromCanvas","topX","topY","getElementById","context","e","processCanvasRGBA","radius","isNaN","processImageDataRGBA","x","y","p","yp","yi","yw","rSum","gSum","bSum","aSum","rOutSum","gOutSum","bOutSum","aOutSum","rInSum","gInSum","bInSum","aInSum","pr","pg","pb","pa","rbs","stackEnd","pixels","div","widthMinus1","heightMinus1","radiusPlus1","sumFactor","stackStart","BlurStack","stack","next","stackIn","stackOut","mulSum","mulTable","shgSum","shgTable","r","g","b","a","gaussianBlur","fileExtByMimeType","mimeType","tmp","split","ext","indexOf","pop","push","join","asBlob","q","toBlob","blob","fileOfBlob","Blob","asCanvas","asImage","toDataURL","global","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","Context","_invoke","makeInvokeMethod","tryCatch","fn","arg","call","err","GeneratorFunction","GeneratorFunctionPrototype","defineIteratorMethods","forEach","method","this","AsyncIterator","invoke","record","value","hasOwn","__await","unwrapped","enqueue","callInvokeWithMethodAndArg","previousPromise","process","domain","bind","state","GenStateSuspendedStart","GenStateExecuting","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","done","GenStateSuspendedYield","undefined","return","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","values","iterable","iteratorMethod","iteratorSymbol","Op","hasOwnProperty","$Symbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","runtime","regeneratorRuntime","module","exports","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","toString","keys","object","reverse","skipTempReset","prev","charAt","slice","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","window","f","n","t","o","c","require","u","code","1","MathLib","requested_features","__requested_features","features","js","wasm","Multimath","has_wasm","use","mm_unsharp_mask","mm_resize","inherits","resizeAndUnsharp","cache","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","./mm_resize","multimath","multimath/lib/unsharp_mask","2","clampTo8","convolveHorizontally","dest","srcW","srcH","destW","filters","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVertically","3","4","wasm_fn","wasm_src","./convolve_wasm_base64","./resize","./resize_wasm","5","resetAlpha","dst","ptr","len","createFilters","destH","scaleX","scaleY","Uint8Array","quality","alpha","filtersX","filtersY","./convolve","./resize_filter_gen","6","toFixedPoint","num","FIXED_FRAC_BITS","FILTER_INFO","srcSize","destSize","scale","offset","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","filterFunction","filter","scaleInverted","scaleClamped","min","srcWindow","win","maxFilterElementSize","floor","packedFilter","Int16Array","packedFilterPtr","slowCopy","subarray","set","max","ceil","Float32Array","./resize_filter_info","7","xpi","8","asUint8Array","buffer","byteLength","copyInt16asLE","target_offset","IS_LE","Uint32Array","__","tmp_offset","__align","filtersX_offset","filtersY_offset","alloc_bytes","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","9","Pool","idle","available","acquired","lastId","timeoutId","acquire","_this","resource","id","release","_this2","lastUsed","Date","now","setTimeout","gc","_this3","destroy","10","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","11","pixelFloor","nearest","abs","PIXEL_EPSILON","pixelCeil","innerTileWidth","innerTileHeight","innerX","innerY","toTileWidth","toTileHeight","tile","tiles","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","12","objClass","isCanvas","element","cname","isImage","limiter","concurrency","roll","active","queue","shift","cib_quality_name","cib_support","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","13","mathLib","onmessage","ev","postMessage","./mathlib","14","gaussCoef","sigma","exp","g1","g2","k","a0","a1","a2","a3","b1","b2","left_corner","right_corner","convolveMono16","out","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","blurMono16","Uint16Array","tmp_line","15","superCtor","super_","enumerable","writable","configurable","TempCtor","16","MultiMath","DEFAULT_OPTIONS","__cache","hasWebAssembly","__init_promise","__modules","modules","__wasm","__isLE","base64decode","init","all","map","WebAssembly","compile","__base64decode","m","__reallocate","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","number","base","reminder","./lib/base64decode","./lib/wa_detect","object-assign","17","str","input","replace","bits","tailbits","18","img","size","19","./unsharp_mask","./unsharp_mask_wasm","./unsharp_mask_wasm_base64","20","glur_mono16","hsl_l16","amount","h","s","l","m1","m2","hShifted","diff","iTimes4","lightness","blured","amountFp","thresholdFp","./hsl_l16","glur/mono16","21","img_bytes_cnt","hsl_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","hsl_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","img32","_hsl_l16","_blurMono16","unsharp","_unsharp","22","23","wa","bin","test","24","toObject","val","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","test1","String","getOwnPropertyNames","test2","fromCharCode","test3","letter","source","from","symbols","to","arguments","25","bundleFn","sources","stringify","JSON","resolveSources","workerSources","depPath","depKey","wkey","cacheKeys","default","random","wcache","skey","scache","URL","webkitURL","mozURL","msURL","bare","workerUrl","createObjectURL","worker","Worker","objectURL","/","workerFabric","webworkify","terminate","url","revokeObjectURL","DEFAULT_PICA_OPTS","limiter_key","__limit","singletones","utils","cib","ww","__workersPool","__mathlib","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Array","isArray","createStages","createRegions","NEED_SAFARI_FIX","navigator","userAgent","hardwareConcurrency","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","__initPromise","ImageData","Uint8ClampedArray","ImageBitmap","debug","wpool_key","initMath","mathlib","checkCibResize","naturalWidth","naturalHeight","canceled","cancelToken","toCtx","Boolean","imageBitmap","tmpCanvas","tmpCtx","iData","invokeResize","w","preload","wasm_nodule","tileAndResize","srcCtx","srcImageBitmap","processTile","srcImageData","globalCompositeOperation","toImageData","createImageData","cleanup","regions","jobs","stages","processStages","_stages$shift","_stages$shift2","isLastStage","resizeBuffer","asString","atob","asBuffer","charCodeAt","./lib/mathlib","./lib/pool","./lib/stepper","./lib/tiler","./lib/utils","./lib/worker","ImageManipulation","_tasks","_canvas","_loadedCanvas","_lastCanvas","_fileName","_addToTask","_imageResize","func","_cleanTasks","newFileName","_runTasks","getCanvas","getFileName","CanvasPrototype","HTMLCanvasElement","hasBlobConstructor","hasArrayBufferViewSupport","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","dataURIPattern","dataURLtoBlob","ArrayBuffer","dataURI","matches","mediaType","isBase64","dataString","byteString","arrayBuffer","intArray","bb","match","decodeURIComponent","append","getBlob","mozGetAsFile","callback","BrowserImageManipulation"],"mappings":"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K,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAClwCE,GAAY,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,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"}