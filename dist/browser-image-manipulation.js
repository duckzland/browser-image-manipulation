!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e["browser-image-manipulation"]=t()}(this,function(){"use strict";function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e){var t={};try{var n=Q.load(e);for(var i in n)if("thumbnail"!==i){t[i]={};for(var r in n[i])t[i][Q.TAGS[i][r].name]=n[i][r]}}catch(e){console.warn("Error on read exif data")}return t}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.fixOrientation,a=void 0!==i&&i,o=t.readExif,s=void 0!==o&&o;return function(){return new Promise(function(t,i){var o=document.createElement("img"),l=new FileReader,h={};l.onload=function(e){h=a||s?n(e.target.result):{},o.src=e.target.result},l.onerror=function(){i(new Error("Image read error"))},o.onload=function(){var n=null;a&&(n=h["0th"]?h["0th"].Orientation:null);var i=r(o,n);t({canvas:i,fileName:e.name,exif:h})},o.onerror=function(){i(new Error("Invalid image"))},l.readAsDataURL(e)})}}function r(e,t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d"),r=0,a=0;return i.save(),2===t?(r=-n.width,i.scale(-1,1)):3===t?(r=-n.width,a=-n.height,i.scale(-1,-1)):3===t?(r=-n.width,a=-n.height,i.scale(-1,-1)):4===t?(a=-n.height,i.scale(1,-1)):5===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),a=-n.width,i.scale(1,-1)):6===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2)):7===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),r=-n.height,i.scale(-1,1)):8===t&&(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),r=-n.height,a=-n.width,i.scale(-1,-1)),i.drawImage(e,r,a),i.restore(),n}function a(e,t){return function(){return Promise.resolve({canvas:e,fileName:t})}}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return function(r){return new Promise(function(a,o){var s=0,l=0,h=r.width,u=r.height;l=i||(u-t)/2,s=n||(h-e)/2;var c=document.createElement("canvas"),f=c.getContext("2d");c.width=e,c.height=t,f.drawImage(r,s,l,e,t,0,0,e,t),a(c)})}}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=Object.assign({pica:{}},i);return function(i){return new Promise(function(a,o){var s=null,l=document.createElement("canvas"),h=0,u=i.width,c=i.height,f=0,m=0;if(n===O)h=u<c?e/u:t/c,f=c*h,m=u*h;else if(n===U){var g=u/e,p=c/t;g>p?(f=Math.round(c/g),m=e):(m=Math.round(u/p),f=t)}else o(new Error("Unknown resize type"));l.width=m,l.height=f,(new F).resize(i,l,r.pica).then(function(e){if(n===O){var t=0,i=0;m<f?(i=(f-m)/2,f=m):(t=(m-f)/2,m=f);var r=document.createElement("canvas"),o=r.getContext("2d");r.width=m,r.height=f,o.drawImage(e,t,i,m,f,0,0,m,f),s=r}else s=e;a(s)})})}}function l(e){return e*(Math.PI/180)}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.padding,i=void 0===n?0:n,r=t.bgColor,a=void 0===r?"white":r;return function(t){return new Promise(function(n,r){var o=document.createElement("canvas"),s=0;e<0&&(e=360+e),s=e>=0&&e<=90?90-e:270-e;var h=l(e),u=l(s),c=l(e),f={cosAngle:Math.cos(c),cosCalcAngle:Math.cos(u),sinAngle:Math.sin(c),sinCalcAngle:Math.sin(u)};for(var m in f)f[m]<0&&(f[m]=-1*f[m]);o.width=t.width*f.cosAngle+t.height*f.cosCalcAngle+i,o.height=t.width*f.sinAngle+t.height*f.sinCalcAngle+i;var g=o.getContext("2d");a&&(g.beginPath(),g.rect(0,0,o.width,o.height),g.fillStyle=a,g.fill(),g.save()),g.save(),g.translate(o.width/2,o.height/2),g.rotate(h),g.drawImage(t,-t.width/2,-t.height/2),g.restore(),n(o)})}}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.bgColor,r=void 0===i?"white":i;return function(n){return new Promise(function(i,a){var o=document.createElement("canvas");o.width=e,o.height=t;var s=o.getContext("2d"),l=n.width,h=n.height;r&&(s.beginPath(),s.rect(0,0,e,t),s.fillStyle=r,s.fill(),s.save());var u=0,c=0;l<e&&(u=(e-l)/2),h<t&&(c=(t-h)/2),s.drawImage(n,0,0,l,h,u,c,l,h),i(o)})}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.padding,i=void 0===n?4:n,r=t.bgColor,a=void 0===r?"white":r;return function(t){return new Promise(function(n,r){var o=document.createElement("canvas");o.width=e,o.height=e;var s=o.getContext("2d");s.beginPath(),s.rect(0,0,e,e),s.fillStyle=a,s.fill(),s.save();var l=e-i,h=Math.round(l/2);s.beginPath(),s.arc(h+i/2,h+i/2,h-i/2,0,2*Math.PI,!0),s.closePath(),s.clip(),s.drawImage(t,0,0,l,l),s.restore(),n(o)})}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rQ,n=void 0===t?.34:t,i=e.gQ,r=void 0===i?.5:i,a=e.bQ,o=void 0===a?.16:a;return function(e){return new Promise(function(t,i){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var s=a.getContext("2d");s.drawImage(e,0,0);for(var l=s.getImageData(0,0,a.width,a.height),h=l.data,u=0;u<h.length;u+=4){var c=n*h[u]+r*h[u+1]+o*h[u+2];h[u]=c,h[u+1]=c,h[u+2]=c}s.putImageData(l,0,0),t(a)})}}function m(e){return function(t){return new Promise(function(n,i){var r=document.createElement("canvas"),a=r.getContext("2d");r.width=t.width,r.height=t.height;var o=t.width*e,s=t.height*e;g(a),a.drawImage(t,0,0,o,s),g(a),a.drawImage(r,0,0,o,s,0,0,t.width,t.height),n(r)})}}function g(e){e.webkitImageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t,n,i,r){if("string"==typeof e&&(e=document.getElementById(e)),!(e&&"object"===p(e)&&"getContext"in e))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var a=e.getContext("2d");try{return a.getImageData(t,n,i,r)}catch(e){throw new Error("unable to access image data: "+e)}}function y(e,t,n,i,r,a){if(!(isNaN(a)||a<1)){a|=0;var o=A(e,t,n,i,r);o=v(o,t,n,i,r,a),e.getContext("2d").putImageData(o,t,n)}}function v(e,t,n,i,r,a){var o,s,l,h,u,c,f,m,g,p,d,A,y,v,w,I,S,b,C,E,B,P,_,x,L,R=e.data,k=2*a+1,D=i-1,M=r-1,G=a+1,T=G*(G+1)/2,Q=new H,F=Q;for(l=1;l<k;l++)F=F.next=new H,l===G&&(L=F);F.next=Q;var O=null,U=null;f=c=0;var q=N[a],z=j[a];for(s=0;s<r;s++){for(I=S=b=C=m=g=p=d=0,A=G*(E=R[c]),y=G*(B=R[c+1]),v=G*(P=R[c+2]),w=G*(_=R[c+3]),m+=T*E,g+=T*B,p+=T*P,d+=T*_,F=Q,l=0;l<G;l++)F.r=E,F.g=B,F.b=P,F.a=_,F=F.next;for(l=1;l<G;l++)h=c+((D<l?D:l)<<2),m+=(F.r=E=R[h])*(x=G-l),g+=(F.g=B=R[h+1])*x,p+=(F.b=P=R[h+2])*x,d+=(F.a=_=R[h+3])*x,I+=E,S+=B,b+=P,C+=_,F=F.next;for(O=Q,U=L,o=0;o<i;o++)R[c+3]=_=d*q>>z,0!==_?(_=255/_,R[c]=(m*q>>z)*_,R[c+1]=(g*q>>z)*_,R[c+2]=(p*q>>z)*_):R[c]=R[c+1]=R[c+2]=0,m-=A,g-=y,p-=v,d-=w,A-=O.r,y-=O.g,v-=O.b,w-=O.a,h=f+((h=o+a+1)<D?h:D)<<2,I+=O.r=R[h],S+=O.g=R[h+1],b+=O.b=R[h+2],C+=O.a=R[h+3],m+=I,g+=S,p+=b,d+=C,O=O.next,A+=E=U.r,y+=B=U.g,v+=P=U.b,w+=_=U.a,I-=E,S-=B,b-=P,C-=_,U=U.next,c+=4;f+=i}for(o=0;o<i;o++){for(S=b=C=I=g=p=d=m=0,c=o<<2,A=G*(E=R[c]),y=G*(B=R[c+1]),v=G*(P=R[c+2]),w=G*(_=R[c+3]),m+=T*E,g+=T*B,p+=T*P,d+=T*_,F=Q,l=0;l<G;l++)F.r=E,F.g=B,F.b=P,F.a=_,F=F.next;for(u=i,l=1;l<=a;l++)c=u+o<<2,m+=(F.r=E=R[c])*(x=G-l),g+=(F.g=B=R[c+1])*x,p+=(F.b=P=R[c+2])*x,d+=(F.a=_=R[c+3])*x,I+=E,S+=B,b+=P,C+=_,F=F.next,l<M&&(u+=i);for(c=o,O=Q,U=L,s=0;s<r;s++)h=c<<2,R[h+3]=_=d*q>>z,_>0?(_=255/_,R[h]=(m*q>>z)*_,R[h+1]=(g*q>>z)*_,R[h+2]=(p*q>>z)*_):R[h]=R[h+1]=R[h+2]=0,m-=A,g-=y,p-=v,d-=w,A-=O.r,y-=O.g,v-=O.b,w-=O.a,h=o+((h=s+G)<M?h:M)*i<<2,m+=I+=O.r=R[h],g+=S+=O.g=R[h+1],p+=b+=O.b=R[h+2],d+=C+=O.a=R[h+3],O=O.next,A+=E=U.r,y+=B=U.g,v+=P=U.b,w+=_=U.a,I-=E,S-=B,b-=P,C-=_,U=U.next,c+=i}return e}function w(e){return function(t){return new Promise(function(n,i){var r=document.createElement("canvas");r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0),y(r,0,0,t.width,t.height,e),n(r)})}}function I(e,t){var n=e.split("."),i="jpg";return t.indexOf("png")>-1?i="png":t.indexOf("webp")>-1&&(i="webp"),n.pop(),n.push(i),n.join(".")}function S(e,t,n,i){return new Promise(function(r,a){e.toBlob(function(e){var i=new Blob([e],{type:n});i.name=I(t,n),r(i)},n,i)})}function b(e){return Promise.resolve(e)}function C(e,t,n){return new Promise(function(i,r){i(e.toDataURL(t,n))})}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length<1)throw new Error("We need points");for(var t=[],n=0;n<e.length;n++)if(Array.isArray(e[n]))t.push(e[n]);else{var i=t.length-1;-1===i?t.push([e[n]]):t[i]&&2===t[i].length?t.push([e[n]]):t[i].push(e[n])}return t}function B(e,t,n){return function(i){return new Promise(function(r,a){var o=E(e),s=i.getContext("2d");s.save();var l=Y(o[0],2),h=l[0],u=l[1];s.moveTo(h,u);for(var c=1;c<o.length;c++){var f=Y(o[c],2),m=f[0],g=f[1];s.lineTo(m,g)}s.strokeStyle=t,s.lineWidth=n,s.stroke(),s.restore(),r(i)})}}function P(e,t,n,i){return function(r){return new Promise(function(a,o){var s=E(e),l=r.getContext("2d");l.save(),l.beginPath();var h=Y(s[0],2),u=h[0],c=h[1];l.moveTo(u,c);for(var f=1;f<s.length;f++){var m=Y(s[f],2),g=m[0],p=m[1];l.lineTo(g,p)}l.closePath(),l.fillStyle=t,l.fill(),l.strokeStyle=n,l.lineWidth=i,l.stroke(),l.restore(),a(r)})}}function _(e,t,n,i){return function(r){return new Promise(function(a,o){var s=E(e);if(s.length<2)throw new Error("Need points sequence of [[left, bottom], [right, top]] or [left, bottom, right, top]");var l=Y(s[0],2),h=l[0],u=l[1],c=Y(s[1],2),f=c[0],m=c[1],g=r.getContext("2d");g.save(),t&&g.beginPath(),g.moveTo(h,u),g.lineTo(h,m),g.lineTo(f,m),g.lineTo(f,u),g.lineTo(h,u),t&&(g.closePath(),g.fillStyle=t,g.fill()),n&&(g.strokeStyle=n,g.lineWidth=i,g.stroke()),g.restore(),a(r)})}}function x(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.font,a=void 0===r?"helvetica":r,o=i.fontSize,s=void 0===o?null:o,l=i.fill,h=void 0===l?null:l,u=i.fillPadding,c=void 0===u?null:u,f=i.rotateAngle,m=void 0===f?null:f;return function(i){return new Promise(function(){var r=q(regeneratorRuntime.mark(function r(o,l){var u,f,g,p,d,A,y,v,w,I,S,b,C,E,B;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(u=0,f=0,g=document.createElement("canvas"),g.width=i.width,g.height=i.height,p=g.getContext("2d"),m&&(d=m*Math.PI/180,p.rotate(d)),s&&(u=s.indexOf("%")>-1?Math.floor(g.height*(parseFloat(s)/100)):parseFloat(s),a=(u+"px "+a).trim()),c&&(f=c.indexOf("%")>-1?Math.floor(g.height*(parseFloat(c)/100)):parseFloat(c)),!h){n.next=20;break}return p.save(),a&&(p.font=a),A=Y(e,2),y=A[0],v=A[1],w=parseInt(p.font),I=p.measureText(t),S=I.width,"actualBoundingBoxAscent"in I&&(w=I.actualBoundingBoxAscent-I.actualBoundingBoxDescent),p.restore(),n.next=20,_([y-f,v+f,y+S+f,v-w-f],h,null)(g);case 20:p.save(),a&&(p.font=a),b=Y(e,2),C=b[0],E=b[1],p.fillText(t,C,E),p.restore(),B=i.getContext("2d"),B.drawImage(g,0,0),o(i);case 28:case"end":return n.stop()}},r,n)}));return function(e,t){return r.apply(this,arguments)}}())}}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new Promise(function(n,i){var r=t.getContext("2d"),a=t.width,o=t.height,s=e.xy0,l=void 0===s?["0%","0%"]:s,h=e.xy1,u=void 0===h?["100%","0%"]:h,c=e.xy2,f=void 0===c?["100%","100%"]:c,m=e.xy3,g=void 0===m?["0%","100%"]:m,p=R([l,u,f,g],a,o),d=D(a,o);d.drawImage(t,0,0,a,o);var A=D(a,o),y=M(p,a,o);A.clearRect(0,0,A.canvas.width,A.canvas.height),y%2==0?G(p,{ctxTransformed:A,sideSize:o,otherSizeSize:a,ctxOut:d,coverStep:10,step:2}):y%2==1&&G(p,{ctxTransformed:A,sideSize:a,otherSizeSize:o,ctxOut:d,coverStep:10,step:2}),r.save(),r.drawImage(A.canvas,0,0),T(r,p),r.restore(),n(r.canvas)})}}function R(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],i=[],r=0;r<e.length;r++)i[r]=[k(e[r][0],t),k(e[r][1],n)];return i}function k(e,t){return e.toString().indexOf("%")>-1?Math.floor(t*(parseFloat(e)/100)):e}function D(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.getContext("2d")}function M(e,t,n){for(var i=Y(e,4),r=Y(i[0],2),a=r[0],o=r[1],s=Y(i[1],2),l=s[0],h=s[1],u=Y(i[2],2),c=u[0],f=u[1],m=Y(i[3],2),g=m[0],p=m[1],d=[Math.sqrt(Math.pow(a-l,2)+Math.pow(o-h,2)),Math.sqrt(Math.pow(l-c,2)+Math.pow(h-f,2)),Math.sqrt(Math.pow(c-g,2)+Math.pow(f-p,2)),Math.sqrt(Math.pow(g-a,2)+Math.pow(p-o,2))],A=0,y=0,v=0,w=0;w<4;w++){var I=0;I=w%2?d[w]/t:d[w]/n,I>y&&(A=w,y=I),0===d[w]&&v++}return v>1?0:A}function G(e,t){var n=t.ctxTransformed,i=t.sideSize,r=t.otherSizeSize,a=t.ctxOut,o=t.coverStep,s=t.step,l=Y(e,4),h=Y(l[0],2),u=h[0],c=h[1],f=Y(l[1],2),m=f[0],g=f[1],p=Y(l[2],2),d=p[0],A=p[1],y=Y(l[3],2),v=y[0],w=y[1],I=D(r,o);I.globalCompositeOperation="copy";for(var S=0;S<i;S+=s){var b=S/i,C=u+(v-u)*b,E=c+(w-c)*b,B=m+(d-m)*b,P=g+(A-g)*b,_=Math.atan((P-E)/(B-C)),x=Math.sqrt(Math.pow(B-C,2)+Math.pow(P-E,2))/r;I.setTransform(1,0,0,1,0,-S),I.drawImage(a.canvas,0,0),n.translate(C,E),n.rotate(_),n.scale(x,x),n.drawImage(I.canvas,0,0),n.setTransform(1,0,0,1,0,0)}}function T(e,t){e.beginPath(),e.moveTo(t[0][0],t[0][1]);for(var n=1;n<t.length;n++)e.lineTo(t[n][0],t[n][1]);e.closePath(),e.globalCompositeOperation="destination-in",e.fill(),e.globalCompositeOperation="source-over"}var Q=(t(function(e){!function(t){function n(e,t,n,i){var a=t&&t.prototype instanceof r?t:r,o=Object.create(a.prototype),s=new m(i||[]);return o._invoke=h(e,n,s),o}function i(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function r(){}function a(){}function o(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function l(e){function t(n,r,a,o){var s=i(e[n],e,r);if("throw"!==s.type){var l=s.arg,h=l.value;return h&&"object"==typeof h&&y.call(h,"__await")?Promise.resolve(h.__await).then(function(e){t("next",e,a,o)},function(e){t("throw",e,a,o)}):Promise.resolve(h).then(function(e){l.value=e,a(l)},o)}o(s.arg)}function n(e,n){function i(){return new Promise(function(i,r){t(e,n,i,r)})}return r=r?r.then(i,i):i()}var r;this._invoke=n}function h(e,t,n){var r=C;return function(a,o){if(r===B)throw new Error("Generator is already running");if(r===P){if("throw"===a)throw o;return p()}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var l=u(s,n);if(l){if(l===_)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===C)throw r=P,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=B;var h=i(e,t,n);if("normal"===h.type){if(r=n.done?P:E,h.arg===_)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(r=P,n.method="throw",n.arg=h.arg)}}}function u(e,t){var n=e.iterator[t.method];if(n===d){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=d,u(e,t),"throw"===t.method))return _;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var r=i(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,_;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=d),t.delegate=null,_):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function c(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function m(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(c,this),this.reset(!0)}function g(e){if(e){var t=e[w];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(y.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=d,t.done=!0,t};return i.next=i}}return{next:p}}function p(){return{value:d,done:!0}}var d,A=Object.prototype,y=A.hasOwnProperty,v="function"==typeof Symbol?Symbol:{},w=v.iterator||"@@iterator",I=v.asyncIterator||"@@asyncIterator",S=v.toStringTag||"@@toStringTag",b=t.regeneratorRuntime;if(b)return void(e.exports=b);b=t.regeneratorRuntime=e.exports,b.wrap=n;var C="suspendedStart",E="suspendedYield",B="executing",P="completed",_={},x={};x[w]=function(){return this};var L=Object.getPrototypeOf,R=L&&L(L(g([])));R&&R!==A&&y.call(R,w)&&(x=R);var k=o.prototype=r.prototype=Object.create(x);a.prototype=k.constructor=o,o.constructor=a,o[S]=a.displayName="GeneratorFunction",b.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},b.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,S in e||(e[S]="GeneratorFunction")),e.prototype=Object.create(k),e},b.awrap=function(e){return{__await:e}},s(l.prototype),l.prototype[I]=function(){return this},b.AsyncIterator=l,b.async=function(e,t,i,r){var a=new l(n(e,t,i,r));return b.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},s(k),k[S]="Generator",k[w]=function(){return this},k.toString=function(){return"[object Generator]"},b.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},b.values=g,m.prototype={constructor:m,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(f),!e)for(var t in this)"t"===t.charAt(0)&&y.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=d)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,i){return a.type="throw",a.arg=e,n.next=t,i&&(n.method="next",n.arg=d),!!i}if(this.done)throw e;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=y.call(r,"catchLoc"),s=y.call(r,"finallyLoc");if(o&&s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&y.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),f(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;f(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:g(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=d),_}}}(function(){return this}()||Function("return this")())}),t(function(e,t){!function(){function n(e){return JSON.parse(JSON.stringify(e))}function i(e){for(var t=m(e);"ÿà"<=t[1].slice(0,2)&&t[1].slice(0,2)<="ÿï";)t=[t[0]].concat(t.slice(2));return t.join("")}function r(e){return u(">"+f("B",e.length),e)}function a(e){return u(">"+f("H",e.length),e)}function o(e){return u(">"+f("L",e.length),e)}function s(e,t,n){var i,s,l,h,c="",m="";if("Byte"==t)i=e.length,i<=4?m=r(e)+f("\0",4-i):(m=u(">L",[n]),c=r(e));else if("Short"==t)i=e.length,i<=2?m=a(e)+f("\0\0",2-i):(m=u(">L",[n]),c=a(e));else if("Long"==t)i=e.length,i<=1?m=o(e):(m=u(">L",[n]),c=o(e));else if("Ascii"==t)s=e+"\0",i=s.length,i>4?(m=u(">L",[n]),c=s):m=s+f("\0",4-i);else if("Rational"==t){if("number"==typeof e[0])i=1,l=e[0],h=e[1],s=u(">L",[l])+u(">L",[h]);else{i=e.length,s="";for(var g=0;g<i;g++)l=e[g][0],h=e[g][1],s+=u(">L",[l])+u(">L",[h])}m=u(">L",[n]),c=s}else if("SRational"==t){if("number"==typeof e[0])i=1,l=e[0],h=e[1],s=u(">l",[l])+u(">l",[h]);else{i=e.length,s="";for(var g=0;g<i;g++)l=e[g][0],h=e[g][1],s+=u(">l",[l])+u(">l",[h])}m=u(">L",[n]),c=s}else"Undefined"==t&&(i=e.length,i>4?(m=u(">L",[n]),c=e):m=e+f("\0",4-i));return[u(">L",[i]),m,c]}function l(e,t,n){var i,r=Object.keys(e).length,a=u(">H",[r]);i=["0th","1st"].indexOf(t)>-1?2+12*r+4:2+12*r;var o,l="",h="";for(var o in e)if("string"==typeof o&&(o=parseInt(o)),!("0th"==t&&[34665,34853].indexOf(o)>-1||"Exif"==t&&40965==o||"1st"==t&&[513,514].indexOf(o)>-1)){var c=e[o],f=u(">H",[o]),m=w[t][o].type,g=u(">H",[v[m]]);"number"==typeof c&&(c=[c]);var p=8+i+n+h.length,d=s(c,m,p),A=d[0],y=d[1],I=d[2];l+=f+g+A+y,h+=I}return[a+l,h]}function h(e){var t,n;if("ÿØ"==e.slice(0,2))t=m(e),n=g(t),this.tiftag=n?n.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}function u(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("");n=!1}for(var i="",r=1,a=null,o=null,s=null;o=e[r];){if("b"==o.toLowerCase()){if(a=t[r-1],"b"==o&&a<0&&(a+=256),a>255||a<0)throw new Error("'pack' error.");s=String.fromCharCode(a)}else if("H"==o){if((a=t[r-1])>65535||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(a=t[r-1],"l"==o&&a<0&&(a+=4294967296),a>4294967295||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a/16777216))+String.fromCharCode(Math.floor(a%16777216/65536))+String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}i+=s,r+=1}return i}function c(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var n=0,i=1;i<e.length;i++)if("b"==e[i].toLowerCase())n+=1;else if("h"==e[i].toLowerCase())n+=2;else{if("l"!=e[i].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");n+=4}if(n!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+n+":"+t.length);var r;if("<"==e[0])r=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");r=!1}for(var a=[],o=0,s=1,l=null,h=null,u=null,c="";h=e[s];){if("b"==h.toLowerCase())u=1,c=t.slice(o,o+u),l=c.charCodeAt(0),"b"==h&&l>=128&&(l-=256);else if("H"==h)u=2,c=t.slice(o,o+u),r&&(c=c.split("").reverse().join("")),l=256*c.charCodeAt(0)+c.charCodeAt(1);else{if("l"!=h.toLowerCase())throw new Error("'unpack' error. "+h);u=4,c=t.slice(o,o+u),r&&(c=c.split("").reverse().join("")),l=16777216*c.charCodeAt(0)+65536*c.charCodeAt(1)+256*c.charCodeAt(2)+c.charCodeAt(3),"l"==h&&l>=2147483648&&(l-=4294967296)}a.push(l),o+=u,s+=1}return a}function f(e,t){for(var n="",i=0;i<t;i++)n+=e;return n}function m(e){if("ÿØ"!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,n=["ÿØ"];;){if("ÿÚ"==e.slice(t,t+2)){n.push(e.slice(t));break}var i=c(">H",e.slice(t+2,t+4))[0],r=t+i+2;if(n.push(e.slice(t,r)),(t=r)>=e.length)throw new Error("Wrong JPEG data.")}return n}function g(e){for(var t,n=0;n<e.length;n++)if(t=e[n],"ÿá"==t.slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}function p(e,t){var n=!1,i=[];return e.forEach(function(r,a){"ÿá"==r.slice(0,2)&&"Exif\0\0"==r.slice(4,10)&&(n?i.unshift(a):(e[a]=t,n=!0))}),i.forEach(function(t){e.splice(t,1)}),!n&&t&&(e=[e[0],t].concat(e.slice(1))),e.join("")}var d={};if(d.version="1.0.4",d.remove=function(e){var t=!1;if("ÿØ"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=y(e.split(",")[1]),t=!0}var n=m(e),i=n.filter(function(e){return!("ÿá"==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))}),r=i.join("");return t&&(r="data:image/jpeg;base64,"+A(r)),r},d.insert=function(e,t){var n=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if("ÿØ"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=y(t.split(",")[1]),n=!0}var i="ÿá"+u(">H",[e.length+2])+e,r=m(t),a=p(r,i);return n&&(a="data:image/jpeg;base64,"+A(a)),a},d.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if("ÿØ"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=y(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var n={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},i=new h(t);if(null===i.tiftag)return n;"II"==i.tiftag.slice(0,2)?i.endian_mark="<":i.endian_mark=">";var r=c(i.endian_mark+"L",i.tiftag.slice(4,8))[0];n["0th"]=i.get_ifd(r,"0th");var a=n["0th"].first_ifd_pointer;if(delete n["0th"].first_ifd_pointer,34665 in n["0th"]&&(r=n["0th"][34665],n.Exif=i.get_ifd(r,"Exif")),34853 in n["0th"]&&(r=n["0th"][34853],n.GPS=i.get_ifd(r,"GPS")),40965 in n.Exif&&(r=n.Exif[40965],n.Interop=i.get_ifd(r,"Interop")),"\0\0\0\0"!=a&&(r=c(i.endian_mark+"L",a)[0],n["1st"]=i.get_ifd(r,"1st"),513 in n["1st"]&&514 in n["1st"])){var o=n["1st"][513]+n["1st"][514],s=i.tiftag.slice(n["1st"][513],o);n.thumbnail=s}return n},d.dump=function(e){var t,r,a,o,s,h=n(e),c=!1,f=!1,m=!1,g=!1;t="0th"in h?h["0th"]:{},"Exif"in h&&Object.keys(h.Exif).length||"Interop"in h&&Object.keys(h.Interop).length?(t[34665]=1,c=!0,r=h.Exif,"Interop"in h&&Object.keys(h.Interop).length?(r[40965]=1,m=!0,a=h.Interop):Object.keys(r).indexOf(d.ExifIFD.InteroperabilityTag.toString())>-1&&delete r[40965]):Object.keys(t).indexOf(d.ImageIFD.ExifTag.toString())>-1&&delete t[34665],"GPS"in h&&Object.keys(h.GPS).length?(t[d.ImageIFD.GPSTag]=1,f=!0,o=h.GPS):Object.keys(t).indexOf(d.ImageIFD.GPSTag.toString())>-1&&delete t[d.ImageIFD.GPSTag],"1st"in h&&"thumbnail"in h&&null!=h.thumbnail&&(g=!0,h["1st"][513]=1,h["1st"][514]=1,s=h["1st"]);var p,A,y,w,I,S=l(t,"0th",0),b=S[0].length+12*c+12*f+4+S[1].length,C="",E=0,B="",P=0,_="",x=0,L="";if(c&&(p=l(r,"Exif",b),E=p[0].length+12*m+p[1].length),f&&(A=l(o,"GPS",b+E),B=A.join(""),P=B.length),m){var R=b+E+P;y=l(a,"Interop",R),_=y.join(""),x=_.length}if(g){var R=b+E+P+x;if(w=l(s,"1st",R),I=i(h.thumbnail),I.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var k="",D="",M="",G="\0\0\0\0";if(c){var T=8+b,Q=u(">L",[T]),F=34665,O=u(">H",[F]),U=u(">H",[v.Long]),N=u(">L",[1]);k=O+U+N+Q}if(f){var T=8+b+E,Q=u(">L",[T]),F=34853,O=u(">H",[F]),U=u(">H",[v.Long]),N=u(">L",[1]);D=O+U+N+Q}if(m){var T=8+b+E+P,Q=u(">L",[T]),F=40965,O=u(">H",[F]),U=u(">H",[v.Long]),N=u(">L",[1]);M=O+U+N+Q}if(g){var T=8+b+E+P+x;G=u(">L",[T]);var j=T+w[0].length+24+4+w[1].length,H="\0\0\0\0"+u(">L",[j]),q="\0\0\0\0"+u(">L",[I.length]);L=w[0]+H+q+"\0\0\0\0"+w[1]+I}var z=S[0]+k+D+G+S[1];return c&&(C=p[0]+M+p[1]),"Exif\0\0MM\0*\0\0\0\b"+z+C+B+_+L},h.prototype={get_ifd:function(e,t){var n,i={},r=c(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],a=e+2;n=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<r;o++){e=a+12*o;var s=c(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],l=c(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],h=c(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],u=this.tiftag.slice(e+8,e+12),f=[l,h,u];s in w[n]&&(i[s]=this.convert_value(f))}return"0th"==t&&(e=a+12*r,i.first_ifd_pointer=this.tiftag.slice(e,e+4)),i},convert_value:function(e){var t,n=null,i=e[0],r=e[1],a=e[2];if(1==i)r>4?(t=c(this.endian_mark+"L",a)[0],n=c(this.endian_mark+f("B",r),this.tiftag.slice(t,t+r))):n=c(this.endian_mark+f("B",r),a.slice(0,r));else if(2==i)r>4?(t=c(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r-1)):n=a.slice(0,r-1);else if(3==i)r>2?(t=c(this.endian_mark+"L",a)[0],n=c(this.endian_mark+f("H",r),this.tiftag.slice(t,t+2*r))):n=c(this.endian_mark+f("H",r),a.slice(0,2*r));else if(4==i)r>1?(t=c(this.endian_mark+"L",a)[0],n=c(this.endian_mark+f("L",r),this.tiftag.slice(t,t+4*r))):n=c(this.endian_mark+f("L",r),a);else if(5==i)if(t=c(this.endian_mark+"L",a)[0],r>1){n=[];for(var o=0;o<r;o++)n.push([c(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],c(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[c(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],c(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==i)r>4?(t=c(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r)):n=a.slice(0,r);else if(9==i)r>1?(t=c(this.endian_mark+"L",a)[0],n=c(this.endian_mark+f("l",r),this.tiftag.slice(t,t+4*r))):n=c(this.endian_mark+f("l",r),a);else{if(10!=i)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+i);if(t=c(this.endian_mark+"L",a)[0],r>1){n=[];for(var o=0;o<r;o++)n.push([c(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],c(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[c(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],c(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return n instanceof Array&&1==n.length?n[0]:n}},"undefined"!=typeof window&&"function"==typeof window.btoa)var A=window.btoa;if(void 0===A)var A=function(e){for(var t,n,i,r,a,o,s,l="",h=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h<e.length;)t=e.charCodeAt(h++),n=e.charCodeAt(h++),i=e.charCodeAt(h++),r=t>>2,a=(3&t)<<4|n>>4,o=(15&n)<<2|i>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),l=l+u.charAt(r)+u.charAt(a)+u.charAt(o)+u.charAt(s);return l};if("undefined"!=typeof window&&"function"==typeof window.atob)var y=window.atob;if(void 0===y)var y=function(e){var t,n,i,r,a,o,s,l="",h=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)r=u.indexOf(e.charAt(h++)),a=u.indexOf(e.charAt(h++)),o=u.indexOf(e.charAt(h++)),s=u.indexOf(e.charAt(h++)),t=r<<2|a>>4,n=(15&a)<<4|o>>2,i=(3&o)<<6|s,l+=String.fromCharCode(t),64!=o&&(l+=String.fromCharCode(n)),64!=s&&(l+=String.fromCharCode(i));return l};var v={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},w={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{
name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};w["0th"]=w.Image,w["1st"]=w.Image,d.TAGS=w,d.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},d.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},d.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},d.InteropIFD={InteroperabilityIndex:1},d.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),n=t%1*60,i=n%1*60;return[[Math.floor(t),1],[Math.floor(n),1],[Math.round(100*i),100]]},dmsRationalToDeg:function(e,t){var n="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*n}},e.exports&&(t=e.exports=d),t.piexif=d}()})),F=t(function(t,n){!function(n){t.exports=function(){return function(){function t(n,i,r){function a(s,l){if(!i[s]){if(!n[s]){var h="function"==typeof e&&e;if(!l&&h)return h(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[s]={exports:{}};n[s][0].call(c.exports,function(e){return a(n[s][1][e]||e)},c,c.exports,t,n,i,r)}return i[s].exports}for(var o="function"==typeof e&&e,s=0;s<r.length;s++)a(r[s]);return a}return t}()({1:[function(e,t,n){function i(e){var t=e||[],n={js:t.indexOf("js")>=0,wasm:t.indexOf("wasm")>=0};a.call(this,n),this.features={js:n.js,wasm:n.wasm&&this.has_wasm},this.use(o),this.use(s)}var r=e("inherits"),a=e("multimath"),o=e("multimath/lib/unsharp_mask"),s=e("./mm_resize");r(i,a),i.prototype.resizeAndUnsharp=function(e,t){var n=this.resize(e,t);return e.unsharpAmount&&this.unsharp_mask(n,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),n},t.exports=i},{"./mm_resize":4,inherits:15,multimath:16,"multimath/lib/unsharp_mask":19}],2:[function(e,t,n){function i(e){return e<0?0:e>255?255:e}function r(e,t,n,r,a,o){var s,l,h,u,c,f,m,g,p,d,A,y=0,v=0;for(p=0;p<r;p++){for(c=0,d=0;d<a;d++){for(f=o[c++],m=o[c++],g=y+4*f|0,s=l=h=u=0;m>0;m--)A=o[c++],u=u+A*e[g+3]|0,h=h+A*e[g+2]|0,l=l+A*e[g+1]|0,s=s+A*e[g]|0,g=g+4|0;t[v+3]=i(u+8192>>14),t[v+2]=i(h+8192>>14),t[v+1]=i(l+8192>>14),t[v]=i(s+8192>>14),v=v+4*r|0}v=4*(p+1)|0,y=(p+1)*n*4|0}}function a(e,t,n,r,a,o){var s,l,h,u,c,f,m,g,p,d,A,y=0,v=0;for(p=0;p<r;p++){for(c=0,d=0;d<a;d++){for(f=o[c++],m=o[c++],g=y+4*f|0,s=l=h=u=0;m>0;m--)A=o[c++],u=u+A*e[g+3]|0,h=h+A*e[g+2]|0,l=l+A*e[g+1]|0,s=s+A*e[g]|0,g=g+4|0;t[v+3]=i(u+8192>>14),t[v+2]=i(h+8192>>14),t[v+1]=i(l+8192>>14),t[v]=i(s+8192>>14),v=v+4*r|0}v=4*(p+1)|0,y=(p+1)*n*4|0}}t.exports={convolveHorizontally:r,convolveVertically:a}},{}],3:[function(e,t,n){t.exports="AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw=="},{}],4:[function(e,t,n){t.exports={name:"resize",fn:e("./resize"),wasm_fn:e("./resize_wasm"),wasm_src:e("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(e,t,n){function i(e,t,n){for(var i=3,r=t*n*4|0;i<r;)e[i]=255,i=i+4|0}var r=e("./resize_filter_gen"),a=e("./convolve").convolveHorizontally,o=e("./convolve").convolveVertically;t.exports=function(e){var t=e.src,n=e.width,s=e.height,l=e.toWidth,h=e.toHeight,u=e.scaleX||e.toWidth/e.width,c=e.scaleY||e.toHeight/e.height,f=e.offsetX||0,m=e.offsetY||0,g=e.dest||new Uint8Array(l*h*4),p=void 0===e.quality?3:e.quality,d=e.alpha||!1,A=r(p,n,l,u,f),y=r(p,s,h,c,m),v=new Uint8Array(l*s*4);return a(t,v,n,s,l,A),o(v,g,s,l,h,y),d||i(g,l,h),g}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(e,t,n){function i(e){return Math.round(e*((1<<a)-1))}var r=e("./resize_filter_info"),a=14;t.exports=function(e,t,n,a,o){var s,l,h,u,c,f,m,g,p,d,A,y,v,w,I,S,b,C=r[e].filter,E=1/a,B=Math.min(1,a),P=r[e].win/B,_=Math.floor(2*(P+1)),x=new Int16Array((_+2)*n),L=0,R=!x.subarray||!x.set;for(s=0;s<n;s++){for(l=(s+.5)*E+o,h=Math.max(0,Math.floor(l-P)),u=Math.min(t-1,Math.ceil(l+P)),c=u-h+1,f=new Float32Array(c),m=new Int16Array(c),g=0,p=h,d=0;p<=u;p++,d++)A=C((p+.5-l)*B),g+=A,f[d]=A;for(y=0,d=0;d<f.length;d++)v=f[d]/g,y+=v,m[d]=i(v);for(m[n>>1]+=i(1-y),w=0;w<m.length&&0===m[w];)w++;if(w<m.length){for(I=m.length-1;I>0&&0===m[I];)I--;if(S=h+w,b=I-w+1,x[L++]=S,x[L++]=b,R)for(d=w;d<=I;d++)x[L++]=m[d];else x.set(m.subarray(w,I+1),L),L+=b}else x[L++]=0,x[L++]=0}return x}},{"./resize_filter_info":7}],7:[function(e,t,n){t.exports=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}]},{}],8:[function(e,t,n){function i(e,t,n){for(var i=3,r=t*n*4|0;i<r;)e[i]=255,i=i+4|0}function r(e){return new Uint8Array(e.buffer,0,e.byteLength)}function a(e,t,n){if(s)return void t.set(r(e),n);for(var i=n,a=0;a<e.length;a++){var o=e[a];t[i++]=255&o,t[i++]=o>>8&255}}var o=e("./resize_filter_gen"),s=!0;try{s=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(e){}t.exports=function(e){var t=e.src,n=e.width,r=e.height,s=e.toWidth,l=e.toHeight,h=e.scaleX||e.toWidth/e.width,u=e.scaleY||e.toHeight/e.height,c=e.offsetX||0,f=e.offsetY||0,m=e.dest||new Uint8Array(s*l*4),g=void 0===e.quality?3:e.quality,p=e.alpha||!1,d=o(g,n,s,h,c),A=o(g,r,l,u,f),y=this.__align(0+Math.max(t.byteLength,m.byteLength)),v=this.__align(y+r*s*4),w=this.__align(v+d.byteLength),I=w+A.byteLength,S=this.__instance("resize",I),b=new Uint8Array(this.__memory.buffer),C=new Uint32Array(this.__memory.buffer),E=new Uint32Array(t.buffer);return C.set(E),a(d,b,v),a(A,b,w),(S.exports.convolveHV||S.exports._convolveHV)(v,w,y,n,r,s,l),new Uint32Array(m.buffer).set(new Uint32Array(this.__memory.buffer,0,l*s)),p||i(m,s,l),m}},{"./resize_filter_gen":6}],9:[function(e,t,n){function i(e,t){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=t||2e3}i.prototype.acquire=function(){var e=this,t=void 0;return 0!==this.available.length?t=this.available.pop():(t=this.create(),t.id=this.lastId++,t.release=function(){return e.release(t)}),this.acquired[t.id]=t,t},i.prototype.release=function(e){var t=this;delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return t.gc()},100))},i.prototype.gc=function(){var e=this,t=Date.now();this.available=this.available.filter(function(n){return!(t-n.lastUsed>e.idle)||(n.destroy(),!1)}),0!==this.available.length?this.timeoutId=setTimeout(function(){return e.gc()},100):this.timeoutId=0},t.exports=i},{}],10:[function(e,t,n){t.exports=function(e,t,n,i,r,a){var o=n/e,s=i/t,l=(2*a+2+1)/r;if(l>.5)return[[n,i]];var h=Math.ceil(Math.log(Math.min(o,s))/Math.log(l));if(h<=1)return[[n,i]];for(var u=[],c=0;c<h;c++){var f=Math.round(Math.pow(Math.pow(e,h-c-1)*Math.pow(n,c+1),1/h)),m=Math.round(Math.pow(Math.pow(t,h-c-1)*Math.pow(i,c+1),1/h));u.push([f,m])}return u}},{}],11:[function(e,t,n){function i(e){var t=Math.round(e);return Math.abs(e-t)<a?t:Math.floor(e)}function r(e){var t=Math.round(e);return Math.abs(e-t)<a?t:Math.ceil(e)}var a=1e-5;t.exports=function(e){var t=e.toWidth/e.width,n=e.toHeight/e.height,a=i(e.srcTileSize*t)-2*e.destTileBorder,o=i(e.srcTileSize*n)-2*e.destTileBorder;if(a<1||o<1)throw new Error("Internal error in pica: target tile width/height is too small.");var s,l,h,u,c,f,m,g=[];for(u=0;u<e.toHeight;u+=o)for(h=0;h<e.toWidth;h+=a)s=h-e.destTileBorder,s<0&&(s=0),c=h+a+e.destTileBorder-s,s+c>=e.toWidth&&(c=e.toWidth-s),l=u-e.destTileBorder,l<0&&(l=0),f=u+o+e.destTileBorder-l,l+f>=e.toHeight&&(f=e.toHeight-l),m={toX:s,toY:l,toWidth:c,toHeight:f,toInnerX:h,toInnerY:u,toInnerWidth:a,toInnerHeight:o,offsetX:s/t-i(s/t),offsetY:l/n-i(l/n),scaleX:t,scaleY:n,x:i(s/t),y:i(l/n),width:r(c/t),height:r(f/n)},g.push(m);return g}},{}],12:[function(e,t,n){function i(e){return Object.prototype.toString.call(e)}t.exports.isCanvas=function(e){var t=i(e);return"[object HTMLCanvasElement]"===t||"[object Canvas]"===t},t.exports.isImage=function(e){return"[object HTMLImageElement]"===i(e)},t.exports.limiter=function(e){function t(){n<e&&i.length&&(n++,i.shift()())}var n=0,i=[];return function(e){return new Promise(function(r,a){i.push(function(){e().then(function(e){r(e),n--,t()},function(e){a(e),n--,t()})}),t()})}},t.exports.cib_quality_name=function(e){switch(e){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},t.exports.cib_support=function(){return Promise.resolve().then(function(){if("undefined"==typeof createImageBitmap||"undefined"==typeof document)return!1;var e=document.createElement("canvas");return e.width=100,e.height=100,createImageBitmap(e,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(t){var n=10===t.width;return t.close(),e=null,n})}).catch(function(){return!1})}},{}],13:[function(e,t,n){t.exports=function(){var t=e("./mathlib"),n=void 0;onmessage=function(e){var i=e.data.opts;n||(n=new t(e.data.features));var r=n.resizeAndUnsharp(i);postMessage({result:r},[r.buffer])}}},{"./mathlib":1}],14:[function(e,t,n){function i(e){e<.5&&(e=.5);var t=Math.exp(.527076)/e,n=Math.exp(-t),i=Math.exp(-2*t),r=(1-n)*(1-n)/(1+2*t*n-i);return o=r,s=r*(t-1)*n,l=r*(t+1)*n,h=-r*i,u=2*n,c=-i,f=(o+s)/(1-u-c),m=(l+h)/(1-u-c),new Float32Array([o,s,l,h,u,c,f,m])}function r(e,t,n,i,r,a){var o,s,l,h,u,c,f,m,g,p,d,A,y,v;for(g=0;g<a;g++){for(c=g*r,f=g,m=0,o=e[c],u=o*i[6],h=u,d=i[0],A=i[1],y=i[4],v=i[5],p=0;p<r;p++)s=e[c],l=s*d+o*A+h*y+u*v,u=h,h=l,o=s,n[m]=h,m++,c++;for(c--,m--,f+=a*(r-1),o=e[c],u=o*i[7],h=u,s=o,d=i[2],A=i[3],p=r-1;p>=0;p--)l=s*d+o*A+h*y+u*v,u=h,h=l,o=s,s=e[c],t[f]=n[m]+h,c--,m--,f-=a}}function a(e,t,n,a){if(a){var o=new Uint16Array(e.length),s=new Float32Array(Math.max(t,n)),l=i(a);r(e,o,s,l,t,n,a),r(o,e,s,l,n,t,a)}}var o,s,l,h,u,c,f,m;t.exports=a},{}],15:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],16:[function(e,t,n){function i(e){if(!(this instanceof i))return new i(e);var t=r({},s,e||{});if(this.options=t,this.__cache={},this.has_wasm=o(),this.__init_promise=null,this.__modules=t.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}var r=e("object-assign"),a=e("./lib/base64decode"),o=e("./lib/wa_detect"),s={js:!0,wasm:!0};i.prototype.use=function(e){return this.__modules[e.name]=e,this.has_wasm&&this.options.wasm&&e.wasm_fn?this[e.name]=e.wasm_fn:this[e.name]=e.fn,this},i.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm)return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var e=this;return this.__init_promise=Promise.all(Object.keys(e.__modules).map(function(t){var n=e.__modules[t];return e.has_wasm&&e.options.wasm&&n.wasm_fn?e.__wasm[t]?null:WebAssembly.compile(e.__base64decode(n.wasm_src)).then(function(n){e.__wasm[t]=n}):null})).then(function(){return e}),this.__init_promise},i.prototype.__base64decode=a,i.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/65536)}),this.__memory;var t=this.__memory.buffer.byteLength;return t<e&&this.__memory.grow(Math.ceil((e-t)/65536)),this.__memory},i.prototype.__instance=function(e,t,n){if(t&&this.__reallocate(t),!this.__wasm[e]){var i=this.__modules[e];this.__wasm[e]=new WebAssembly.Module(this.__base64decode(i.wasm_src))}if(!this.__cache[e]){var a={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:r(a,n||{})})}return this.__cache[e]},i.prototype.__align=function(e,t){t=t||8;var n=e%t;return e+(n?t-n:0)},t.exports=i},{"./lib/base64decode":17,"./lib/wa_detect":23,"object-assign":24}],17:[function(e,t,n){t.exports=function(e){for(var t=e.replace(/[\r\n=]/g,""),n=t.length,i=new Uint8Array(3*n>>2),r=0,a=0,o=0;o<n;o++)o%4==0&&o&&(i[a++]=r>>16&255,i[a++]=r>>8&255,i[a++]=255&r),r=r<<6|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(o));var s=n%4*6;return 0===s?(i[a++]=r>>16&255,i[a++]=r>>8&255,i[a++]=255&r):18===s?(i[a++]=r>>10&255,i[a++]=r>>2&255):12===s&&(i[a++]=r>>4&255),i}},{}],18:[function(e,t,n){t.exports=function(e,t,n){for(var i,r,a,o,s,l=t*n,h=new Uint16Array(l),u=0;u<l;u++)i=e[4*u],r=e[4*u+1],a=e[4*u+2],s=i>=r&&i>=a?i:r>=a&&r>=i?r:a,o=i<=r&&i<=a?i:r<=a&&r<=i?r:a,h[u]=257*(s+o)>>1;return h}},{}],19:[function(e,t,n){t.exports={name:"unsharp_mask",fn:e("./unsharp_mask"),wasm_fn:e("./unsharp_mask_wasm"),wasm_src:e("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":20,"./unsharp_mask_wasm":21,"./unsharp_mask_wasm_base64":22}],20:[function(e,t,n){var i=e("glur/mono16"),r=e("./hsl_l16");t.exports=function(e,t,n,a,o,s){var l,h,u,c,f,m,g,p,d,A,y,v,w;if(!(0===a||o<.5)){o>2&&(o=2);var I=r(e,t,n),S=new Uint16Array(I);i(S,t,n,o);for(var b=a/100*4096+.5|0,C=257*s|0,E=t*n,B=0;B<E;B++)v=2*(I[B]-S[B]),Math.abs(v)>=C&&(w=4*B,l=e[w],h=e[w+1],u=e[w+2],p=l>=h&&l>=u?l:h>=l&&h>=u?h:u,g=l<=h&&l<=u?l:h<=l&&h<=u?h:u,m=257*(p+g)>>1,g===p?c=f=0:(f=m<=32767?4095*(p-g)/(p+g)|0:4095*(p-g)/(510-p-g)|0,c=l===p?65535*(h-u)/(6*(p-g))|0:h===p?21845+(65535*(u-l)/(6*(p-g))|0):43690+(65535*(l-h)/(6*(p-g))|0)),m+=b*v+2048>>12,m>65535?m=65535:m<0&&(m=0),0===f?l=h=u=m>>8:(A=m<=32767?m*(4096+f)+2048>>12:m+((65535-m)*f+2048>>12),d=2*m-A>>8,A>>=8,y=c+21845&65535,l=y>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16),y=65535&c,h=y>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16),y=c-21845&65535,
u=y>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16)),e[w]=l,e[w+1]=h,e[w+2]=u)}}},{"./hsl_l16":18,"glur/mono16":14}],21:[function(e,t,n){t.exports=function(e,t,n,i,r,a){if(!(0===i||r<.5)){r>2&&(r=2);var o=t*n,s=4*o,l=2*o,h=2*o,u=4*Math.max(t,n),c=s,f=c+l,m=f+h,g=m+h,p=g+u,d=this.__instance("unsharp_mask",s+l+2*h+u+32,{exp:Math.exp}),A=new Uint32Array(e.buffer);new Uint32Array(this.__memory.buffer).set(A);var y=d.exports.hsl_l16||d.exports._hsl_l16;y(0,c,t,n),y=d.exports.blurMono16||d.exports._blurMono16,y(c,f,m,g,p,t,n,r),y=d.exports.unsharp||d.exports._unsharp,y(0,0,c,f,t,n,i,a),A.set(new Uint32Array(this.__memory.buffer,0,o))}}},{}],22:[function(e,t,n){t.exports="AGFzbQEAAAABMQZgAXwBfGACfX8AYAZ/f39/f38AYAh/f39/f39/fQBgBH9/f38AYAh/f39/f39/fwACGQIDZW52A2V4cAAAA2VudgZtZW1vcnkCAAEDBgUBAgMEBQQEAXAAAAdMBRZfX2J1aWxkX2dhdXNzaWFuX2NvZWZzAAEOX19nYXVzczE2X2xpbmUAAgpibHVyTW9ubzE2AAMHaHNsX2wxNgAEB3Vuc2hhcnAABQkBAAqJEAXZAQEGfAJAIAFE24a6Q4Ia+z8gALujIgOaEAAiBCAEoCIGtjgCECABIANEAAAAAAAAAMCiEAAiBbaMOAIUIAFEAAAAAAAA8D8gBKEiAiACoiAEIAMgA6CiRAAAAAAAAPA/oCAFoaMiArY4AgAgASAEIANEAAAAAAAA8L+gIAKioiIHtjgCBCABIAQgA0QAAAAAAADwP6AgAqKiIgO2OAIIIAEgBSACoiIEtow4AgwgASACIAegIAVEAAAAAAAA8D8gBqGgIgKjtjgCGCABIAMgBKEgAqO2OAIcCwu3AwMDfwR9CHwCQCADKgIUIQkgAyoCECEKIAMqAgwhCyADKgIIIQwCQCAEQX9qIgdBAEgiCA0AIAIgAC8BALgiDSADKgIYu6IiDiAJuyIQoiAOIAq7IhGiIA0gAyoCBLsiEqIgAyoCALsiEyANoqCgoCIPtjgCACACQQRqIQIgAEECaiEAIAdFDQAgBCEGA0AgAiAOIBCiIA8iDiARoiANIBKiIBMgAC8BALgiDaKgoKAiD7Y4AgAgAkEEaiECIABBAmohACAGQX9qIgZBAUoNAAsLAkAgCA0AIAEgByAFbEEBdGogAEF+ai8BACIIuCINIAu7IhGiIA0gDLsiEqKgIA0gAyoCHLuiIg4gCrsiE6KgIA4gCbsiFKKgIg8gAkF8aioCALugqzsBACAHRQ0AIAJBeGohAiAAQXxqIQBBACAFQQF0ayEHIAEgBSAEQQF0QXxqbGohBgNAIAghAyAALwEAIQggBiANIBGiIAO4Ig0gEqKgIA8iECAToqAgDiAUoqAiDyACKgIAu6CrOwEAIAYgB2ohBiAAQX5qIQAgAkF8aiECIBAhDiAEQX9qIgRBAUoNAAsLCwvfAgIDfwZ8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIgyaEAAiDSANoCIPtjgCECAEIAxEAAAAAAAAAMCiEAAiDraMOAIUIAREAAAAAAAA8D8gDaEiCyALoiANIAwgDKCiRAAAAAAAAPA/oCAOoaMiC7Y4AgAgBCANIAxEAAAAAAAA8L+gIAuioiIQtjgCBCAEIA0gDEQAAAAAAADwP6AgC6KiIgy2OAIIIAQgDiALoiINtow4AgwgBCALIBCgIA5EAAAAAAAA8D8gD6GgIgujtjgCGCAEIAwgDaEgC6O2OAIcIAYEQCAFQQF0IQogBiEJIAIhCANAIAAgCCADIAQgBSAGEAIgACAKaiEAIAhBAmohCCAJQX9qIgkNAAsLIAVFDQAgBkEBdCEIIAUhAANAIAIgASADIAQgBiAFEAIgAiAIaiECIAFBAmohASAAQX9qIgANAAsLC7wBAQV/IAMgAmwiAwRAQQAgA2shBgNAIAAoAgAiBEEIdiIHQf8BcSECAn8gBEH/AXEiAyAEQRB2IgRB/wFxIgVPBEAgAyIIIAMgAk8NARoLIAQgBCAHIAIgA0kbIAIgBUkbQf8BcQshCAJAIAMgAk0EQCADIAVNDQELIAQgByAEIAMgAk8bIAIgBUsbQf8BcSEDCyAAQQRqIQAgASADIAhqQYECbEEBdjsBACABQQJqIQEgBkEBaiIGDQALCwvTBgEKfwJAIAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6CqIQ0gBSAEbCILBEAgB0GBAmwhDgNAQQAgAi8BACADLwEAayIGQQF0IgdrIAcgBkEASBsgDk8EQCAAQQJqLQAAIQUCfyAALQAAIgYgAEEBai0AACIESSIJRQRAIAYiCCAGIAVPDQEaCyAFIAUgBCAEIAVJGyAGIARLGwshCAJ/IAYgBE0EQCAGIgogBiAFTQ0BGgsgBSAFIAQgBCAFSxsgCRsLIgogCGoiD0GBAmwiEEEBdiERQQAhDAJ/QQAiCSAIIApGDQAaIAggCmsiCUH/H2wgD0H+AyAIayAKayAQQYCABEkbbSEMIAYgCEYEQCAEIAVrQf//A2wgCUEGbG0MAQsgBSAGayAGIARrIAQgCEYiBhtB//8DbCAJQQZsbUHVqgFBqtUCIAYbagshCSARIAcgDWxBgBBqQQx1aiIGQQAgBkEAShsiBkH//wMgBkH//wNIGyEGAkACfwJAIAxB//8DcSIFBEAgBkH//wFKDQEgBUGAIGogBmxBgBBqQQx2DAILIAZBCHYiBiEFIAYhBAwCCyAFIAZB//8Dc2xBgBBqQQx2IAZqCyIFQQh2IQcgBkEBdCAFa0EIdiIGIQQCQCAJQdWqAWpB//8DcSIFQanVAksNACAFQf//AU8EQEGq1QIgBWsgByAGa2xBBmxBgIACakEQdiAGaiEEDAELIAchBCAFQanVAEsNACAFIAcgBmtsQQZsQYCAAmpBEHYgBmohBAsCfyAGIgUgCUH//wNxIghBqdUCSw0AGkGq1QIgCGsgByAGa2xBBmxBgIACakEQdiAGaiAIQf//AU8NABogByIFIAhBqdUASw0AGiAIIAcgBmtsQQZsQYCAAmpBEHYgBmoLIQUgCUGr1QJqQf//A3EiCEGp1QJLDQAgCEH//wFPBEBBqtUCIAhrIAcgBmtsQQZsQYCAAmpBEHYgBmohBgwBCyAIQanVAEsEQCAHIQYMAQsgCCAHIAZrbEEGbEGAgAJqQRB2IAZqIQYLIAEgBDoAACABQQFqIAU6AAAgAUECaiAGOgAACyADQQJqIQMgAkECaiECIABBBGohACABQQRqIQEgC0F/aiILDQALCwsL"},{}],23:[function(e,t,n){var i;t.exports=function(){if(void 0!==i)return i;if(i=!1,"undefined"==typeof WebAssembly)return i;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)&&(i=!0),i}catch(e){}return i}},{}],24:[function(e,t,n){function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,l=i(e),h=1;h<arguments.length;h++){n=Object(arguments[h]);for(var u in n)a.call(n,u)&&(l[u]=n[u]);if(r){s=r(n);for(var c=0;c<s.length;c++)o.call(n,s[c])&&(l[s[c]]=n[s[c]])}}return l}},{}],25:[function(e,t,n){var i=arguments[3],r=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){function n(e){d[e]=!0;for(var t in r[e][1]){var i=r[e][1][t];d[i]||n(i)}}for(var s,l=Object.keys(a),h=0,u=l.length;h<u;h++){var c=l[h],f=a[c].exports;if(f===e||f&&f.default===e){s=c;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var m={},h=0,u=l.length;h<u;h++){var c=l[h];m[c]=c}r[s]=["function(require,module,exports){"+e+"(self); }",m]}var g=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[s]=s,r[g]=["function(require,module,exports){var f = require("+o(s)+");(f.default ? f.default : f)(self);}",p];var d={};n(g);var A="("+i+")({"+Object.keys(d).map(function(e){return o(e)+":["+r[e][0]+","+o(r[e][1])+"]"}).join(",")+"},{},["+o(g)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,v=new Blob([A],{type:"text/javascript"});if(t&&t.bare)return v;var w=y.createObjectURL(v),I=new Worker(w);return I.objectURL=w,I}},{}],"/":[function(e,t,n){function i(){return{value:s(c),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;e&&e.revokeObjectURL&&this.value.objectURL&&e.revokeObjectURL(this.value.objectURL)}}}}function r(e){if(!(this instanceof r))return new r(e);this.options=o({},A,e||{});var t="lk_"+this.options.concurrency;this.__limit=g[t]||u.limiter(this.options.concurrency),g[t]||(g[t]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}var a=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("object-assign"),s=e("webworkify"),l=e("./lib/mathlib"),h=e("./lib/pool"),u=e("./lib/utils"),c=e("./lib/worker"),f=e("./lib/stepper"),m=e("./lib/tiler"),g={},p=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(p=navigator.userAgent.indexOf("Safari")>=0)}catch(e){}var d=1;"undefined"!=typeof navigator&&(d=Math.min(navigator.hardwareConcurrency||1,4));var A={tile:1024,concurrency:d,features:["js","wasm","ww"],idle:2e3},y={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},v=void 0,w=void 0;r.prototype.init=function(){var t=this;if(this.__initPromise)return this.__initPromise;if(!1!==v&&!0!==v&&(v=!1,"undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray))try{new ImageData(new Uint8ClampedArray(400),10,10),v=!0}catch(e){}!1!==w&&!0!==w&&(w=!1,"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?w=!0:this.debug("ImageBitmap does not support .close(), disabled")));var n=this.options.features.slice();if(n.indexOf("all")>=0&&(n=["cib","wasm","js","ww"]),this.__requested_features=n,this.__mathlib=new l(n),n.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{e("webworkify")(function(){}).terminate(),this.features.ww=!0;var r="wp_"+JSON.stringify(this.options);g[r]?this.__workersPool=g[r]:(this.__workersPool=new h(i,this.options.idle),g[r]=this.__workersPool)}catch(e){}var a=this.__mathlib.init().then(function(e){o(t.features,e.features)}),s=void 0;return s=w?u.cib_support().then(function(e){if(t.features.cib&&n.indexOf("cib")<0)return void t.debug("createImageBitmap() resize supported, but disabled by config");n.indexOf("cib")>=0&&(t.features.cib=e)}):Promise.resolve(!1),this.__initPromise=Promise.all([a,s]).then(function(){return t}),this.__initPromise},r.prototype.resize=function(e,t,n){var i=this;this.debug("Start resize...");var r=o({},y);isNaN(n)?n&&(r=o(r,n)):r=o(r,{quality:n}),r.toWidth=t.width,r.toHeight=t.height,r.width=e.naturalWidth||e.width,r.height=e.naturalHeight||e.height,r.unsharpRadius>2&&(r.unsharpRadius=2);var s=!1,l=null;r.cancelToken&&(l=r.cancelToken.then(function(e){throw s=!0,e},function(e){throw s=!0,e}));var h=Math.ceil(Math.max(3,2.5*r.unsharpRadius|0));return this.init().then(function(){if(s)return l;if(i.features.cib){var n=t.getContext("2d",{alpha:Boolean(r.alpha)});return i.debug("Resize via createImageBitmap()"),createImageBitmap(e,{resizeWidth:r.toWidth,resizeHeight:r.toHeight,resizeQuality:u.cib_quality_name(r.quality)}).then(function(e){if(s)return l;if(!r.unsharpAmount)return n.drawImage(e,0,0),e.close(),n=null,i.debug("Finished!"),t;i.debug("Unsharp result");var a=document.createElement("canvas");a.width=r.toWidth,a.height=r.toHeight;var o=a.getContext("2d",{alpha:Boolean(r.alpha)});o.drawImage(e,0,0),e.close();var h=o.getImageData(0,0,r.toWidth,r.toHeight);return i.__mathlib.unsharp(h.data,r.toWidth,r.toHeight,r.unsharpAmount,r.unsharpRadius,r.unsharpThreshold),n.putImageData(h,0,0),h=o=a=n=null,i.debug("Finished!"),t})}var c={},g=function(e){return Promise.resolve().then(function(){return i.features.ww?new Promise(function(t,n){var r=i.__workersPool.acquire();l&&l.catch(function(e){return n(e)}),r.value.onmessage=function(e){r.release(),e.data.err?n(e.data.err):t(e.data.result)},r.value.postMessage({opts:e,features:i.__requested_features,preload:{wasm_nodule:i.__mathlib.__}},[e.src.buffer])}):i.__mathlib.resizeAndUnsharp(e,c)})},d=function(e,t,n){var r=void 0,a=void 0,o=void 0,c=function(t){return i.__limit(function(){if(s)return l;var h=void 0;if(u.isCanvas(e))i.debug("Get tile pixel data"),h=r.getImageData(t.x,t.y,t.width,t.height);else{i.debug("Draw tile imageBitmap/image to temporary canvas");var c=document.createElement("canvas");c.width=t.width,c.height=t.height;var f=c.getContext("2d",{alpha:Boolean(n.alpha)});f.globalCompositeOperation="copy",f.drawImage(a||e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),i.debug("Get tile pixel data"),h=f.getImageData(0,0,t.width,t.height),f=c=null}var m={src:h.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:n.quality,alpha:n.alpha,unsharpAmount:n.unsharpAmount,unsharpRadius:n.unsharpRadius,unsharpThreshold:n.unsharpThreshold};return i.debug("Invoke resize math"),Promise.resolve().then(function(){return g(m)}).then(function(e){if(s)return l;h=null;var n=void 0;if(i.debug("Convert raw rgba tile result to ImageData"),v)n=new ImageData(new Uint8ClampedArray(e),t.toWidth,t.toHeight);else if(n=o.createImageData(t.toWidth,t.toHeight),n.data.set)n.data.set(e);else for(var r=n.data.length-1;r>=0;r--)n.data[r]=e[r];return i.debug("Draw tile"),p?o.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth+1e-5,t.toInnerHeight+1e-5):o.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),null})})};return Promise.resolve().then(function(){if(o=t.getContext("2d",{alpha:Boolean(n.alpha)}),u.isCanvas(e))return r=e.getContext("2d",{alpha:Boolean(n.alpha)}),null;if(u.isImage(e))return w?(i.debug("Decode image via createImageBitmap"),createImageBitmap(e).then(function(e){a=e})):null;throw new Error('".from" should be image or canvas')}).then(function(){function e(){a&&(a.close(),a=null)}if(s)return l;i.debug("Calculate tiles");var r=m({width:n.width,height:n.height,srcTileSize:i.options.tile,toWidth:n.toWidth,toHeight:n.toHeight,destTileBorder:h}),o=r.map(function(e){return c(e)});return i.debug("Process tiles"),Promise.all(o).then(function(){return i.debug("Finished!"),e(),t},function(t){throw e(),t})})},A=f(r.width,r.height,r.toWidth,r.toHeight,i.options.tile,h);return function e(t,n,i,r){if(s)return l;var h=t.shift(),u=a(h,2),c=u[0],f=u[1],m=0===t.length;r=o({},r,{toWidth:c,toHeight:f,quality:m?r.quality:Math.min(1,r.quality)});var g=void 0;return m||(g=document.createElement("canvas"),g.width=c,g.height=f),d(n,m?i:g,r).then(function(){return m?i:(r.width=c,r.height=f,e(t,g,i,r))})}(A,e,t,r)})},r.prototype.resizeBuffer=function(e){var t=this,n=o({},y,e);return this.init().then(function(){return t.__mathlib.resizeAndUnsharp(n)})},r.prototype.toBlob=function(e,t,n){return t=t||"image/png",new Promise(function(i){if(e.toBlob)return void e.toBlob(function(e){return i(e)},t,n);for(var r=atob(e.toDataURL(t,n).split(",")[1]),a=r.length,o=new Uint8Array(a),s=0;s<a;s++)o[s]=r.charCodeAt(s);i(new Blob([o],{type:t}))})},r.prototype.debug=function(){},t.exports=r},{"./lib/mathlib":1,"./lib/pool":9,"./lib/stepper":10,"./lib/tiler":11,"./lib/utils":12,"./lib/worker":13,"object-assign":24,webworkify:25}]},{},[])("/")}()}()}),O="square",U="to",N=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],j=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],H=function e(){d(this,e),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},q=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(r,a){try{var o=t[r](a),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){i("next",e)},function(e){i("throw",e)});e(s)}return i("next")})}},z=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},W=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Y=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){r=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),X=function(){function e(){z(this,e),this._tasks=[],this._canvas=null,this._loadedCanvas=null,this._lastCanvas=null,this._fileName=null,this._exif={}}return W(e,[{key:"loadBlob",value:function(e,t){return this._addToTask("LOADER",i(e,t)),this}},{key:"loadCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"canvas.png";return this._addToTask("LOADER",a(e,t)),this}},{key:"_imageResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._addToTask("MANIPULATION",s(e,t,n,i)),this}},{key:"toSquare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._imageResize(e,e,O,t)}},{key:"crop",value:function(e,t,n,i){return this._addToTask("MANIPULATION",o(e,t,n,i)),this}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._imageResize(e,t,U,n)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._addToTask("MANIPULATION",h(e,t)),this}},{key:"toGrayscale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._addToTask("FILTER",f(e)),this}},{key:"pixelize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;return this._addToTask("FILTER",m(e)),this}},{key:"gaussianBlur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._addToTask("FILTER",w(e)),this}},{key:"centerInRectangle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._imageResize(e,t,U,n),this._addToTask("MANIPULATION",u(e,t,n)),this}},{key:"toCircle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._imageResize(e,e,O,t),this._addToTask("MANIPULATION",c(e,t)),this}},{key:"_runTasks",value:function(){function e(){return t.apply(this,arguments)}var t=q(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._canvas=null,t=0;case 2:if(!(t<this._tasks.length)){e.next=20;break}if("LOADER"!==this._tasks[t].type){e.next=12;break}return e.next=6,this._tasks[t].func();case 6:n=e.sent,this._loadedCanvas=n.canvas,n.fileName&&(this._fileName=n.fileName),n.exif&&(this._exif=n.exif),e.next=17;break;case 12:if(null!==this._canvas||null!==this._loadedCanvas){e.next=14;break}throw new Error("use loadBlob first");case 14:return e.next=16,this._tasks[t].func(this._canvas||this._loadedCanvas);case 16:this._canvas=e.sent;case 17:t++,e.next=2;break;case 20:this._cleanTasks();case 21:case"end":return e.stop()}},e,this)}));return e}()},{key:"_addToTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"manipulation",t=arguments[1];this._tasks.push({type:e,func:t})}},{key:"_cleanTasks",value:function(){this._tasks=[],null!==this._canvas&&(this._lastCanvas=this._canvas)}},{key:"getCanvas",value:function(){return this._canvas||this._lastCanvas}},{key:"getFileName",value:function(){return this._fileName}},{key:"getExif",value:function(){return this._exif}},{key:"setFileName",value:function(e){this._fileName=e}},{key:"saveAsBlob",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/jpeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.0";return this._runTasks().then(function(){return S(e.getCanvas(),e.getFileName(),t,n)})}},{key:"saveAsCanvas",value:function(){var e=this;return this._runTasks().then(function(){return b(e.getCanvas())})}},{key:"saveAsImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/jpeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.0";return this._runTasks().then(function(){return C(e.getCanvas(),t,n)})}},{key:"drawLine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return this._addToTask("DRAW",B(e,t,n)),this}},{key:"drawPolygon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return this._addToTask("DRAW",P(e,t,n,i)),this}},{key:"drawRectangle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return this._addToTask("DRAW",_(e,t,n,i)),this}},{key:"drawText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addToTask("DRAW",x(e,t,n)),this}},{key:"perspective",value:function(e){return this._addToTask("MANIPULATION",L(e)),this}}]),e}();t(function(e){!function(t){var n=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,i=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=i&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),a=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(i||a)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,n,s,l,h,u,c,f,m;if(!(t=e.match(o)))throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],l=e.slice(t[0].length),h=s?atob(l):decodeURIComponent(l),u=new ArrayBuffer(h.length),c=new Uint8Array(u),f=0;f<h.length;f+=1)c[f]=h.charCodeAt(f);return i?new Blob([r?c:u],{type:n}):(m=new a,m.append(u),m.getBlob(n))};t.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(e,t,i){var r=this;setTimeout(function(){e(i&&n.toDataURL&&s?s(r.toDataURL(t,i)):r.mozGetAsFile("blob",t))})}:n.toDataURL&&s&&(n.toBlob=function(e,t,n){var i=this;setTimeout(function(){e(s(i.toDataURL(t,n)))})})),e.exports?e.exports=s:t.dataURLtoBlob=s}(window)});return"undefined"!=typeof window&&(window.BrowserImageManipulation=X),X});
//# sourceMappingURL=browser-image-manipulation.js.map
