!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self)["browser-image-manipulation"]=t()}(this,(function(){"use strict";function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t((function(e){var t=function(e){var t,n=Object.prototype,i=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,n,i){var a=t&&t.prototype instanceof p?t:p,r=Object.create(a.prototype),o=new P(i||[]);return r._invoke=function(e,t,n){var i=u;return function(a,r){if(i===f)throw new Error("Generator is already running");if(i===g){if("throw"===a)throw r;return x()}for(n.method=a,n.arg=r;1;){var o=n.delegate;if(o){var s=C(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var l=h(e,t,n);if("normal"===l.type){if(i=n.done?g:c,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=g,n.method="throw",n.arg=l.arg)}}}(e,n,o),r}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u="suspendedStart",c="suspendedYield",f="executing",g="completed",m={};function p(){}function d(){}function A(){}var y={};y[r]=function(){return this};var v=Object.getPrototypeOf,w=v&&v(v(_([])));w&&w!==n&&i.call(w,r)&&(y=w);var I=A.prototype=p.prototype=Object.create(y);function S(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e){var t;this._invoke=function(n,a){function r(){return new Promise((function(t,r){!function t(n,a,r,o){var s=h(e[n],e,a);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,r,o)}),(function(e){t("throw",e,r,o)})):Promise.resolve(u).then((function(e){l.value=e,r(l)}),(function(e){return t("throw",e,r,o)}))}o(s.arg)}(n,a,t,r)}))}return t=t?t.then(r,r):r()}}function C(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var r=a.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function B(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function _(e){if(e){var n=e[r];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(i.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:x}}function x(){return{value:t,done:!0}}return d.prototype=I.constructor=A,A.constructor=d,A[s]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},S(b.prototype),b.prototype[o]=function(){return this},e.AsyncIterator=b,e.async=function(t,n,i,a){var r=new b(l(t,n,i,a));return e.isGeneratorFunction(n)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},S(I),I[s]="Generator",I[r]=function(){return this},I.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(B),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(i,a){return s.type="throw",s.arg=e,n.next=i,a&&(n.method="next",n.arg=t),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),h=i.call(o,"finallyLoc");if(l&&h){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),B(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var a=i.arg;B(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:_(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function i(e,t,n,i,a,r,o){try{var s=e[r](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,a)}var a=function(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function s(e){i(o,a,r,s,l,"next",e)}function l(e){i(o,a,r,s,l,"throw",e)}s(void 0)}))}};var r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e},l=t((function(e,t){!function(){var n={};function i(e){return c(">"+g("B",e.length),e)}function a(e){return c(">"+g("H",e.length),e)}function r(e){return c(">"+g("L",e.length),e)}function o(e,t,n){var o,s,l,h,u="",f="";if("Byte"==t)(o=e.length)<=4?f=i(e)+g("\0",4-o):(f=c(">L",[n]),u=i(e));else if("Short"==t)(o=e.length)<=2?f=a(e)+g("\0\0",2-o):(f=c(">L",[n]),u=a(e));else if("Long"==t)(o=e.length)<=1?f=r(e):(f=c(">L",[n]),u=r(e));else if("Ascii"==t)(o=(s=e+"\0").length)>4?(f=c(">L",[n]),u=s):f=s+g("\0",4-o);else if("Rational"==t){if("number"==typeof e[0])o=1,l=e[0],h=e[1],s=c(">L",[l])+c(">L",[h]);else{o=e.length,s="";for(var m=0;m<o;m++)l=e[m][0],h=e[m][1],s+=c(">L",[l])+c(">L",[h])}f=c(">L",[n]),u=s}else if("SRational"==t){if("number"==typeof e[0])o=1,l=e[0],h=e[1],s=c(">l",[l])+c(">l",[h]);else{o=e.length,s="";for(m=0;m<o;m++)l=e[m][0],h=e[m][1],s+=c(">l",[l])+c(">l",[h])}f=c(">L",[n]),u=s}else"Undefined"==t&&((o=e.length)>4?(f=c(">L",[n]),u=e):f=e+g("\0",4-o));return[c(">L",[o]),f,u]}function s(e,t,n){var i,a=8,r=Object.keys(e).length,s=c(">H",[r]);i=["0th","1st"].indexOf(t)>-1?2+12*r+4:2+12*r;var l="",h="";for(var u in e)if("string"==typeof u&&(u=parseInt(u)),!("0th"==t&&[34665,34853].indexOf(u)>-1||"Exif"==t&&40965==u||"1st"==t&&[513,514].indexOf(u)>-1)){var f=e[u],g=c(">H",[u]),m=d[t][u]["type"],A=c(">H",[p[m]]);"number"==typeof f&&(f=[f]);var y=o(f,m,a+i+n+h.length);l+=g+A+y[0]+y[1],h+=y[2]}return[s+l,h]}function l(e){var t;if("ÿØ"==e.slice(0,2))t=function(e){for(var t,n=0;n<e.length;n++)if("ÿá"==(t=e[n]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}(m(e)),this.tiftag=t?t.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}if(n.version="1.0.4",n.remove=function(e){var t=!1;if("ÿØ"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=u(e.split(",")[1]),t=!0}var n=m(e).filter((function(e){return!("ÿá"==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))})).join("");return t&&(n="data:image/jpeg;base64,"+h(n)),n},n.insert=function(e,t){var n=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if("ÿØ"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=u(t.split(",")[1]),n=!0}var i="ÿá"+c(">H",[e.length+2])+e,a=function(e,t){var n=!1,i=[];e.forEach((function(a,r){"ÿá"==a.slice(0,2)&&"Exif\0\0"==a.slice(4,10)&&(n?i.unshift(r):(e[r]=t,n=!0))})),i.forEach((function(t){e.splice(t,1)})),!n&&t&&(e=[e[0],t].concat(e.slice(1)));return e.join("")}(m(t),i);return n&&(a="data:image/jpeg;base64,"+h(a)),a},n.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if("ÿØ"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=u(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var n={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},i=new l(t);if(null===i.tiftag)return n;"II"==i.tiftag.slice(0,2)?i.endian_mark="<":i.endian_mark=">";var a=f(i.endian_mark+"L",i.tiftag.slice(4,8))[0];n["0th"]=i.get_ifd(a,"0th");var r=n["0th"]["first_ifd_pointer"];if(delete n["0th"]["first_ifd_pointer"],34665 in n["0th"]&&(a=n["0th"][34665],n["Exif"]=i.get_ifd(a,"Exif")),34853 in n["0th"]&&(a=n["0th"][34853],n["GPS"]=i.get_ifd(a,"GPS")),40965 in n["Exif"]&&(a=n["Exif"][40965],n["Interop"]=i.get_ifd(a,"Interop")),"\0\0\0\0"!=r&&(a=f(i.endian_mark+"L",r)[0],n["1st"]=i.get_ifd(a,"1st"),513 in n["1st"]&&514 in n["1st"])){var o=n["1st"][513]+n["1st"][514],s=i.tiftag.slice(n["1st"][513],o);n["thumbnail"]=s}return n},n.dump=function(e){var t,i,a,r,o,l,h=8,u=(t=e,JSON.parse(JSON.stringify(t))),f=!1,g=!1,d=!1,A=!1;i="0th"in u?u["0th"]:{},"Exif"in u&&Object.keys(u["Exif"]).length||"Interop"in u&&Object.keys(u["Interop"]).length?(i[34665]=1,f=!0,a=u["Exif"],"Interop"in u&&Object.keys(u["Interop"]).length?(a[40965]=1,d=!0,r=u["Interop"]):Object.keys(a).indexOf(n.ExifIFD.InteroperabilityTag.toString())>-1&&delete a[40965]):Object.keys(i).indexOf(n.ImageIFD.ExifTag.toString())>-1&&delete i[34665],"GPS"in u&&Object.keys(u["GPS"]).length?(i[n.ImageIFD.GPSTag]=1,g=!0,o=u["GPS"]):Object.keys(i).indexOf(n.ImageIFD.GPSTag.toString())>-1&&delete i[n.ImageIFD.GPSTag],"1st"in u&&"thumbnail"in u&&null!=u["thumbnail"]&&(A=!0,u["1st"][513]=1,u["1st"][514]=1,l=u["1st"]);var y,v,w,I=s(i,"0th",0),S=I[0].length+12*f+12*g+4+I[1].length,b="",C=0,E="",B=0,P="",_=0,x="";(f&&(C=(y=s(a,"Exif",S))[0].length+12*d+y[1].length),g&&(B=(E=s(o,"GPS",S+C).join("")).length),d)&&(_=(P=s(r,"Interop",S+C+B).join("")).length);if(A&&(v=s(l,"1st",S+C+B+_),(w=function(e){var t=m(e);for(;"ÿà"<=t[1].slice(0,2)&&t[1].slice(0,2)<="ÿï";)t=[t[0]].concat(t.slice(2));return t.join("")}(u["thumbnail"])).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");var L="",R="",k="",D="\0\0\0\0";if(f){var M=c(">L",[G=h+S]);L=c(">H",[34665])+c(">H",[p["Long"]])+c(">L",[1])+M}if(g){M=c(">L",[G=h+S+C]);R=c(">H",[34853])+c(">H",[p["Long"]])+c(">L",[1])+M}if(d){M=c(">L",[G=h+S+C+B]);k=c(">H",[40965])+c(">H",[p["Long"]])+c(">L",[1])+M}if(A){var G;D=c(">L",[G=h+S+C+B+_]);var Q="\0\0\0\0"+c(">L",[G+v[0].length+24+4+v[1].length]),T="\0\0\0\0"+c(">L",[w.length]);x=v[0]+Q+T+"\0\0\0\0"+v[1]+w}var F=I[0]+L+R+D+I[1];return f&&(b=y[0]+k+y[1]),"Exif\0\0MM\0*\0\0\0\b"+F+b+E+P+x},l.prototype={get_ifd:function(e,t){var n,i={},a=f(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],r=e+2;n=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<a;o++){e=r+12*o;var s=f(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],l=[f(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],f(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];s in d[n]&&(i[s]=this.convert_value(l))}return"0th"==t&&(e=r+12*a,i["first_ifd_pointer"]=this.tiftag.slice(e,e+4)),i},convert_value:function(e){var t,n=null,i=e[0],a=e[1],r=e[2];if(1==i)a>4?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+g("B",a),this.tiftag.slice(t,t+a))):n=f(this.endian_mark+g("B",a),r.slice(0,a));else if(2==i)a>4?(t=f(this.endian_mark+"L",r)[0],n=this.tiftag.slice(t,t+a-1)):n=r.slice(0,a-1);else if(3==i)a>2?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+g("H",a),this.tiftag.slice(t,t+2*a))):n=f(this.endian_mark+g("H",a),r.slice(0,2*a));else if(4==i)a>1?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+g("L",a),this.tiftag.slice(t,t+4*a))):n=f(this.endian_mark+g("L",a),r);else if(5==i)if(t=f(this.endian_mark+"L",r)[0],a>1){n=[];for(var o=0;o<a;o++)n.push([f(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],f(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[f(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],f(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==i)a>4?(t=f(this.endian_mark+"L",r)[0],n=this.tiftag.slice(t,t+a)):n=r.slice(0,a);else if(9==i)a>1?(t=f(this.endian_mark+"L",r)[0],n=f(this.endian_mark+g("l",a),this.tiftag.slice(t,t+4*a))):n=f(this.endian_mark+g("l",a),r);else{if(10!=i)throw new Error("Exif might be wrong. Got incorrect value "+"type to decode. type:"+i);if(t=f(this.endian_mark+"L",r)[0],a>1){n=[];for(o=0;o<a;o++)n.push([f(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],f(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[f(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],f(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return n instanceof Array&&1==n.length?n[0]:n}},"undefined"!=typeof window&&"function"==typeof window.btoa)var h=window.btoa;if(void 0===h)h=function(e){for(var t,n,i,a,r,o,s,l="",h=0,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";h<e.length;)a=(t=e.charCodeAt(h++))>>2,r=(3&t)<<4|(n=e.charCodeAt(h++))>>4,o=(15&n)<<2|(i=e.charCodeAt(h++))>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),l=l+u.charAt(a)+u.charAt(r)+u.charAt(o)+u.charAt(s);return l};if("undefined"!=typeof window&&"function"==typeof window.atob)var u=window.atob;if(void 0===u)u=function(e){var t,n,i,a,r,o,s="",l=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=h.indexOf(e.charAt(l++))<<2|(a=h.indexOf(e.charAt(l++)))>>4,n=(15&a)<<4|(r=h.indexOf(e.charAt(l++)))>>2,i=(3&r)<<6|(o=h.indexOf(e.charAt(l++))),s+=String.fromCharCode(t),64!=r&&(s+=String.fromCharCode(n)),64!=o&&(s+=String.fromCharCode(i));return s};function c(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("");n=!1}for(var i="",a=1,r=null,o=null,s=null;o=e[a];){if("b"==o.toLowerCase()){if(r=t[a-1],"b"==o&&r<0&&(r+=256),r>255||r<0)throw new Error("'pack' error.");s=String.fromCharCode(r)}else if("H"==o){if((r=t[a-1])>65535||r<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),n&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(r=t[a-1],"l"==o&&r<0&&(r+=4294967296),r>4294967295||r<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(r/16777216))+String.fromCharCode(Math.floor(r%16777216/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256),n&&(s=s.split("").reverse().join(""))}i+=s,a+=1}return i}function f(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var n,i=0,a=1;a<e.length;a++)if("b"==e[a].toLowerCase())i+=1;else if("h"==e[a].toLowerCase())i+=2;else{if("l"!=e[a].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");i+=4}if(i!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+i+":"+t.length);if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");n=!1}for(var r=[],o=0,s=1,l=null,h=null,u=null,c="";h=e[s];){if("b"==h.toLowerCase())u=1,l=(c=t.slice(o,o+u)).charCodeAt(0),"b"==h&&l>=128&&(l-=256);else if("H"==h)u=2,c=t.slice(o,o+u),n&&(c=c.split("").reverse().join("")),l=256*c.charCodeAt(0)+c.charCodeAt(1);else{if("l"!=h.toLowerCase())throw new Error("'unpack' error. "+h);u=4,c=t.slice(o,o+u),n&&(c=c.split("").reverse().join("")),l=16777216*c.charCodeAt(0)+65536*c.charCodeAt(1)+256*c.charCodeAt(2)+c.charCodeAt(3),"l"==h&&l>=2147483648&&(l-=4294967296)}r.push(l),o+=u,s+=1}return r}function g(e,t){for(var n="",i=0;i<t;i++)n+=e;return n}function m(e){if("ÿØ"!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,n=["ÿØ"];1;){if("ÿÚ"==e.slice(t,t+2)){n.push(e.slice(t));break}var i=t+f(">H",e.slice(t+2,t+4))[0]+2;if(n.push(e.slice(t,i)),(t=i)>=e.length)throw new Error("Wrong JPEG data.")}return n}var p={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},d={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};d["0th"]=d["Image"],d["1st"]=d["Image"],n.TAGS=d,n.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},n.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},n.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},n.InteropIFD={InteroperabilityIndex:1},n.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),n=t%1*60,i=n%1*60;return[[Math.floor(t),1],[Math.floor(n),1],[Math.round(100*i),100]]},dmsRationalToDeg:function(e,t){var n="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*n}},e.exports&&(t=e.exports=n),t.piexif=n}()}));l.piexif;function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fixOrientation,i=void 0!==n&&n,a=t.readExif,r=void 0!==a&&a;return function(){return new Promise((function(t,n){var a=document.createElement("img"),o=new FileReader,s={};o.onload=function(e){s=i||r?function(e){var t={};try{var n=l.load(e);for(var i in n)if("thumbnail"!==i)for(var a in t[i]={},n[i])t[i][l.TAGS[i][a]["name"]]=n[i][a]}catch(e){console.warn("Error on read exif data")}return t}(e.target.result):{},a.src=e.target.result},o.onerror=function(){n(new Error("Image read error"))},a.onload=function(){var n=null;i&&(n=s["0th"]?s["0th"]["Orientation"]:null);var r=function(e,t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d"),a=0,r=0;i.save(),2===t?(a=-n.width,i.scale(-1,1)):3===t?(a=-n.width,r=-n.height,i.scale(-1,-1)):3===t?(a=-n.width,r=-n.height,i.scale(-1,-1)):4===t?(r=-n.height,i.scale(1,-1)):5===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),r=-n.width,i.scale(1,-1)):6===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2)):7===t?(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),a=-n.height,i.scale(-1,1)):8===t&&(n.width=e.height,n.height=e.width,i.translate(n.width,n.height/n.width),i.rotate(Math.PI/2),a=-n.height,r=-n.width,i.scale(-1,-1));return i.drawImage(e,a,r),i.restore(),n}(a,n);t({canvas:r,fileName:e.name,exif:s})},a.onerror=function(){n(new Error("Invalid image"))},o.readAsDataURL(e)}))}}function u(e,t){return function(){return Promise.resolve({canvas:e,fileName:t})}}var c=t((function(t,n){t.exports=function t(n,i,a){function r(s,l){if(!i[s]){if(!n[s]){var h="function"==typeof e&&e;if(!l&&h)return h(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[s]={exports:{}};n[s][0].call(c.exports,(function(e){return r(n[s][1][e]||e)}),c,c.exports,t,n,i,a)}return i[s].exports}for(var o="function"==typeof e&&e,s=0;s<a.length;s++)r(a[s]);return r}({1:[function(e,t,n){var i=e("inherits"),a=e("multimath"),r=e("multimath/lib/unsharp_mask"),o=e("./mm_resize");function s(e){var t=e||[],n={js:t.indexOf("js")>=0,wasm:t.indexOf("wasm")>=0};a.call(this,n),this.features={js:n.js,wasm:n.wasm&&this.has_wasm()},this.use(r),this.use(o)}i(s,a),s.prototype.resizeAndUnsharp=function(e,t){var n=this.resize(e,t);return e.unsharpAmount&&this.unsharp_mask(n,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),n},t.exports=s},{"./mm_resize":4,inherits:15,multimath:16,"multimath/lib/unsharp_mask":19}],2:[function(e,t,n){function i(e){return e<0?0:e>255?255:e}t.exports={convolveHorizontally:function(e,t,n,a,r,o){var s,l,h,u,c,f,g,m,p,d,A,y=0,v=0;for(p=0;p<a;p++){for(c=0,d=0;d<r;d++){for(f=o[c++],g=o[c++],m=y+4*f|0,s=l=h=u=0;g>0;g--)u=u+(A=o[c++])*e[m+3]|0,h=h+A*e[m+2]|0,l=l+A*e[m+1]|0,s=s+A*e[m]|0,m=m+4|0;t[v+3]=i(u+(1<<13)>>14),t[v+2]=i(h+(1<<13)>>14),t[v+1]=i(l+(1<<13)>>14),t[v]=i(s+(1<<13)>>14),v=v+4*a|0}v=4*(p+1)|0,y=(p+1)*n*4|0}},convolveVertically:function(e,t,n,a,r,o){var s,l,h,u,c,f,g,m,p,d,A,y=0,v=0;for(p=0;p<a;p++){for(c=0,d=0;d<r;d++){for(f=o[c++],g=o[c++],m=y+4*f|0,s=l=h=u=0;g>0;g--)u=u+(A=o[c++])*e[m+3]|0,h=h+A*e[m+2]|0,l=l+A*e[m+1]|0,s=s+A*e[m]|0,m=m+4|0;t[v+3]=i(u+(1<<13)>>14),t[v+2]=i(h+(1<<13)>>14),t[v+1]=i(l+(1<<13)>>14),t[v]=i(s+(1<<13)>>14),v=v+4*a|0}v=4*(p+1)|0,y=(p+1)*n*4|0}}}},{}],3:[function(e,t,n){t.exports="AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw=="},{}],4:[function(e,t,n){t.exports={name:"resize",fn:e("./resize"),wasm_fn:e("./resize_wasm"),wasm_src:e("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(e,t,n){var i=e("./resize_filter_gen"),a=e("./convolve").convolveHorizontally,r=e("./convolve").convolveVertically;t.exports=function(e){var t=e.src,n=e.width,o=e.height,s=e.toWidth,l=e.toHeight,h=e.scaleX||e.toWidth/e.width,u=e.scaleY||e.toHeight/e.height,c=e.offsetX||0,f=e.offsetY||0,g=e.dest||new Uint8Array(s*l*4),m=void 0===e.quality?3:e.quality,p=e.alpha||!1,d=i(m,n,s,h,c),A=i(m,o,l,u,f),y=new Uint8Array(s*o*4);return a(t,y,n,o,s,d),r(y,g,o,s,l,A),p||function(e,t,n){for(var i=3,a=t*n*4|0;i<a;)e[i]=255,i=i+4|0}(g,s,l),g}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(e,t,n){var i=e("./resize_filter_info"),a=14;function r(e){return Math.round(e*((1<<a)-1))}t.exports=function(e,t,n,a,o){var s,l,h,u,c,f,g,m,p,d,A,y,v,w,I,S,b,C=i[e].filter,E=1/a,B=Math.min(1,a),P=i[e].win/B,_=Math.floor(2*(P+1)),x=new Int16Array((_+2)*n),L=0,R=!x.subarray||!x.set;for(s=0;s<n;s++){for(l=(s+.5)*E+o,h=Math.max(0,Math.floor(l-P)),c=(u=Math.min(t-1,Math.ceil(l+P)))-h+1,f=new Float32Array(c),g=new Int16Array(c),m=0,p=h,d=0;p<=u;p++,d++)m+=A=C((p+.5-l)*B),f[d]=A;for(y=0,d=0;d<f.length;d++)y+=v=f[d]/m,g[d]=r(v);for(g[n>>1]+=r(1-y),w=0;w<g.length&&0===g[w];)w++;if(w<g.length){for(I=g.length-1;I>0&&0===g[I];)I--;if(S=h+w,b=I-w+1,x[L++]=S,x[L++]=b,R)for(d=w;d<=I;d++)x[L++]=g[d];else x.set(g.subarray(w,I+1),L),L+=b}else x[L++]=0,x[L++]=0}return x}},{"./resize_filter_info":7}],7:[function(e,t,n){t.exports=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}]},{}],8:[function(e,t,n){var i=e("./resize_filter_gen"),a=!0;try{a=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(e){}function r(e,t,n){if(a)t.set(function(e){return new Uint8Array(e.buffer,0,e.byteLength)}(e),n);else for(var i=n,r=0;r<e.length;r++){var o=e[r];t[i++]=255&o,t[i++]=o>>8&255}}t.exports=function(e){var t=e.src,n=e.width,a=e.height,o=e.toWidth,s=e.toHeight,l=e.scaleX||e.toWidth/e.width,h=e.scaleY||e.toHeight/e.height,u=e.offsetX||0,c=e.offsetY||0,f=e.dest||new Uint8Array(o*s*4),g=void 0===e.quality?3:e.quality,m=e.alpha||!1,p=i(g,n,o,l,u),d=i(g,a,s,h,c),A=this.__align(0+Math.max(t.byteLength,f.byteLength)),y=this.__align(A+a*o*4),v=this.__align(y+p.byteLength),w=v+d.byteLength,I=this.__instance("resize",w),S=new Uint8Array(this.__memory.buffer),b=new Uint32Array(this.__memory.buffer),C=new Uint32Array(t.buffer);return b.set(C),r(p,S,y),r(d,S,v),(I.exports.convolveHV||I.exports._convolveHV)(y,v,A,n,a,o,s),new Uint32Array(f.buffer).set(new Uint32Array(this.__memory.buffer,0,s*o)),m||function(e,t,n){for(var i=3,a=t*n*4|0;i<a;)e[i]=255,i=i+4|0}(f,o,s),f}},{"./resize_filter_gen":6}],9:[function(e,t,n){var i=100;function a(e,t){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=t||2e3}a.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():((e=this.create()).id=this.lastId++,e.release=function(){return t.release(e)}),this.acquired[e.id]=e,e},a.prototype.release=function(e){var t=this;delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout((function(){return t.gc()}),i))},a.prototype.gc=function(){var e=this,t=Date.now();this.available=this.available.filter((function(n){return!(t-n.lastUsed>e.idle&&(n.destroy(),1))})),0!==this.available.length?this.timeoutId=setTimeout((function(){return e.gc()}),i):this.timeoutId=0},t.exports=a},{}],10:[function(e,t,n){var i=2;t.exports=function(e,t,n,a,r,o){var s=n/e,l=a/t,h=(2*o+i+1)/r;if(h>.5)return[[n,a]];var u=Math.ceil(Math.log(Math.min(s,l))/Math.log(h));if(u<=1)return[[n,a]];for(var c=[],f=0;f<u;f++){var g=Math.round(Math.pow(Math.pow(e,u-f-1)*Math.pow(n,f+1),1/u)),m=Math.round(Math.pow(Math.pow(t,u-f-1)*Math.pow(a,f+1),1/u));c.push([g,m])}return c}},{}],11:[function(e,t,n){var i=1e-5;function a(e){var t=Math.round(e);return Math.abs(e-t)<i?t:Math.floor(e)}function r(e){var t=Math.round(e);return Math.abs(e-t)<i?t:Math.ceil(e)}t.exports=function(e){var t,n,i,o,s,l,h=e.toWidth/e.width,u=e.toHeight/e.height,c=a(e.srcTileSize*h)-2*e.destTileBorder,f=a(e.srcTileSize*u)-2*e.destTileBorder;if(c<1||f<1)throw new Error("Internal error in pica: target tile width/height is too small.");var g,m=[];for(o=0;o<e.toHeight;o+=f)for(i=0;i<e.toWidth;i+=c)(t=i-e.destTileBorder)<0&&(t=0),t+(s=i+c+e.destTileBorder-t)>=e.toWidth&&(s=e.toWidth-t),(n=o-e.destTileBorder)<0&&(n=0),n+(l=o+f+e.destTileBorder-n)>=e.toHeight&&(l=e.toHeight-n),g={toX:t,toY:n,toWidth:s,toHeight:l,toInnerX:i,toInnerY:o,toInnerWidth:c,toInnerHeight:f,offsetX:t/h-a(t/h),offsetY:n/u-a(n/u),scaleX:h,scaleY:u,x:a(t/h),y:a(n/u),width:r(s/h),height:r(l/u)},m.push(g);return m}},{}],12:[function(e,t,n){function i(e){return Object.prototype.toString.call(e)}t.exports.isCanvas=function(e){var t=i(e);return"[object HTMLCanvasElement]"===t||"[object Canvas]"===t},t.exports.isImage=function(e){return"[object HTMLImageElement]"===i(e)},t.exports.limiter=function(e){var t=0,n=[];function i(){t<e&&n.length&&(t++,n.shift()())}return function(e){return new Promise((function(a,r){n.push((function(){e().then((function(e){a(e),t--,i()}),(function(e){r(e),t--,i()}))})),i()}))}},t.exports.cib_quality_name=function(e){switch(e){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},t.exports.cib_support=function(){return Promise.resolve().then((function(){if("undefined"==typeof createImageBitmap||"undefined"==typeof document)return!1;var e=document.createElement("canvas");return e.width=100,e.height=100,createImageBitmap(e,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then((function(t){var n=10===t.width;return t.close(),e=null,n}))}))["catch"]((function(){return!1}))}},{}],13:[function(e,t,n){t.exports=function(){var t,n=e("./mathlib");onmessage=function(e){var i=e.data.opts;t||(t=new n(e.data.features));var a=t.resizeAndUnsharp(i);postMessage({result:a},[a.buffer])}}},{"./mathlib":1}],14:[function(e,t,n){var i,a,r,o,s,l;function h(e,t,n,i,a,r){var o,s,l,h,u,c,f,g,m,p,d,A,y,v;for(m=0;m<r;m++){for(f=m,g=0,h=u=(o=e[c=m*a])*i[6],d=i[0],A=i[1],y=i[4],v=i[5],p=0;p<a;p++)l=(s=e[c])*d+o*A+h*y+u*v,u=h,h=l,o=s,n[g]=h,g++,c++;for(g--,f+=r*(a-1),h=u=(o=e[--c])*i[7],s=o,d=i[2],A=i[3],p=a-1;p>=0;p--)l=s*d+o*A+h*y+u*v,u=h,h=l,o=s,s=e[c],t[f]=n[g]+h,c--,g--,f-=r}}t.exports=function(e,t,n,u){if(u){var c=new Uint16Array(e.length),f=new Float32Array(Math.max(t,n)),g=function(e){e<.5&&(e=.5);var t=Math.exp(.726*.726)/e,n=Math.exp(-t),h=Math.exp(-2*t),u=(1-n)*(1-n)/(1+2*t*n-h);return i=u,a=u*(t-1)*n,r=u*(t+1)*n,o=-u*h,s=2*n,l=-h,new Float32Array([i,a,r,o,s,l,(i+a)/(1-s-l),(r+o)/(1-s-l)])}(u);h(e,c,f,g,t,n),h(c,e,f,g,n,t)}}},{}],15:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],16:[function(e,t,n){var i=e("object-assign"),a=e("./lib/base64decode"),r=e("./lib/wa_detect"),o={js:!0,wasm:!0};function s(e){if(!(this instanceof s))return new s(e);var t=i({},o,e||{});if(this.options=t,this.__cache={},this.__init_promise=null,this.__modules=t.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}s.prototype.has_wasm=r,s.prototype.use=function(e){return this.__modules[e.name]=e,this.options.wasm&&this.has_wasm()&&e.wasm_fn?this[e.name]=e.wasm_fn:this[e.name]=e.fn,this},s.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var e=this;return this.__init_promise=Promise.all(Object.keys(e.__modules).map((function(t){var n=e.__modules[t];return e.options.wasm&&e.has_wasm()&&n.wasm_fn?e.__wasm[t]?null:WebAssembly.compile(e.__base64decode(n.wasm_src)).then((function(n){e.__wasm[t]=n})):null}))).then((function(){return e})),this.__init_promise},s.prototype.__base64decode=a,s.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/(64*1024))}),this.__memory;var t=this.__memory.buffer.byteLength;return t<e&&this.__memory.grow(Math.ceil((e-t)/(64*1024))),this.__memory},s.prototype.__instance=function(e,t,n){if(t&&this.__reallocate(t),!this.__wasm[e]){var a=this.__modules[e];this.__wasm[e]=new WebAssembly.Module(this.__base64decode(a.wasm_src))}if(!this.__cache[e]){var r={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:i(r,n||{})})}return this.__cache[e]},s.prototype.__align=function(e,t){var n=e%(t=t||8);return e+(n?t-n:0)},t.exports=s},{"./lib/base64decode":17,"./lib/wa_detect":23,"object-assign":24}],17:[function(e,t,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports=function(e){for(var t=e.replace(/[\r\n=]/g,""),n=t.length,a=new Uint8Array(3*n>>2),r=0,o=0,s=0;s<n;s++)s%4==0&&s&&(a[o++]=r>>16&255,a[o++]=r>>8&255,a[o++]=255&r),r=r<<6|i.indexOf(t.charAt(s));var l=n%4*6;return 0===l?(a[o++]=r>>16&255,a[o++]=r>>8&255,a[o++]=255&r):18===l?(a[o++]=r>>10&255,a[o++]=r>>2&255):12===l&&(a[o++]=r>>4&255),a}},{}],18:[function(e,t,n){t.exports=function(e,t,n){for(var i,a,r,o,s,l=t*n,h=new Uint16Array(l),u=0;u<l;u++)i=e[4*u],a=e[4*u+1],r=e[4*u+2],s=i>=a&&i>=r?i:a>=r&&a>=i?a:r,o=i<=a&&i<=r?i:a<=r&&a<=i?a:r,h[u]=257*(s+o)>>1;return h}},{}],19:[function(e,t,n){t.exports={name:"unsharp_mask",fn:e("./unsharp_mask"),wasm_fn:e("./unsharp_mask_wasm"),wasm_src:e("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":20,"./unsharp_mask_wasm":21,"./unsharp_mask_wasm_base64":22}],20:[function(e,t,n){var i=e("glur/mono16"),a=e("./hsl_l16");t.exports=function(e,t,n,r,o,s){var l,h,u,c,f,g,m,p,d,A,y,v,w;if(!(0===r||o<.5)){o>2&&(o=2);var I=a(e,t,n),S=new Uint16Array(I);i(S,t,n,o);for(var b=r/100*4096+.5|0,C=257*s|0,E=t*n,B=0;B<E;B++)v=2*(I[B]-S[B]),Math.abs(v)>=C&&(l=e[w=4*B],h=e[w+1],u=e[w+2],g=257*((p=l>=h&&l>=u?l:h>=l&&h>=u?h:u)+(m=l<=h&&l<=u?l:h<=l&&h<=u?h:u))>>1,m===p?c=f=0:(f=g<=32767?4095*(p-m)/(p+m)|0:4095*(p-m)/(2*255-p-m)|0,c=l===p?65535*(h-u)/(6*(p-m))|0:h===p?21845+(65535*(u-l)/(6*(p-m))|0):43690+(65535*(l-h)/(6*(p-m))|0)),(g+=b*v+2048>>12)>65535?g=65535:g<0&&(g=0),0===f?l=h=u=g>>8:(d=2*g-(A=g<=32767?g*(4096+f)+2048>>12:g+((65535-g)*f+2048>>12))>>8,A>>=8,l=(y=c+21845&65535)>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16),h=(y=65535&c)>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16),u=(y=c-21845&65535)>=43690?d:y>=32767?d+(6*(A-d)*(43690-y)+32768>>16):y>=10922?A:d+(6*(A-d)*y+32768>>16)),e[w]=l,e[w+1]=h,e[w+2]=u)}}},{"./hsl_l16":18,"glur/mono16":14}],21:[function(e,t,n){t.exports=function(e,t,n,i,a,r){if(!(0===i||a<.5)){a>2&&(a=2);var o=t*n,s=4*o,l=2*o,h=2*o,u=4*Math.max(t,n),c=0,f=s,g=f+l,m=g+h,p=m+h,d=p+u,A=this.__instance("unsharp_mask",s+l+2*h+u+8*4,{exp:Math.exp}),y=new Uint32Array(e.buffer);new Uint32Array(this.__memory.buffer).set(y);var v=A.exports.hsl_l16||A.exports._hsl_l16;v(c,f,t,n),(v=A.exports.blurMono16||A.exports._blurMono16)(f,g,m,p,d,t,n,a),(v=A.exports.unsharp||A.exports._unsharp)(c,c,f,g,t,n,i,r),y.set(new Uint32Array(this.__memory.buffer,0,o))}}},{}],22:[function(e,t,n){t.exports="AGFzbQEAAAABMQZgAXwBfGACfX8AYAZ/f39/f38AYAh/f39/f39/fQBgBH9/f38AYAh/f39/f39/fwACGQIDZW52A2V4cAAAA2VudgZtZW1vcnkCAAEDBgUBAgMEBQQEAXAAAAdMBRZfX2J1aWxkX2dhdXNzaWFuX2NvZWZzAAEOX19nYXVzczE2X2xpbmUAAgpibHVyTW9ubzE2AAMHaHNsX2wxNgAEB3Vuc2hhcnAABQkBAAqJEAXZAQEGfAJAIAFE24a6Q4Ia+z8gALujIgOaEAAiBCAEoCIGtjgCECABIANEAAAAAAAAAMCiEAAiBbaMOAIUIAFEAAAAAAAA8D8gBKEiAiACoiAEIAMgA6CiRAAAAAAAAPA/oCAFoaMiArY4AgAgASAEIANEAAAAAAAA8L+gIAKioiIHtjgCBCABIAQgA0QAAAAAAADwP6AgAqKiIgO2OAIIIAEgBSACoiIEtow4AgwgASACIAegIAVEAAAAAAAA8D8gBqGgIgKjtjgCGCABIAMgBKEgAqO2OAIcCwu3AwMDfwR9CHwCQCADKgIUIQkgAyoCECEKIAMqAgwhCyADKgIIIQwCQCAEQX9qIgdBAEgiCA0AIAIgAC8BALgiDSADKgIYu6IiDiAJuyIQoiAOIAq7IhGiIA0gAyoCBLsiEqIgAyoCALsiEyANoqCgoCIPtjgCACACQQRqIQIgAEECaiEAIAdFDQAgBCEGA0AgAiAOIBCiIA8iDiARoiANIBKiIBMgAC8BALgiDaKgoKAiD7Y4AgAgAkEEaiECIABBAmohACAGQX9qIgZBAUoNAAsLAkAgCA0AIAEgByAFbEEBdGogAEF+ai8BACIIuCINIAu7IhGiIA0gDLsiEqKgIA0gAyoCHLuiIg4gCrsiE6KgIA4gCbsiFKKgIg8gAkF8aioCALugqzsBACAHRQ0AIAJBeGohAiAAQXxqIQBBACAFQQF0ayEHIAEgBSAEQQF0QXxqbGohBgNAIAghAyAALwEAIQggBiANIBGiIAO4Ig0gEqKgIA8iECAToqAgDiAUoqAiDyACKgIAu6CrOwEAIAYgB2ohBiAAQX5qIQAgAkF8aiECIBAhDiAEQX9qIgRBAUoNAAsLCwvfAgIDfwZ8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIgyaEAAiDSANoCIPtjgCECAEIAxEAAAAAAAAAMCiEAAiDraMOAIUIAREAAAAAAAA8D8gDaEiCyALoiANIAwgDKCiRAAAAAAAAPA/oCAOoaMiC7Y4AgAgBCANIAxEAAAAAAAA8L+gIAuioiIQtjgCBCAEIA0gDEQAAAAAAADwP6AgC6KiIgy2OAIIIAQgDiALoiINtow4AgwgBCALIBCgIA5EAAAAAAAA8D8gD6GgIgujtjgCGCAEIAwgDaEgC6O2OAIcIAYEQCAFQQF0IQogBiEJIAIhCANAIAAgCCADIAQgBSAGEAIgACAKaiEAIAhBAmohCCAJQX9qIgkNAAsLIAVFDQAgBkEBdCEIIAUhAANAIAIgASADIAQgBiAFEAIgAiAIaiECIAFBAmohASAAQX9qIgANAAsLC7wBAQV/IAMgAmwiAwRAQQAgA2shBgNAIAAoAgAiBEEIdiIHQf8BcSECAn8gBEH/AXEiAyAEQRB2IgRB/wFxIgVPBEAgAyIIIAMgAk8NARoLIAQgBCAHIAIgA0kbIAIgBUkbQf8BcQshCAJAIAMgAk0EQCADIAVNDQELIAQgByAEIAMgAk8bIAIgBUsbQf8BcSEDCyAAQQRqIQAgASADIAhqQYECbEEBdjsBACABQQJqIQEgBkEBaiIGDQALCwvTBgEKfwJAIAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6CqIQ0gBSAEbCILBEAgB0GBAmwhDgNAQQAgAi8BACADLwEAayIGQQF0IgdrIAcgBkEASBsgDk8EQCAAQQJqLQAAIQUCfyAALQAAIgYgAEEBai0AACIESSIJRQRAIAYiCCAGIAVPDQEaCyAFIAUgBCAEIAVJGyAGIARLGwshCAJ/IAYgBE0EQCAGIgogBiAFTQ0BGgsgBSAFIAQgBCAFSxsgCRsLIgogCGoiD0GBAmwiEEEBdiERQQAhDAJ/QQAiCSAIIApGDQAaIAggCmsiCUH/H2wgD0H+AyAIayAKayAQQYCABEkbbSEMIAYgCEYEQCAEIAVrQf//A2wgCUEGbG0MAQsgBSAGayAGIARrIAQgCEYiBhtB//8DbCAJQQZsbUHVqgFBqtUCIAYbagshCSARIAcgDWxBgBBqQQx1aiIGQQAgBkEAShsiBkH//wMgBkH//wNIGyEGAkACfwJAIAxB//8DcSIFBEAgBkH//wFKDQEgBUGAIGogBmxBgBBqQQx2DAILIAZBCHYiBiEFIAYhBAwCCyAFIAZB//8Dc2xBgBBqQQx2IAZqCyIFQQh2IQcgBkEBdCAFa0EIdiIGIQQCQCAJQdWqAWpB//8DcSIFQanVAksNACAFQf//AU8EQEGq1QIgBWsgByAGa2xBBmxBgIACakEQdiAGaiEEDAELIAchBCAFQanVAEsNACAFIAcgBmtsQQZsQYCAAmpBEHYgBmohBAsCfyAGIgUgCUH//wNxIghBqdUCSw0AGkGq1QIgCGsgByAGa2xBBmxBgIACakEQdiAGaiAIQf//AU8NABogByIFIAhBqdUASw0AGiAIIAcgBmtsQQZsQYCAAmpBEHYgBmoLIQUgCUGr1QJqQf//A3EiCEGp1QJLDQAgCEH//wFPBEBBqtUCIAhrIAcgBmtsQQZsQYCAAmpBEHYgBmohBgwBCyAIQanVAEsEQCAHIQYMAQsgCCAHIAZrbEEGbEGAgAJqQRB2IAZqIQYLIAEgBDoAACABQQFqIAU6AAAgAUECaiAGOgAACyADQQJqIQMgAkECaiECIABBBGohACABQQRqIQEgC0F/aiILDQALCwsL"},{}],23:[function(e,t,n){var i;t.exports=function(){if(void 0!==i)return i;if(i=!1,"undefined"==typeof WebAssembly)return i;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)&&(i=!0),i}catch(e){}return i}},{}],24:[function(e,t,n){var i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,l=o(e),h=1;h<arguments.length;h++){for(var u in n=Object(arguments[h]))a.call(n,u)&&(l[u]=n[u]);if(i){s=i(n);for(var c=0;c<s.length;c++)r.call(n,s[c])&&(l[s[c]]=n[s[c]])}}return l}},{}],25:[function(e,t,n){var i=arguments[3],a=arguments[4],r=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var n,s=Object.keys(r),l=0,h=s.length;l<h;l++){var u=s[l],c=r[u].exports;if(c===e||c&&c.default===e){n=u;break}}if(!n){n=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var f={};for(l=0,h=s.length;l<h;l++)f[u=s[l]]=u;a[n]=["function(require,module,exports){"+e+"(self); }",f]}var g=Math.floor(Math.pow(16,8)*Math.random()).toString(16),m={};m[n]=n,a[g]=["function(require,module,exports){"+"var f = require("+o(n)+");"+"(f.default ? f.default : f)(self);"+"}",m];var p={};!function e(t){for(var n in p[t]=!0,a[t][1]){var i=a[t][1][n];p[i]||e(i)}}(g);var d="("+i+")({"+Object.keys(p).map((function(e){return o(e)+":["+a[e][0]+","+o(a[e][1])+"]"})).join(",")+"},{},["+o(g)+"])",A=window.URL||window.webkitURL||window.mozURL||window.msURL,y=new Blob([d],{type:"text/javascript"});if(t&&t.bare)return y;var v=A.createObjectURL(y),w=new Worker(v);return w.objectURL=v,w}},{}],"/":[function(e,t,n){function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=e("object-assign"),r=e("webworkify"),o=e("./lib/mathlib"),s=e("./lib/pool"),l=e("./lib/utils"),h=e("./lib/worker"),u=e("./lib/stepper"),c=e("./lib/tiler"),f={},g=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(g=navigator.userAgent.indexOf("Safari")>=0)}catch(e){}var m=1;"undefined"!=typeof navigator&&(m=Math.min(navigator.hardwareConcurrency||1,4));var p,d,A={tile:1024,concurrency:m,features:["js","wasm","ww"],idle:2e3},y={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0};function v(){return{value:r(h),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;e&&e.revokeObjectURL&&this.value.objectURL&&e.revokeObjectURL(this.value.objectURL)}}}}function w(e){if(!(this instanceof w))return new w(e);this.options=a({},A,e||{});var t="lk_".concat(this.options.concurrency);this.__limit=f[t]||l.limiter(this.options.concurrency),f[t]||(f[t]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}w.prototype.init=function(){var t=this;if(this.__initPromise)return this.__initPromise;if(!1!==p&&!0!==p&&(p=!1,"undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray))try{new ImageData(new Uint8ClampedArray(400),10,10),p=!0}catch(e){}!1!==d&&!0!==d&&(d=!1,"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?d=!0:this.debug("ImageBitmap does not support .close(), disabled")));var n=this.options.features.slice();if(n.indexOf("all")>=0&&(n=["cib","wasm","js","ww"]),this.__requested_features=n,this.__mathlib=new o(n),n.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{e("webworkify")((function(){})).terminate(),this.features.ww=!0;var i="wp_".concat(JSON.stringify(this.options));f[i]?this.__workersPool=f[i]:(this.__workersPool=new s(v,this.options.idle),f[i]=this.__workersPool)}catch(e){}var r,h=this.__mathlib.init().then((function(e){a(t.features,e.features)}));return r=d?l.cib_support().then((function(e){t.features.cib&&n.indexOf("cib")<0?t.debug("createImageBitmap() resize supported, but disabled by config"):n.indexOf("cib")>=0&&(t.features.cib=e)})):Promise.resolve(!1),this.__initPromise=Promise.all([h,r]).then((function(){return t})),this.__initPromise},w.prototype.resize=function(e,t,n){var r=this;this.debug("Start resize...");var o=a({},y);if(isNaN(n)?n&&(o=a(o,n)):o=a(o,{quality:n}),o.toWidth=t.width,o.toHeight=t.height,o.width=e.naturalWidth||e.width,o.height=e.naturalHeight||e.height,0===t.width||0===t.height)return Promise.reject(new Error("Invalid output size: ".concat(t.width,"x").concat(t.height)));o.unsharpRadius>2&&(o.unsharpRadius=2);var s=!1,h=null;o.cancelToken&&(h=o.cancelToken.then((function(e){throw s=!0,e}),(function(e){throw s=!0,e})));var f=Math.ceil(Math.max(3,2.5*o.unsharpRadius|0));return this.init().then((function(){if(s)return h;if(r.features.cib){var n=t.getContext("2d",{alpha:Boolean(o.alpha)});return r.debug("Resize via createImageBitmap()"),createImageBitmap(e,{resizeWidth:o.toWidth,resizeHeight:o.toHeight,resizeQuality:l.cib_quality_name(o.quality)}).then((function(e){if(s)return h;if(!o.unsharpAmount)return n.drawImage(e,0,0),e.close(),n=null,r.debug("Finished!"),t;r.debug("Unsharp result");var i=document.createElement("canvas");i.width=o.toWidth,i.height=o.toHeight;var a=i.getContext("2d",{alpha:Boolean(o.alpha)});a.drawImage(e,0,0),e.close();var l=a.getImageData(0,0,o.toWidth,o.toHeight);return r.__mathlib.unsharp_mask(l.data,o.toWidth,o.toHeight,o.unsharpAmount,o.unsharpRadius,o.unsharpThreshold),n.putImageData(l,0,0),l=a=i=n=null,r.debug("Finished!"),t}))}var m={},A=function(e,t,n){var i,a,o,u=function(t){return r.__limit((function(){if(s)return h;var u;if(l.isCanvas(e))r.debug("Get tile pixel data"),u=i.getImageData(t.x,t.y,t.width,t.height);else{r.debug("Draw tile imageBitmap/image to temporary canvas");var c=document.createElement("canvas");c.width=t.width,c.height=t.height;var f=c.getContext("2d",{alpha:Boolean(n.alpha)});f.globalCompositeOperation="copy",f.drawImage(a||e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),r.debug("Get tile pixel data"),u=f.getImageData(0,0,t.width,t.height),f=c=null}var d={src:u.data,width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:n.quality,alpha:n.alpha,unsharpAmount:n.unsharpAmount,unsharpRadius:n.unsharpRadius,unsharpThreshold:n.unsharpThreshold};return r.debug("Invoke resize math"),Promise.resolve().then((function(){return function(e){return Promise.resolve().then((function(){return r.features.ww?new Promise((function(t,n){var i=r.__workersPool.acquire();h&&h["catch"]((function(e){return n(e)})),i.value.onmessage=function(e){i.release(),e.data.err?n(e.data.err):t(e.data.result)},i.value.postMessage({opts:e,features:r.__requested_features,preload:{wasm_nodule:r.__mathlib.__}},[e.src.buffer])})):r.__mathlib.resizeAndUnsharp(e,m)}))}(d)})).then((function(e){if(s)return h;var n;if(u=null,r.debug("Convert raw rgba tile result to ImageData"),p)n=new ImageData(new Uint8ClampedArray(e),t.toWidth,t.toHeight);else if((n=o.createImageData(t.toWidth,t.toHeight)).data.set)n.data.set(e);else for(var i=n.data.length-1;i>=0;i--)n.data[i]=e[i];return r.debug("Draw tile"),g?o.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth+1e-5,t.toInnerHeight+1e-5):o.putImageData(n,t.toX,t.toY,t.toInnerX-t.toX,t.toInnerY-t.toY,t.toInnerWidth,t.toInnerHeight),null}))}))};return Promise.resolve().then((function(){if(o=t.getContext("2d",{alpha:Boolean(n.alpha)}),l.isCanvas(e))return i=e.getContext("2d",{alpha:Boolean(n.alpha)}),null;if(l.isImage(e))return d?(r.debug("Decode image via createImageBitmap"),createImageBitmap(e).then((function(e){a=e}))):null;throw new Error('".from" should be image or canvas')})).then((function(){if(s)return h;r.debug("Calculate tiles");var e=c({width:n.width,height:n.height,srcTileSize:r.options.tile,toWidth:n.toWidth,toHeight:n.toHeight,destTileBorder:f}).map((function(e){return u(e)}));function i(){a&&(a.close(),a=null)}return r.debug("Process tiles"),Promise.all(e).then((function(){return r.debug("Finished!"),i(),t}),(function(e){throw i(),e}))}))};return function e(t,n,r,o){if(s)return h;var l,u=i(t.shift(),2),c=u[0],f=u[1],g=0===t.length;return o=a({},o,{toWidth:c,toHeight:f,quality:g?o.quality:Math.min(1,o.quality)}),g||((l=document.createElement("canvas")).width=c,l.height=f),A(n,g?r:l,o).then((function(){return g?r:(o.width=c,o.height=f,e(t,l,r,o))}))}(u(o.width,o.height,o.toWidth,o.toHeight,r.options.tile,f),e,t,o)}))},w.prototype.resizeBuffer=function(e){var t=this,n=a({},y,e);return this.init().then((function(){return t.__mathlib.resizeAndUnsharp(n)}))},w.prototype.toBlob=function(e,t,n){return t=t||"image/png",new Promise((function(i){if(e.toBlob)e.toBlob((function(e){return i(e)}),t,n);else{for(var a=atob(e.toDataURL(t,n).split(",")[1]),r=a.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=a.charCodeAt(s);i(new Blob([o],{type:t}))}}))},w.prototype.debug=function(){},t.exports=w},{"./lib/mathlib":1,"./lib/pool":9,"./lib/stepper":10,"./lib/tiler":11,"./lib/utils":12,"./lib/worker":13,"object-assign":24,webworkify:25}]},{},[])("/")})),f="square",g="to",m="MANIPULATION",p="LOADER",d="FILTER",A="DRAW";function y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=Object.assign({pica:{},picaInit:{}},i);return a.picaInit.features||(a.picaInit.features=["js"]),function(i){return new Promise((function(r,o){var s=null,l=document.createElement("canvas"),h=0,u=i.width,m=i.height,p=0,d=0;if(n===f)p=m*(h=u<m?e/u:t/m),d=u*h;else if(n===g){var A=u/e,y=m/t;A>y?(p=Math.round(m/A),d=e):(d=Math.round(u/y),p=t)}else o(new Error("Unknown resize type"));l.width=d,l.height=p,new c(a.picaInit).resize(i,l,a.pica).then((function(e){if(n===f){var t=0,i=0;d<p?(i=(p-d)/2,p=d):(t=(d-p)/2,d=p);var a=document.createElement("canvas"),o=a.getContext("2d");a.width=d,a.height=p,o.drawImage(e,t,i,d,p,0,0,d,p),s=a}else s=e;r(s)}))}))}}function v(e){return e*(Math.PI/180)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.padding,i=void 0===n?0:n,a=t.bgColor,r=void 0===a?"white":a;return function(t){return new Promise((function(n,a){var o=document.createElement("canvas"),s=0;e<0&&(e=360+e),s=e>=0&&e<=90?90-e:270-e;var l=v(e),h=v(s),u=v(e),c={cosAngle:Math.cos(u),cosCalcAngle:Math.cos(h),sinAngle:Math.sin(u),sinCalcAngle:Math.sin(h)};for(var f in c)c[f]<0&&(c[f]=-1*c[f]);o.width=t.width*c.cosAngle+t.height*c.cosCalcAngle+i,o.height=t.width*c.sinAngle+t.height*c.sinCalcAngle+i;var g=o.getContext("2d");r&&(g.beginPath(),g.rect(0,0,o.width,o.height),g.fillStyle=r,g.fill(),g.save()),g.save(),g.translate(o.width/2,o.height/2),g.rotate(l),g.drawImage(t,-t.width/2,-t.height/2),g.restore(),n(o)}))}}function I(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).bgColor,i=void 0===n?"white":n;return function(n){return new Promise((function(a,r){var o=document.createElement("canvas");o.width=e,o.height=t;var s=o.getContext("2d"),l=n.width,h=n.height;i&&(s.beginPath(),s.rect(0,0,e,t),s.fillStyle=i,s.fill(),s.save());var u=0,c=0;l<e&&(u=(e-l)/2),h<t&&(c=(t-h)/2),s.drawImage(n,0,0,l,h,u,c,l,h),a(o)}))}}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.padding,i=void 0===n?4:n,a=t.bgColor,r=void 0===a?"white":a;return function(t){return new Promise((function(n,a){var o=document.createElement("canvas");o.width=e,o.height=e;var s=o.getContext("2d");s.beginPath(),s.rect(0,0,e,e),s.fillStyle=r,s.fill(),s.save();var l=e-i,h=Math.round(l/2);s.beginPath(),s.arc(h+i/2,h+i/2,h-i/2,0,2*Math.PI,!0),s.closePath(),s.clip(),s.drawImage(t,0,0,l,l),s.restore(),n(o)}))}}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rQ,n=void 0===t?.34:t,i=e.gQ,a=void 0===i?.5:i,r=e.bQ,o=void 0===r?.16:r;return function(e){return new Promise((function(t,i){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var s=r.getContext("2d");s.drawImage(e,0,0);for(var l=s.getImageData(0,0,r.width,r.height),h=l.data,u=0;u<h.length;u+=4){var c=n*h[u]+a*h[u+1]+o*h[u+2];h[u]=c,h[u+1]=c,h[u+2]=c}s.putImageData(l,0,0),t(r)}))}}function C(e){return function(t){return new Promise((function(n,i){var a=document.createElement("canvas"),r=a.getContext("2d");a.width=t.width,a.height=t.height;var o=t.width*e,s=t.height*e;E(r),r.drawImage(t,0,0,o,s),E(r),r.drawImage(a,0,0,o,s,0,0,t.width,t.height),n(a)}))}}function E(e){e.webkitImageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1}function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var P=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],_=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function x(e,t,n,i,a,r){if(!(isNaN(r)||r<1)){r|=0;var o=function(e,t,n,i,a){if("string"==typeof e&&(e=document.getElementById(e)),!(e&&"object"===B(e)&&"getContext"in e))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var r=e.getContext("2d");try{return r.getImageData(t,n,i,a)}catch(e){throw new Error("unable to access image data: "+e)}}(e,t,n,i,a);o=function(e,t,n,i,a,r){var o,s,l,h,u,c,f,g,m,p,d,A,y,v,w,I,S,b,C,E,B,x,R,k,D,M=e.data,G=2*r+1,Q=i-1,T=a-1,F=r+1,O=F*(F+1)/2,U=new L,N=U;for(l=1;l<G;l++)N=N.next=new L,l===F&&(D=N);N.next=U;var j=null,H=null;f=c=0;var q=P[r],z=_[r];for(s=0;s<a;s++){for(I=S=b=C=g=m=p=d=0,A=F*(E=M[c]),y=F*(B=M[c+1]),v=F*(x=M[c+2]),w=F*(R=M[c+3]),g+=O*E,m+=O*B,p+=O*x,d+=O*R,N=U,l=0;l<F;l++)N.r=E,N.g=B,N.b=x,N.a=R,N=N.next;for(l=1;l<F;l++)h=c+((Q<l?Q:l)<<2),g+=(N.r=E=M[h])*(k=F-l),m+=(N.g=B=M[h+1])*k,p+=(N.b=x=M[h+2])*k,d+=(N.a=R=M[h+3])*k,I+=E,S+=B,b+=x,C+=R,N=N.next;for(j=U,H=D,o=0;o<i;o++)M[c+3]=R=d*q>>z,0!==R?(R=255/R,M[c]=(g*q>>z)*R,M[c+1]=(m*q>>z)*R,M[c+2]=(p*q>>z)*R):M[c]=M[c+1]=M[c+2]=0,g-=A,m-=y,p-=v,d-=w,A-=j.r,y-=j.g,v-=j.b,w-=j.a,h=f+((h=o+r+1)<Q?h:Q)<<2,I+=j.r=M[h],S+=j.g=M[h+1],b+=j.b=M[h+2],C+=j.a=M[h+3],g+=I,m+=S,p+=b,d+=C,j=j.next,A+=E=H.r,y+=B=H.g,v+=x=H.b,w+=R=H.a,I-=E,S-=B,b-=x,C-=R,H=H.next,c+=4;f+=i}for(o=0;o<i;o++){for(S=b=C=I=m=p=d=g=0,A=F*(E=M[c=o<<2]),y=F*(B=M[c+1]),v=F*(x=M[c+2]),w=F*(R=M[c+3]),g+=O*E,m+=O*B,p+=O*x,d+=O*R,N=U,l=0;l<F;l++)N.r=E,N.g=B,N.b=x,N.a=R,N=N.next;for(u=i,l=1;l<=r;l++)c=u+o<<2,g+=(N.r=E=M[c])*(k=F-l),m+=(N.g=B=M[c+1])*k,p+=(N.b=x=M[c+2])*k,d+=(N.a=R=M[c+3])*k,I+=E,S+=B,b+=x,C+=R,N=N.next,l<T&&(u+=i);for(c=o,j=U,H=D,s=0;s<a;s++)M[(h=c<<2)+3]=R=d*q>>z,R>0?(R=255/R,M[h]=(g*q>>z)*R,M[h+1]=(m*q>>z)*R,M[h+2]=(p*q>>z)*R):M[h]=M[h+1]=M[h+2]=0,g-=A,m-=y,p-=v,d-=w,A-=j.r,y-=j.g,v-=j.b,w-=j.a,h=o+((h=s+F)<T?h:T)*i<<2,g+=I+=j.r=M[h],m+=S+=j.g=M[h+1],p+=b+=j.b=M[h+2],d+=C+=j.a=M[h+3],j=j.next,A+=E=H.r,y+=B=H.g,v+=x=H.b,w+=R=H.a,I-=E,S-=B,b-=x,C-=R,H=H.next,c+=i}return e}(o,0,0,i,a,r),e.getContext("2d").putImageData(o,t,n)}}var L=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function R(e){return function(t){return new Promise((function(n,i){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0),x(a,0,0,t.width,t.height,e),n(a)}))}}function k(e,t,n,i){return new Promise((function(a,r){e.toBlob((function(e){var i=new Blob([e],{type:n});i.name=function(e,t){var n=e.split("."),i="jpg";return t.indexOf("png")>-1?i="png":t.indexOf("webp")>-1&&(i="webp"),n.pop(),n.push(i),n.join(".")}(t,n),a(i)}),n,i)}))}function D(e,t,n){return new Promise((function(i,a){i(e.toDataURL(t,n))}))}var M=function(e){if(Array.isArray(e))return e};var G=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],i=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(e){a=!0,r=e}finally{try{i||null==s["return"]||s["return"]()}finally{if(a)throw r}}return n}};var Q=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var T=function(e,t){return M(e)||G(e,t)||Q()};function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e.length<1)throw new Error("We need points");for(var t=[],n=0;n<e.length;n++)if(Array.isArray(e[n]))t.push(e[n]);else{var i=t.length-1;-1===i?t.push([e[n]]):t[i]&&2===t[i].length?t.push([e[n]]):t[i].push(e[n])}return t}function O(e,t,n){return function(i){return new Promise((function(a,r){var o=F(e),s=i.getContext("2d");s.save();var l=T(o[0],2),h=l[0],u=l[1];s.moveTo(h,u);for(var c=1;c<o.length;c++){var f=T(o[c],2),g=f[0],m=f[1];s.lineTo(g,m)}s.strokeStyle=t,s.lineWidth=n,s.stroke(),s.restore(),a(i)}))}}function U(e,t,n,i){return function(a){return new Promise((function(r,o){var s=F(e),l=a.getContext("2d");l.save(),l.beginPath();var h=T(s[0],2),u=h[0],c=h[1];l.moveTo(u,c);for(var f=1;f<s.length;f++){var g=T(s[f],2),m=g[0],p=g[1];l.lineTo(m,p)}l.closePath(),l.fillStyle=t,l.fill(),l.strokeStyle=n,l.lineWidth=i,l.stroke(),l.restore(),r(a)}))}}function N(e,t,n,i){return function(a){return new Promise((function(r,o){var s=F(e);if(s.length<2)throw new Error("Need points sequence of [[left, bottom], [right, top]] or [left, bottom, right, top]");var l=T(s[0],2),h=l[0],u=l[1],c=T(s[1],2),f=c[0],g=c[1],m=a.getContext("2d");m.save(),t&&m.beginPath(),m.moveTo(h,u),m.lineTo(h,g),m.lineTo(f,g),m.lineTo(f,u),m.lineTo(h,u),t&&(m.closePath(),m.fillStyle=t,m.fill()),n&&(m.strokeStyle=n,m.lineWidth=i,m.stroke()),m.restore(),r(a)}))}}function j(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.font,o=void 0===r?"helvetica":r,s=i.fontSize,l=void 0===s?null:s,h=i.fill,u=void 0===h?null:h,c=i.fillPadding,f=void 0===c?null:c,g=i.rotateAngle,m=void 0===g?null:g;return function(i){return new Promise(function(){var r=a(n.mark((function a(r,s){var h,c,g,p,d,A,y,v,w,I,S,b,C,E;return n.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:if(h=0,c=0,(g=document.createElement("canvas")).width=i.width,g.height=i.height,p=g.getContext("2d"),m&&(d=m*Math.PI/180,p.rotate(d)),l&&(h=l.indexOf("%")>-1?Math.floor(g.height*(parseFloat(l)/100)):parseFloat(l),o="".concat(h,"px ").concat(o).trim()),f&&(c=f.indexOf("%")>-1?Math.floor(g.height*(parseFloat(f)/100)):parseFloat(f)),!u){n.next=20;break}return p.save(),o&&(p.font=o),A=T(e,2),y=A[0],v=A[1],w=parseInt(p.font),I=p.measureText(t),S=I.width,"actualBoundingBoxAscent"in I&&(w=I.actualBoundingBoxAscent-I.actualBoundingBoxDescent),p.restore(),n.next=20,N([y-c,v+c,y+S+c,v-w-c],u,null)(g);case 20:p.save(),o&&(p.font=o),b=T(e,2),C=b[0],E=b[1],p.fillText(t,C,E),p.restore(),i.getContext("2d").drawImage(g,0,0),r(i);case 28:case"end":return n.stop()}}),a)})));return function(e,t){return r.apply(this,arguments)}}())}}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new Promise((function(n,i){var a=t.getContext("2d"),r=t.width,o=t.height,s=e.xy0,l=void 0===s?["0%","0%"]:s,h=e.xy1,u=void 0===h?["100%","0%"]:h,c=e.xy2,f=void 0===c?["100%","100%"]:c,g=e.xy3,m=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=[],a=0;a<e.length;a++)i[a]=[q(e[a][0],t),q(e[a][1],n)];return i}([l,u,f,void 0===g?["0%","100%"]:g],r,o),p=z(r,o);p.drawImage(t,0,0,r,o);var d=z(r,o),A=function(e,t,n){for(var i=T(e,4),a=T(i[0],2),r=a[0],o=a[1],s=T(i[1],2),l=s[0],h=s[1],u=T(i[2],2),c=u[0],f=u[1],g=T(i[3],2),m=g[0],p=g[1],d=[Math.sqrt(Math.pow(r-l,2)+Math.pow(o-h,2)),Math.sqrt(Math.pow(l-c,2)+Math.pow(h-f,2)),Math.sqrt(Math.pow(c-m,2)+Math.pow(f-p,2)),Math.sqrt(Math.pow(m-r,2)+Math.pow(p-o,2))],A=0,y=0,v=0,w=0;w<4;w++){var I=0;(I=w%2?d[w]/t:d[w]/n)>y&&(A=w,y=I),0===d[w]&&v++}if(v>1)return 0;return A}(m,r,o),y=2,v=5*y;d.clearRect(0,0,d.canvas.width,d.canvas.height),A%2==0?W(m,{ctxTransformed:d,sideSize:o,otherSizeSize:r,ctxOut:p,coverStep:v,step:y}):A%2==1&&W(m,{ctxTransformed:d,sideSize:r,otherSizeSize:o,ctxOut:p,coverStep:v,step:y}),a.save(),a.drawImage(d.canvas,0,0),function(e,t){e.beginPath(),e.moveTo(t[0][0],t[0][1]);for(var n=1;n<t.length;n++)e.lineTo(t[n][0],t[n][1]);e.closePath(),e.globalCompositeOperation="destination-in",e.fill(),e.globalCompositeOperation="source-over"}(a,m),a.restore(),n(a.canvas)}))}}function q(e,t){return e.toString().indexOf("%")>-1?Math.floor(t*(parseFloat(e)/100)):e}function z(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.getContext("2d")}function W(e,t){var n=t.ctxTransformed,i=t.sideSize,a=t.otherSizeSize,r=t.ctxOut,o=t.coverStep,s=t.step,l=T(e,4),h=T(l[0],2),u=h[0],c=h[1],f=T(l[1],2),g=f[0],m=f[1],p=T(l[2],2),d=p[0],A=p[1],y=T(l[3],2),v=y[0],w=y[1],I=z(a,o);I.globalCompositeOperation="copy";for(var S=0;S<i;S+=s){var b=S/i,C=u+(v-u)*b,E=c+(w-c)*b,B=g+(d-g)*b,P=m+(A-m)*b,_=Math.atan((P-E)/(B-C)),x=Math.sqrt(Math.pow(B-C,2)+Math.pow(P-E,2))/a;I.setTransform(1,0,0,1,0,-S),I.drawImage(r.canvas,0,0),n.translate(C,E),n.rotate(_),n.scale(x,x),n.drawImage(I.canvas,0,0),n.setTransform(1,0,0,1,0,0)}}var Y=function(){function e(){r(this,e),this._tasks=[],this._canvas=null,this._loadedCanvas=null,this._lastCanvas=null,this._fileName=null,this._exif={}}var t;return s(e,[{key:"loadBlob",value:function(e,t){return this._addToTask(p,h(e,t)),this}},{key:"loadCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"canvas.png";return this._addToTask(p,u(e,t)),this}},{key:"_imageResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._addToTask(m,y(e,t,n,i)),this}},{key:"toSquare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._imageResize(e,e,f,t)}},{key:"crop",value:function(e,t,n,i){return this._addToTask(m,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return function(a){return new Promise((function(r,o){var s,l,h=a.width,u=a.height;l=i||(u-t)/2,s=n||(h-e)/2;var c=document.createElement("canvas"),f=c.getContext("2d");c.width=e,c.height=t,f.drawImage(a,s,l,e,t,0,0,e,t),r(c)}))}}(e,t,n,i)),this}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._imageResize(e,t,g,n)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._addToTask(m,w(e,t)),this}},{key:"toGrayscale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._addToTask(d,b(e)),this}},{key:"pixelize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;return this._addToTask(d,C(e)),this}},{key:"gaussianBlur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._addToTask(d,R(e)),this}},{key:"centerInRectangle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._imageResize(e,t,g,n),this._addToTask(m,I(e,t,n)),this}},{key:"toCircle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._imageResize(e,e,f,t),this._addToTask(m,S(e,t)),this}},{key:"_runTasks",value:(t=a(n.mark((function e(){var t,i;return n.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:this._canvas=null,t=0;case 2:if(!(t<this._tasks.length)){e.next=20;break}if(this._tasks[t].type!==p){e.next=12;break}return e.next=6,this._tasks[t].func();case 6:i=e.sent,this._loadedCanvas=i.canvas,i.fileName&&(this._fileName=i.fileName),i.exif&&(this._exif=i.exif),e.next=17;break;case 12:if(null!==this._canvas||null!==this._loadedCanvas){e.next=14;break}throw new Error("use loadBlob first");case 14:return e.next=16,this._tasks[t].func(this._canvas||this._loadedCanvas);case 16:this._canvas=e.sent;case 17:t++,e.next=2;break;case 20:this._cleanTasks();case 21:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_addToTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"manipulation",t=arguments.length>1?arguments[1]:void 0;this._tasks.push({type:e,func:t})}},{key:"_cleanTasks",value:function(){this._tasks=[],null!==this._canvas&&(this._lastCanvas=this._canvas)}},{key:"getCanvas",value:function(){return this._canvas||this._lastCanvas}},{key:"getFileName",value:function(){return this._fileName}},{key:"getExif",value:function(){return this._exif}},{key:"setFileName",value:function(e){this._fileName=e}},{key:"saveAsBlob",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/jpeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.0";return this._runTasks().then((function(){return k(e.getCanvas(),e.getFileName(),t,n)}))}},{key:"saveAsCanvas",value:function(){var e=this;return this._runTasks().then((function(){return t=e.getCanvas(),Promise.resolve(t);var t}))}},{key:"saveAsImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/jpeg",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.0";return this._runTasks().then((function(){return D(e.getCanvas(),t,n)}))}},{key:"drawLine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return this._addToTask(A,O(e,t,n)),this}},{key:"drawPolygon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return this._addToTask(A,U(e,t,n,i)),this}},{key:"drawRectangle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"red",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6;return this._addToTask(A,N(e,t,n,i)),this}},{key:"drawText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._addToTask(A,j(e,t,n)),this}},{key:"perspective",value:function(e){return this._addToTask(m,H(e)),this}}]),e}();t((function(e){!function(t){var n=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,i=t.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),a=i&&t.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),r=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,s=(i||r)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(e){var t,n,s,l,h,u,c,f,g;if(!(t=e.match(o)))throw new Error("invalid data URI");for(n=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],l=e.slice(t[0].length),h=s?atob(l):decodeURIComponent(l),u=new ArrayBuffer(h.length),c=new Uint8Array(u),f=0;f<h.length;f+=1)c[f]=h.charCodeAt(f);return i?new Blob([a?c:u],{type:n}):((g=new r).append(u),g.getBlob(n))};t.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(e,t,i){var a=this;setTimeout((function(){i&&n.toDataURL&&s?e(s(a.toDataURL(t,i))):e(a.mozGetAsFile("blob",t))}))}:n.toDataURL&&s&&(n.toBlob=function(e,t,n){var i=this;setTimeout((function(){e(s(i.toDataURL(t,n)))}))})),e.exports?e.exports=s:t.dataURLtoBlob=s}(window)}));return"undefined"!=typeof window&&(window.BrowserImageManipulation=Y),Y}));
